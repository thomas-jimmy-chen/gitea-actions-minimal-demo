# 工作日誌 2025-12-28

## 主題: CAPTCHA OCR 技術研究與實作

---

## 1. 完成事項

### 1.1 Auto-WFH 專案評估
- 來源: https://github.com/dec880126/Auto-WFH
- 用途: 線上課程自動掛機，CAPTCHA 識別
- 結論: OCR 方法可用，已 Fork 到用戶 GitHub

### 1.2 研究環境建立
- 目錄: `research/captcha_ocr_analysis/`
- 依賴: opencv-python, pillow, pytesseract, tesseract
- 環境: conda eebot

### 1.3 CAPTCHA 樣本收集
- 來源: https://elearn.post.gov.tw/login
- 數量: 420 張
- 方式: Selenium headless + Canvas 擷取

### 1.4 OCR 技術實作與測試

| 方法 | 準確率 | 說明 |
|------|--------|------|
| v1_original (Auto-WFH) | 34.8% | 原始方法 |
| v3_islands | **75.7%** | Connected Components 面積過濾 |
| v8_twostage | 75.5% | 侵蝕+元件+膨脹 |
| v7_multidim | 71.2% | 多維度過濾 |

### 1.5 Profile 系統建立
- 檔案: `captcha_profiles.py`
- 11 個預設 Profile
- 支援不同 CAPTCHA 類型

---

## 2. 技術發現

### 2.1 三種降噪技術比較

```
Islands (面積過濾):
- 獨特成功: 15 樣本
- 特徵: 較少元件數
- 適合: 隨機點狀噪點

Multidim (多維度):
- 獨特成功: 13 樣本
- 特徵: 處理極端寬高比形狀
- 適合: 線條/刮痕噪點

Twostage (兩階段):
- 獨特成功: 14 樣本
- 特徵: 處理高邊緣密度
- 適合: 與字符連接的噪點
```

### 2.2 技術互補性
- 三種技術各有專精
- 252 樣本三種都成功 (60%)
- 58 樣本三種都失敗 (14%)
- 建議: 使用多 Profile 嘗試策略

---

## 3. 建立的檔案

```
research/captcha_ocr_analysis/
├── captcha_profiles.py      # Profile 系統 (主要)
├── improved_ocr.py          # 9種預處理方法
├── technique_analysis.py    # 技術分析
├── param_tuning.py          # 參數調優
├── auto_collect_captcha.py  # 樣本收集
├── batch_ocr_test.py        # 批次測試
└── samples/                 # 420張樣本

docs/
└── CAPTCHA_OCR_TECHNICAL_GUIDE.md  # 技術文檔
```

---

## 4. 待完成

- [ ] 參數調優結果分析
- [ ] 整合到 EEBot 主程式
- [ ] 實際登入流程測試

---

## 5. 參考資料

- PyImageSearch Connected Components Tutorial
- Simple-Captcha-Breaker (cagriuysal)
- kingsman142/captcha-solver noise_remover.py
