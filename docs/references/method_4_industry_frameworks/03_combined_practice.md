# Dual-Track + Evolutionary Architecture 結合實務

**備份日期**: 2025-01-03
**用途**: 記錄兩個框架如何結合使用

---

## 1. 兩層框架整合

### 框架定位

```
┌─────────────────────────────────────────────────────────────────────┐
│                     雙層框架架構圖                                    │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │                                                               │  │
│  │   上層：Dual-Track Agile                                      │  │
│  │   ─────────────────────                                       │  │
│  │   負責：產品流程與團隊作法                                     │  │
│  │   核心：Discovery (做什麼) → Delivery (怎麼做)                 │  │
│  │   提出者：Marty Cagan (SVPG)                                  │  │
│  │                                                               │  │
│  │   ┌─────────────┐         ┌─────────────┐                    │  │
│  │   │ Discovery   │ ──────► │ Delivery    │                    │  │
│  │   │ 驗證價值    │         │ 交付功能    │                    │  │
│  │   └─────────────┘         └─────────────┘                    │  │
│  │                                                               │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                              │                                      │
│                              │ 支撐                                 │
│                              ▼                                      │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │                                                               │  │
│  │   下層：Evolutionary Architecture                             │  │
│  │   ────────────────────────────                                │  │
│  │   負責：技術架構與治理                                        │  │
│  │   核心：Fitness Functions + 可演化架構                        │  │
│  │   提出者：ThoughtWorks (Neal Ford, Rebecca Parsons)           │  │
│  │                                                               │  │
│  │   ┌─────────────┐         ┌─────────────┐                    │  │
│  │   │ Fitness     │         │ 可演化      │                    │  │
│  │   │ Functions   │ ──────► │ 架構風格    │                    │  │
│  │   │ 品質檢查    │         │ 快速演進    │                    │  │
│  │   └─────────────┘         └─────────────┘                    │  │
│  │                                                               │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 簡單說

| 框架 | 問題 | 答案 |
|------|------|------|
| **Dual-Track Agile** | 做什麼功能？怎麼驗證價值？ | Discovery → Delivery |
| **Evolutionary Architecture** | 系統長什麼樣子？怎麼安全地改？ | Fitness Functions + 可演化架構 |

---

## 2. 成熟團隊的做法

### 業界常見組合

許多成熟團隊會把這兩個框架疊在一起用：

```
┌──────────────────────────────────────────┐
│  上層：Dual-Track 做產品探索 / 交付      │
│  ────────────────────────────────────    │
│  • 定義要做什麼功能                       │
│  • 驗證用戶價值                           │
│  • 控制產品方向                           │
├──────────────────────────────────────────┤
│  下層：Evolutionary Architecture         │
│  ────────────────────────────────────    │
│  • 讓系統可以安全地快速演化               │
│  • 自動化品質檢查                         │
│  • 支援實驗與回滾                         │
└──────────────────────────────────────────┘
```

### 具體實踐

| 活動 | 上層 (Dual-Track) | 下層 (EA) |
|------|-------------------|-----------|
| 新功能規劃 | Discovery 軌驗證價值 | - |
| 功能開發 | Delivery 軌執行 | Fitness Functions 監控 |
| 實驗測試 | A/B 測試設計 | Feature Flag + Canary |
| 品質把關 | 用戶驗收 | 自動化測試 |
| 架構變更 | - | 增量演進 + Fitness 驗證 |

---

## 3. 一人工作室 + AI 協作的對應

### 角色簡化

在一人工作室情境下，你同時扮演所有角色：

| 傳統角色 | 你的工作 | AI 協助 |
|----------|----------|---------|
| PM | 決定做什麼 | 調研可行性 |
| Designer | 定義 UX | 產生原型 |
| Engineer | 開發代碼 | 寫測試、重構 |
| Architect | 定模組邊界 | Fitness 檢查 |
| QA | 驗收品質 | Code Review |

### 框架簡化

| 完整框架 | 一人版本 |
|----------|----------|
| Discovery Standup | 與 AI 討論新功能 |
| Delivery Sprint | 每次 Claude Code Session |
| Fitness Functions | pytest + /code-reviewer |
| 可演化架構 | 模組狀態 (🔄/📋) + Feature Flag |

---

## 4. 工作流程整合

### 完整流程

```
┌─────────────────────────────────────────────────────────────────────┐
│                   一人 + AI 整合工作流程                             │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │  Phase 1: Discovery (Dual-Track 上層)                       │    │
│  │  ──────────────────────────────────                         │    │
│  │                                                             │    │
│  │  你的工作：                                                 │    │
│  │  • 識別問題/機會                                           │    │
│  │  • 定義假設                                                 │    │
│  │                                                             │    │
│  │  AI 協助：                                                  │    │
│  │  • 技術可行性調研                                           │    │
│  │  • 快速產生 POC                                             │    │
│  │  • 收集類似案例                                             │    │
│  │                                                             │    │
│  │  產出：已驗證的假設 + POC 代碼                              │    │
│  │  模組狀態：🔄 探索中                                        │    │
│  │                                                             │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                              │                                      │
│                              │ 驗證通過                             │
│                              ▼                                      │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │  Phase 2: Transition (雙層交接)                             │    │
│  │  ─────────────────────────────                              │    │
│  │                                                             │    │
│  │  Dual-Track 交接：                                          │    │
│  │  • Discovery → Delivery                                     │    │
│  │  • 已驗證的功能進入開發                                     │    │
│  │                                                             │    │
│  │  EA 準備：                                                  │    │
│  │  • 定義 Fitness Functions                                   │    │
│  │  • 建立測試基準                                             │    │
│  │  • AI 幫寫規格 + 測試                                       │    │
│  │                                                             │    │
│  │  產出：規格文檔 + 測試案例                                  │    │
│  │  模組狀態：🔄→📋 轉換中                                     │    │
│  │                                                             │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                              │                                      │
│                              │ 規格 + 測試完成                      │
│                              ▼                                      │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │  Phase 3: Delivery (Dual-Track + EA 並行)                   │    │
│  │  ────────────────────────────────────                       │    │
│  │                                                             │    │
│  │  Dual-Track Delivery：                                      │    │
│  │  • 正式開發                                                 │    │
│  │  • 依規格實作                                               │    │
│  │                                                             │    │
│  │  EA 監控：                                                  │    │
│  │  • Fitness Functions 持續檢查                               │    │
│  │  • 變更需通過所有測試                                       │    │
│  │  • Feature Flag 控制上線                                    │    │
│  │                                                             │    │
│  │  產出：可上線的功能                                         │    │
│  │  模組狀態：📋 已穩定                                        │    │
│  │                                                             │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                              │                                      │
│                              │ 持續運作                             │
│                              ▼                                      │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │  Phase 4: Evolution (EA 主導)                               │    │
│  │  ───────────────────────────                                │    │
│  │                                                             │    │
│  │  持續演進：                                                 │    │
│  │  • 根據反饋調整                                             │    │
│  │  • 增量式改進                                               │    │
│  │  • Fitness Functions 確保不退化                             │    │
│  │                                                             │    │
│  │  新機會：                                                   │    │
│  │  • 回到 Phase 1 探索新功能                                  │    │
│  │                                                             │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 5. 對應到 EEBot 專案

### 當前狀態對照

| 模組 | Dual-Track 階段 | EA 狀態 | Fitness Functions |
|------|-----------------|---------|-------------------|
| `core/*` | Delivery | 📋 已穩定 | pytest, review |
| `pages/*` | Delivery | 📋 已穩定 | pytest, review |
| `services/question_bank` | Delivery | 🔄→📋 轉換中 | pytest 80% |
| `services/api_scanner` | Ready for Dev | 🔄→📋 轉換中 | 規格撰寫中 |
| `orchestrators/*` | Discovery | 🔄 探索中 | 僅基本測試 |
| `research/*` | Discovery | 🔄 探索中 | 無 |

### 實際操作範例

```
場景：新增 CAPTCHA OCR 功能

Phase 1: Discovery (Dual-Track)
─────────────────────────────────
你：我想做驗證碼辨識功能
AI：讓我調研 ddddocr...
    [產生 POC 到 research/captcha_ocr_analysis/]
    模組狀態：🔄 探索中

Phase 2: Transition
───────────────────
你：ddddocr 驗證完成，準確率 99%
AI：進入轉換階段，讓我：
    1. 建立規格 (docs/specs/captcha_ocr.yaml)
    2. 撰寫測試 (tests/unit/test_captcha_ocr.py)
    3. 定義 Fitness Functions
    模組狀態：🔄→📋 轉換中

Phase 3: Delivery
─────────────────
你：規格和測試都完成了
AI：開始正式開發：
    - 依規格實作 src/utils/captcha_ocr.py
    - 確保 Fitness Functions 通過
    - 使用 Feature Flag 控制上線
    模組狀態：📋 已穩定

Phase 4: Evolution
──────────────────
持續監控：
- Fitness: 測試通過率 100%
- 準確率監控 > 95%
- 根據反饋調整
```

---

## 6. 關鍵成功因素

### 上層 (Dual-Track) 成功因素

| 因素 | 說明 |
|------|------|
| **快速驗證** | Discovery 階段要快，不要過度設計 |
| **清晰交接** | 只有驗證通過的才進 Delivery |
| **成果導向** | 關注 outcome 而非 output |

### 下層 (EA) 成功因素

| 因素 | 說明 |
|------|------|
| **自動化** | Fitness Functions 必須自動執行 |
| **增量變更** | 每次改動最小化，可回滾 |
| **持續監控** | 上線後持續檢查品質 |

### 整合成功因素

| 因素 | 說明 |
|------|------|
| **一致性** | 兩層的節奏要對齊 |
| **透明度** | 模組狀態要清楚標示 |
| **紀律** | 遵循各階段的規則 |

---

## 7. 參考資料

- [方法 4 業界框架對應](../../AI_COLLABORATION_METHOD_4_INDUSTRY_MAPPING.md)
- [方法 4 實務操作手冊](../../AI_COLLABORATION_PRACTICAL_GUIDE.md)
- [Dual-Track Agile 文獻](./01_dual_track_agile.md)
- [Evolutionary Architecture 文獻](./02_evolutionary_architecture.md)

---

**備份日期**: 2025-01-03
**維護者**: Claude Code (Opus 4.5)
