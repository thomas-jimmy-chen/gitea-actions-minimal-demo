(self.webpackChunklms=self.webpackChunklms||[]).push([[50818],{789785:function(e){e.exports=["$rootScope","$scope","$timeout",(e,t,i)=>i((function(){if(e.org)return e.org.copyright=t.copyright,e.org.filing_number=t.filingNumber}))]},786995:function(e,t,i){var r=i(904072),o=i(708468);i(682772),i(66992),i(747042),i(339714),i(864765),i(333948),i(560285),e.exports=["$rootScope","$scope","$routeParams","$http","$window","toastr",function(e,t,i,a,n,s){var u=r("#courseId").val(),c=r("#orgId").val(),l="True"===r("#isVisitor").data("value"),d=r("#userId").data("id");t.ui={showList:!1,inList:!1,showNavigationList:!1,showZoomLevelList:!1,inNavigationList:!1,inZoomLevelList:!1,showOperList:!1,inOperList:!1,showAppQRCode:!1,inAppQRCode:!1,showManualList:!1,inManualList:!1,showNavbarList:!1,inNavbarList:!1,langList:[]},e.org={name:"",logoUrl:""},t.changeZoom=e=>{var i={100:"normal",110:"large",120:"ex-large"},o=i[window.localStorage.getItem("zoom-level")];return null!=o&&r("#".concat(o)).css("background-color","#FFF"),r("#".concat(i[e])).css("background-color","#EEE"),document.documentElement.style.setProperty("--zoom-level","".concat(e,"%")),window.localStorage.setItem("zoom-level",e),t.ui.showZoomLevelList=!1},t.getOrgName=function(){return e.orgName||(e.orgName=t.orgName),e.orgName},t.getOrgLogo=function(){return e.orgLogoUrl||(e.orgLogoUrl=t.orgLogoUrl),e.orgLogoUrl},t.getOrgShowName=function(){return e.orgShowName||(e.orgShowName=t.orgShowName),e.orgShowName},t.getOrgShowLogo=function(){return e.orgShowLogo||(e.orgShowLogo=t.orgShowLogo),e.orgShowLogo},t.toggleCalendar=function(){return WebuiPopovers.hideAll(),r(".webui-popover.webui-popover-calendar.webui-no-padding.in").hide(),t.showCalendar=!t.showCalendar,t.showCalendar?r("body").css("overflow","hidden"):r("body").css("overflow","auto"),null};var p=()=>{var e=new URLSearchParams(window.location.search);e.has("lang")?(e.delete("lang"),n.location.search=e.toString()):n.location.reload()};t.changeLanguage=function(e){var t={language:e},i=document.domain,o=i.substring(i.indexOf("."));return l?(r.cookie("lang",e,{path:"/",domain:o}),p()):a.put("/api/user/language",t).success((function(){return r.cookie("lang",e,{path:"/",domain:o}),p()})).error((e=>s.warning(e.errors)))},t.showLangList=function(){return r(".languages .entry").focus(),t.ui.showList=!0},t.hideLangList=()=>t.ui.showList=t.ui.inList,t.showNavigationList=function(){return r(".navigation .entry").focus(),t.ui.showNavigationList=!0},t.hideNavigationList=function(){if(!t.ui.inNavigationList)return t.ui.showNavigationList=!1},t.showZoomLevelList=function(){return r(".zoom-level .entry").focus(),t.ui.showZoomLevelList=!0},t.hideZoomLevelList=function(){if(!t.ui.inZoomLevelList)return t.ui.showZoomLevelList=!1},t.showUserOperationList=function(){return r(".profile .entry").focus(),t.ui.showOperList=!0},t.hideUserOperationList=function(){if(!t.ui.inOperList)return t.ui.showOperList=!1},t.showAppQRCode=function(){return r(".app .entry").focus(),t.ui.showAppQRCode=!0},t.hideAppQRCode=function(){if(!t.ui.inAppQRCode)return t.ui.showAppQRCode=!1},t.showManualList=function(){return r(".manual .entry").focus(),t.ui.showManualList=!0},t.hideManualList=function(){if(!t.ui.inManualList)return t.ui.showManualList=!1},t.goToFAQ=function(t){n.open(t+"?lang=".concat(e.lang))},t.showNavbarList=function(){return r(".nav-bar .entry").focus(),t.ui.showNavbarList=!0},t.hideNavbarList=function(){t.ui.inNavbarList||t.ui.touchList?t.ui.touchList?(r(".nav-bar .entry").focus(),t.ui.touchList=!1):r(".nav-bar .entry").focus():t.ui.showNavbarList=!1},t.$on("clickManualListItem",(()=>t.ui.showManualList=!1)),t.openTrialPopup=function(){return r("#create-trial-student-popup").foundation("reveal","open"),e.$broadcast("openCreateTrialStudentPopup",!1),!1};var v=function(e,t){u=parseInt(u);var i=o.find(t,{courseId:u});i?i.updateTime=o.now():t.push({courseId:u,updateTime:o.now()});var r=o.map(o.sortBy(t,(e=>-e.updateTime)).slice(0,6),"courseId");if(!l&&!o.isEqual(r,e))return window.localStorage.setItem("visitedCoursesInfo",JSON.stringify(t)),window.localStorage.setItem("visitedCourseOrderList",JSON.stringify(r)),a.put("/api/user/recently-visited-courses",r)};t.$watch("courseId",(()=>function(){if(u&&d){var e=JSON.parse(window.localStorage.getItem("visitedCourseOrderList")),t=JSON.parse(window.localStorage.getItem("visitedCoursesInfo")),i=parseInt(window.localStorage.getItem("visitedCoursesUser"));return e&&t&&i===parseInt(d)?v(e,t):a.get("/api/user/recently-visited-courses").success((function(i){var r=i.visited_courses;e=o.map(r,"id"),t=[];for(var a=0;a<e.length;a++)u=e[a],t.push({courseId:u,updateTime:o.now()-10*a});return window.localStorage.setItem("visitedCoursesInfo",JSON.stringify(t)),window.localStorage.setItem("visitedCourseOrderList",JSON.stringify(e)),window.localStorage.setItem("visitedCoursesUser",d),v(e,t)}))}}())),t.trackZhiyunHome=function(){window.st.trackZhiyunVisit("visit_home",{})};return function(){!function(){var e=e=>t.ui.langList=e.lang_settings;l&&c?a.get("/anonymous-api/orgs/".concat(c,"/lang-settings")).success(e):a.get("/api/orgs/".concat(c,"/lang-settings")).success(e)}(),t.changeZoom(window.localStorage.getItem("zoom-level")||100);var i,r;if(l&&c)return a.get("/anonymous-api/orgs/".concat(c,"/login-settings")).success((e=>t.loginSettings=e.login_settings));i=new URLSearchParams(window.location.search),(r=i.get("lang"))&&(["en-US","zh-CN","zh-TW"].includes(r)&&e.lang!==r?t.changeLanguage(r):(i.delete("lang"),n.location.search=i.toString()))}()}]},766832:function(e,t,i){var r=i(708468),o=i(730381),a=i(904072),n=i(361204);function s(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,n=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return n=e.done,e},e:function(e){s=!0,a=e},f:function(){try{n||null==i.return||i.return()}finally{if(s)throw a}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}i(682772),i(185827),i(747042),i(339714),i(132023),i(804723),i(323123),i(454747);var c=i(693604).replaceActivityTypeKey;e.exports=["$window",function(e){var t=function(e,t){var i="learning_activity";return"exam"===t.type&&(i="exam_activity"),"classroom"===t.type&&(i="classroom_activity"),r.any(e,{activity_id:t.id,activity_type:i,completeness:"full"})},i=function(e,t,i){return e.chapter.module_id=t,e.chapter.syllabus_id=i},u=function(e,t,o,a,n,s,u){if(e.showSelect2=!1,(e.hideDefaultModuleTitle||t.hideDefaultModuleTitle)&&!a&&o.modules.length>0&&(a=o.modules[0].id),t.chapter={id:"0"},o.syllabus_enabled)if(n)t.chapter.id="syllabus_".concat(n),i(t,a,n);else if(a)t.chapter.id="module_".concat(a),i(t,a,0);else if(u&&t.isInSyllabusPage){var c=r.last(o.modules);if(r.isEmpty(c.syllabuses))t.chapter.id="module_".concat(c.id),i(t,c.id,0);else{var l=r.last(c.syllabuses);t.chapter.id="syllabus_".concat(l.id),i(t,c.id,l.id)}}return s((()=>e.showSelect2=!0))},l=(e,t,i)=>e.push({title:"".concat(t.title),key:"".concat(t.unique_key),id:t.id,optionType:"activity",type:t.type,completionCriterion:t.completion_criterion,isAvailable:d(t,i)}),d=function(e,t){return!r.isEmpty(e.completion_criterion)&&!r.find(t,{activity_id:e.id,activity_type:e.type})},p=function(e){return!["classroom","feedback"].includes(e.type)&&("forum"!=e.type||"crossCourse"!==e.data.participation_scope)},v=(e,t,i,r,o)=>(()=>{var a,n,u=[],c=s(t);try{for(c.s();!(a=c.n()).done;)n=void 0,n=a.value,e.activityHasPrerequisite(n)?u.push((()=>{var t,a=[],u=s(n.prerequisites);try{for(u.s();!(t=u.n()).done;){var c=t.value;c.activity_id===i.id&&c.activity_type===i.type&&(o===e.notScored&&[e.forumNoneCompletedInfo,e.homeworkNoneCompletedInfo].includes(c.completion_criterion.completion_info)||o!==e.notScored)?(c.completion_criterion.has_completed=r,a.push(c.completion_criterion.completion_info=o)):a.push(void 0)}}catch(e){u.e(e)}finally{u.f()}return a})()):u.push(void 0)}catch(e){c.e(e)}finally{c.f()}return u})(),y=function(e,t){var i=r.findWhere(e,{id:t.id,type:t.type});if(i)return i.prerequisites=t.prerequisites};return{modulesAndSyllabuses(e){var t=r.sortBy(e.modules,"sort");return r.reduce(t,(function(e,t){return r.isEmpty(t.name)&&r.isEmpty(t.activities)&&r.isEmpty(t.syllabuses)||(e.push({name:t.name,id:t.id,type:"module",value:"module_".concat(t.id),moduleId:t.id}),r.map(t.syllabuses,(i=>e.push({name:"".concat(i.summary),id:i.id,type:"syllabus",moduleId:t.id,syllabusId:i.id,value:"syllabus_".concat(i.id)})))),e}),[])},getPreActivities(e,t){var i=r.sortBy(e.modules,"sort");return r.reduce(i,(function(e,i){return r.isEmpty(i.activities)||(e.push({title:i.name,id:i.id,optionType:"module",isAvailable:!1}),function(e,t,i){r.map(r.sortBy(e.directActivities,"sort"),(function(e){return p(e)?l(i,e,t):i})),r.map(e.syllabuses,(function(e){return r.isEmpty(e.activities)?i:(i.push({title:"".concat(e.summary),id:e.id,optionType:"syllabus",isAvailable:!1}),r.map(r.sortBy(e.activities,"sort"),(function(e){return p(e)?l(i,e,t):i})))}))}(i,t,e)),e}),[])},syllabuses:e=>r.reduce(e.modules,(function(e,t){return r.each(t.syllabuses,(function(i){var r={id:i.id,module_name:t.name,ref:i};return e.push(r)})),e}),[]),showSyllabusSubItem(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){if(e.show)return!0}else if(e.activities&&e.activities.length>0)return!0;return!1},getBelongTo(e){var t,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";if(!e)return"";var a=[e.department,e.grade];return(null===(t=window.globalData)||void 0===t||!t.isOpenUniversity||null!==(i=window.globalData)&&void 0!==i&&i.courseRoles.includes("student_manager"))&&a.push(e.klass),r.compact(r.map(r.compact(a),"name")).join(o)},calcProgress(e){var t=e=>e+1,i=o.utc(e.start_date),r=o.utc(e.end_date),a=o.utc();if(a<i)return e.status="notStarted",void(e.progress=0);if(a>r)return e.status="closed",void(e.progress=100);e.status="ongoing";var n=t(r.diff(i,"days")),s=t(a.diff(i,"days"));return e.progress=Math.floor(100*s/n)},calcProgressByDates(e){var t=e=>e+1;return r.each(e,(e=>e.progress=function(e){var i=o.utc(e.start_date),r=o.utc(e.end_date),a=o.utc();if(a<i)return e.status="notStarted",0;if(a>r)return e.status="closed",100;e.status="ongoing";var n=t(r.diff(i,"days")),s=t(a.diff(i,"days"));return Math.floor(100*s/n)}(e)))},initCourseExtraInfo(e){if(e.introductionUrl="/course/".concat(e.id),e.registered&&"notStarted"===e.status?e.url=e.introductionUrl:e.url="/course/".concat(e.id,"/content"),e.instructorNames=r.map(e.instructors,"name").join(" / "),e.durationAsWeeks=o(e.end_date).diff(o(e.start_date),"weeks")+1,e.passedAsWeeks=e.durationAsWeeks,e.is_closed||(e.passedAsWeeks=o().diff(o(e.start_date),"weeks")+1),e.is_started||(e.passedAsWeeks=0),e.passedAsWeeks.toString().length<2&&(e.passedAsWeeks="0"+e.passedAsWeeks),e.durationAsWeeks.toString().length<2&&(e.durationAsWeeks="0"+e.durationAsWeeks),!r.isEmpty(e.lesson_info_lst)){var t={start_time:void 0,end_time:void 0};e.lesson_info_lst.forEach((function(e){var i,r,o=null===(i=e.lesson_slot_info)||void 0===i?void 0:i.start_time,a=null===(r=e.lesson_slot_info)||void 0===r?void 0:r.end_time;t.start_time=t.start_time&&t.start_time<o?t.start_time:o,t.end_time=t.end_time&&t.end_time>a?t.end_time:a})),e.timeSlotRange=t}return e.durationAsWeeksInNum=parseInt(e.durationAsWeeks,10)},isActivityRead:t,addLearningActivityRead(e,t){if(Array.isArray(e))return e.push({activity_id:t.id,activity_type:"learning_activity",completeness:"full"})},refreshActivitiesReadForMaterialActivity:(e,t)=>(r.remove(e,{activity_id:t.activity_id,activity_type:"learning_activity"}),e.push({activity_id:t.activity_id,activity_type:"learning_activity",completeness:t.completeness})),refreshPrerequisitesStatus:(e,t,i,r)=>(()=>{var o,a=[],n=s(t.course.modules);try{for(n.s();!(o=n.n()).done;){var u=o.value;v(t,u.directActivities,e,i,r),a.push(u.syllabuses.map((o=>v(t,o.activities,e,i,r))))}}catch(e){n.e(e)}finally{n.f()}return a})(),getActivityIcon(e,i,r){var o=c(e.type),a="";a=t(i,e)||r?"-read":a,a=this.activityExpired(e)?"-expired":a;var n=e.active?"-active":"";return"icon-syllabus-".concat(o).concat(n).concat(a)},getActivityGreyIcon(e){var t=c(e.type);return"material"===t&&"PPT"==e.data.material_type?"font-syllabus-interaction":"font-syllabus-".concat(t)},getActivityI18nMessage:(e,t)=>"material"!==e.type?t[e.type]:"PPT"===e.data.material_type?"PPT":t[e.type],activityExpired:e=>"unpublished"!==e.publish_type&&!["web_link","material","page","online_video","slide","lesson","classroom","scorm","feedback","vocabulary"].includes(e.type)&&(["homework","interaction","questionnaire","virtual_experiment","forum"].includes(e.type)?e.submission_closed:e.is_closed),activityUpcoming(e){if(e)return"unpublished"!==e.publish_type&&!e.is_started},activityPublishing:e=>!(!e||"scheduled"!==e.publish_type)&&e.is_in_progress,activityFinish:e=>"homework"===e.type&&"submitted"===e.status_code,activityOBERelated(e){var t;return!(null===(t=window.featureToggles)||void 0===t||!t.outcomeBasedEducation||!e)&&e.obe_tag},lessonDuration:(e,t)=>o(t).diff(o(e),"seconds"),videoDuration(e){if(!e)return 0;if(r.any(e,{status:"failed"}))return-2;if(r.any(e,{status:"processing"}))return-1;var t=r.reduce(e,((e,t)=>e+r.reduce(t.videos,((e,t)=>e+parseFloat(t.duration)),0)),0);return Math.round(t)},activityUrl(e,t){var i=arguments.length>3?arguments[3]:void 0;if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]){var r="/course/".concat(t,"/learning-activity/full-screen#/").concat(e.id);return void 0!==i&&(r+="/topics/".concat(i)),["exam","classroom","feedback","questionnaire","live_record","select_student","race_answer","number_rollcall","qr_rollcall"].includes(e.type)&&(r="/course/".concat(t,"/learning-activity/full-screen#/")+e.type+"/".concat(e.id)),r}switch(e.type){case"exam":case"classroom":case"feedback":case"questionnaire":case"danmu":case"vote":return"/course/".concat(t,"/learning-activity#/")+e.type+"/".concat(e.id);default:return"/course/".concat(t,"/learning-activity#/").concat(e.id)}},activityPopupName:e=>c(e.type),initChapterId(e,t,i,o){if(e.chapter={id:"0"},o){if(o.syllabus_id)return e.chapter.id="syllabus_".concat(o.syllabus_id);if(o.module_id)return e.chapter.id="module_".concat(o.module_id)}else{if(t.syllabus_id)return e.chapter.id="syllabus_".concat(t.syllabus_id);if(t.module_id)return e.chapter.id="module_".concat(t.module_id);if(e.isInSyllabusPage){var a=r.last(i.modules);if(r.isEmpty(a.syllabuses))return e.chapter.id="module_".concat(a.id);var n=r.last(a.syllabuses);return e.chapter.id="syllabus_".concat(n.id)}}},createActivity(e,t,i,r,o,a,n){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return e.courseCode=i.course_code,e.activityType=n,u(e,t,i,r,o,a,!0),e.$broadcast("bind".concat(n,"ForNew"),{course:i,moduleId:r,syllabusId:o,activityType:n,showSelectActivity:s})},editActivity(e,t,i,o,a,n,s){e.courseCode=i.course_code,e.activityType=s.type,u(e,t,i,o,a,n,!1);var c=r.map(s.type.split("_"),(e=>e.charAt(0).toUpperCase()+e.slice(1)));return e.$broadcast("bind".concat(c.join(""),"ForEdit"),s)},editModule(e,t,i,o){e.editing=!0;var n=e.name,s=function o(s){if("keydown"===s.type){if(27!==s.keyCode&&13!==s.keyCode)return}else if(s.target===a("input.module-name-edit")[0])return;if(s.stopPropagation(),!e.updating){delete e.editing;var u=function(t){return delete e.updating,e.id||(e.id=t.id),a("body")[0].removeEventListener("click",o,!0),a("body")[0].removeEventListener("keydown",o)},c=function(){return delete e.updating,e.name=n,e.id||r.remove(i.course.modules,e),a("body")[0].removeEventListener("click",o,!0),a("body")[0].removeEventListener("keydown",o)};return e.name&&e.name!==n&&27!==s.keyCode?(e.id?t.updateModule(e,u,c):t.addModule(e,u,c),e.updating=!0):(e.name=n,e.id||r.remove(i.course.modules,e),a("body")[0].removeEventListener("click",o,!0),a("body")[0].removeEventListener("keydown",o)),i.$apply()}};return o((function(){return a("body")[0].addEventListener("click",s,!0),a("body")[0].addEventListener("keydown",s),a("input.module-name-edit").focus()}))},showSlide:t=>(e.open("/user/slides/".concat(t),"_blank"),!0),canEditSelectedRubric:(e,t)=>t>0&&function(e,t){var i;if(!e)return!1;var o=r.pluck(e,"id");return i=parseInt(t),o.includes(i)}(e.rubrics,t)&&!e.ui.disableSelectRubric,rubricChanged(e){e.homework&&(-1===e.homework.rubric_id?e.$broadcast("openRubricPopup",-1,"add"):e.homework.rubric=r.find(e.rubrics,{id:parseInt(e.homework.rubric_id)}))},intraRubricChanged(e){-1===e.homework.intra_rubric_id?e.$broadcast("openRubricPopup",-1,"addIntra"):e.homework.intra_rubric=r.find(e.rubrics,{id:parseInt(e.homework.intra_rubric_id)})},handleHomeworkFormErrors(e){e.errors;return e.ui.showHomeworkAdvanced=!0},getDependantActivities(e,t,i){var r,o=[],a=function(t){if(i.activityHasPrerequisite(t))return(()=>{var i,r=[],a=s(t.prerequisites);try{for(a.s();!(i=a.n()).done;){var n=i.value;n.activity_id===e.id&&n.activity_type===e.type?r.push(o.push(t)):r.push(void 0)}}catch(e){a.e(e)}finally{a.f()}return r})()},n=s(t.modules);try{for(n.s();!(r=n.n()).done;){var u,c=r.value,l=s(c.directActivities);try{for(l.s();!(u=l.n()).done;)a(u.value)}catch(e){l.e(e)}finally{l.f()}var d,p=s(c.syllabuses);try{for(p.s();!(d=p.n()).done;){var v,y=s(d.value.activities);try{for(y.s();!(v=y.n()).done;)a(v.value)}catch(e){y.e(e)}finally{y.f()}}}catch(e){p.e(e)}finally{p.f()}}}catch(e){n.e(e)}finally{n.f()}return o},changeInfoOfDependantActivities:(e,t)=>e.map((e=>(()=>{var i,r=[],o=s(e.prerequisites);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.activity_id===t.id&&a.activity_type===t.type?(a.completion_criterion.criterion_text=t.completion_criterion,r.push(a.title=t.title)):r.push(void 0)}}catch(e){o.e(e)}finally{o.f()}return r})())),getDependantActivity:(e,t,i,o,a)=>(()=>{var u,c=[],l=s(e);try{for(l.s();!(u=l.n()).done;){var d=u.value;r.findWhere(t,{id:d.id,type:d.type})&&a.activityHasPrerequisite(d)?c.push((()=>{var e,t=[],a=s(n.copy(d.prerequisites));try{for(a.s();!(e=a.n()).done;){var u=e.value;u.activity_id===i.id&&u.activity_type===i.type?(r.remove(d.prerequisites,u),t.push(o.push({activity_id:d.id,activity_type:d.type}))):t.push(void 0)}}catch(e){a.e(e)}finally{a.f()}return t})()):c.push(void 0)}}catch(e){l.e(e)}finally{l.f()}return c})(),getUnusedPrerequisites(e,t){var i,o=[],a=s(n.copy(e.prerequisites));try{for(a.s();!(i=a.n()).done;){var u,c=i.value;c.key||(c.key="".concat(c.activity_type,"-").concat(c.activity_id)),u=c.key,r.map(t,"key").includes(u)||(o.push({activity_id:c.activity_id,activity_type:c.activity_type}),r.remove(e.prerequisites,c))}}catch(e){a.e(e)}finally{a.f()}return o},resetChapter(e){var t=r.find(e.modulesAndSyllabuses,{value:e.chapter.id});return e.chapter.module_id=t?t.moduleId:0,e.chapter.syllabus_id=t&&t.syllabusId?t.syllabusId:0},activityHasCriterion:e=>["exam","homework","forum","online_video"].includes(e.type)&&e.completion_criterion&&e.completion_criterion.match(/\d{1,3}/),getCriterion:e=>parseInt(e.completion_criterion.match(/\d{1,3}/)[0]),calculateCompletenessForHasCriterionActivity(e,t){if(e.data){if("reviewed"===t.completion_criterion_key)return"full"!==e.completeness?.1:(e=>"homework"===e.type&&(e.inter_score_map&&e.inter_score_map.id||e.intra_score_map&&e.intra_score_map.id))(t)?e.data.reviewed?e.data.reviewed:.1:100;if(e.data.completeness)return e.data.completeness>=t.criterion?100:e.data.completeness;if(e.data.score)return e.data.score>=t.criterion?100:Math.round(100*e.data.score/t.criterion)}else{if("online_video"!==t.type)return.1;if("full"===e.completeness)return 100}},updateCriterionInfoForActivities:(e,t)=>t.map((t=>e.modules.map((e=>(()=>{var i,r=[],o=s(e.directActivities);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.id===t.id&&a.type===t.type&&(t.prerequisites=a.prerequisites),r.push(e.syllabuses.map((e=>(()=>{var i,r=[],o=s(e.activities);try{for(o.s();!(i=o.n()).done;)(a=i.value).id===t.id&&a.type===t.type?r.push(t.prerequisites=a.prerequisites):r.push(void 0)}catch(e){o.e(e)}finally{o.f()}return r})())))}}catch(e){o.e(e)}finally{o.f()}return r})())))),deleteActivityFromCourse(e,t){if(r.remove(e.activities,{id:t.id,type:t.type}),t.module_id)return(()=>{var i,o=[],a=s(e.modules);try{for(a.s();!(i=a.n()).done;){var u,c,l=i.value,d=s(n.copy(l.directActivities));try{for(d.s();!(c=d.n()).done;)(u=c.value).id===t.id&&u.type===t.type&&(r.remove(l.activities,u),r.remove(l.directActivities,u))}catch(e){d.e(e)}finally{d.f()}o.push(l.syllabuses.map((e=>(()=>{var i,o=[],a=s(n.copy(e.activities));try{for(a.s();!(i=a.n()).done;)(u=i.value).id===t.id&&u.type===t.type?(r.remove(l.activities,u),o.push(r.remove(e.activities,u))):o.push(void 0)}catch(e){a.e(e)}finally{a.f()}return o})())))}}catch(e){a.e(e)}finally{a.f()}return o})()},refreshPrerequisitesForDependantActivities:(e,t,i)=>i.map((i=>(()=>{var o,a=[],n=s(e);try{for(n.s();!(o=n.n()).done;){var u=o.value;i.id===u.activity_id&&i.type===u.activity_type?a.push(r.remove(i.prerequisites,(e=>e.activity_id===t.id&&e.activity_type===t.type))):a.push(void 0)}}catch(e){n.e(e)}finally{n.f()}return a})())),refreshPrerequisitesForAllDependantActivities:(e,t)=>(()=>{var i,o=[],a=s(e.modules);try{for(a.s();!(i=a.n()).done;){var n,u,c=i.value,l=s(c.directActivities);try{for(l.s();!(u=l.n()).done;)n=u.value,r.remove(n.prerequisites,(e=>e.activity_id===t.id&&e.activity_type===t.type))}catch(e){l.e(e)}finally{l.f()}o.push(c.syllabuses.map((e=>(()=>{var i,o=[],a=s(e.activities);try{for(a.s();!(i=a.n()).done;)n=i.value,o.push(r.remove(n.prerequisites,(e=>e.activity_id===t.id&&e.activity_type===t.type)))}catch(e){a.e(e)}finally{a.f()}return o})())))}}catch(e){a.e(e)}finally{a.f()}return o})(),removeOldActivity(e,t){var i=function(e){return!!e&&(e.id===t.id&&(e.type=t.type))};return r.remove(e.activities,i),r.remove(e.directActivities,i),r.each(e.syllabuses,(e=>r.remove(e.activities,i)))},addNewActivity(e,t){if(t.id===e.module_id){if(t.activities=t.activities||[],t.activities.push(e),!e.syllabus_id)return t.directActivities=t.directActivities||[],t.directActivities.push(e);var i=r.find(t.syllabuses,{id:e.syllabus_id});if(i)return i.activities=i.activities||[],i.activities.push(e)}},refreshPrerequisitesForCurrentActivity:(e,t,i)=>(y(t,e),y(i.activities,e),(()=>{var t,r=[],o=s(i.modules);try{for(o.s();!(t=o.n()).done;){var a=t.value;y(a.directActivities,e),r.push(a.syllabuses.map((t=>y(t.activities,e))))}}catch(e){o.e(e)}finally{o.f()}return r})()),uploadIsWebResource:e=>!!(e&&e.source&&e.third_part_referrer_id)&&-1!=e.key.indexOf("http")}}]},635224:function(e,t,i){var r=i(730381),o=i(904072);t.datetime=()=>function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY.MM.DD HH:mm";r.locale(o("html").attr("lang"));var i=r(e);return i.isValid()?i.format(t):e},t.time=()=>function(e){r.locale(o("html").attr("lang"));var t=r(e);return t.isValid()?t.format("HH:mm"):e},t.date=()=>function(e,t){t||(t="YYYY.MM.DD"),r.locale(o("html").attr("lang"));var i=r(e);return i.isValid()?i.format(t):e},t.dateWithoutYear=()=>function(e){r.locale(o("html").attr("lang"));var t=r(e);return t.isValid()?t.format("MM-DD"):e}}}]);