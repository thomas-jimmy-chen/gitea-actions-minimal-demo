(self.webpackChunklms=self.webpackChunklms||[]).push([[78571],{978571:function(__unused_webpack_module,exports,__webpack_require__){var $=__webpack_require__(904072),_=__webpack_require__(708468),moment=__webpack_require__(730381),helper=__webpack_require__(293789),angular=__webpack_require__(361204),Decimal=__webpack_require__(993776);function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}__webpack_require__(141817),__webpack_require__(491038),__webpack_require__(682772),__webpack_require__(66992),__webpack_require__(365069),__webpack_require__(140561),__webpack_require__(556977),__webpack_require__(426833),__webpack_require__(788674),__webpack_require__(339714),__webpack_require__(132023),__webpack_require__(804723),__webpack_require__(115306),__webpack_require__(864765),__webpack_require__(323123),__webpack_require__(923157),__webpack_require__(573210),__webpack_require__(454747),__webpack_require__(333948),__webpack_require__(691285),__webpack_require__(678736);var hljs=__webpack_require__(398128),iFrameResize=__webpack_require__(246955),I18n=__webpack_require__(117403).default,Vue=__webpack_require__(370538).default,vueMultiPlayer=__webpack_require__(385565).default,sortable=__webpack_require__(751474),Sortable=sortable.default,utils=__webpack_require__(693604),uploadApi=__webpack_require__(201351),uploadService=__webpack_require__(606565);exports.parseInteger=()=>({restrict:"A",require:"?ngModel",link(e,t,n,r){r.$parsers.push(utils.parseInteger),r.$formatters.push((function(e){return""+e}))}}),exports.ngCompileHtml=["$compile",e=>function(t,n,r){t.$watch(r.ngCompileHtml,(function(){var i,o=t.$eval(r.ngCompileHtml);o=o.replace(/]]/g,"]\x3c!----\x3e]"),n.html(o),0!==(i=document.getElementsByClassName("pre-wrap subject-description simditor-viewer")).length&&i.forEach((e=>{e.getElementsByClassName("simditor-attachment").forEach((e=>{var t,n;n="compiled",(t=e)&&(t.classList.contains(n)||t.classList.add(n))}))})),e(n.contents())(t)}))}],exports.simditorAudio=()=>({restrict:"A",replace:!0,scope:{src:"@",id:"@",name:"@"},template:'\n            <span ng-show="finishRendering" class="simditor-audio-player compiled" ng-class="{\'playing\': status != \'ready\'}">\n                <span class="simditor-audio-container" ng-class="{\'disabled\': !allowPlay() && status == \'ready\', \'exam-mode\': inExam && resourceLoaded, \'not-loaded\': !resourceLoaded}">\n                  <span class="play" ng-click="playButton($event)" ng-class="{\'disabled\': (status == \'play\' && inExam) || !resourceLoaded}">\n                      <i ng-if="status==\'ready\'" class="font font-simditor-audio-play"></i>\n                      <i ng-if="status==\'play\'" class="font font-simditor-audio-pause"></i>\n                      <i ng-if="status==\'pause\'" class="font font-simditor-audio-continue"></i>\n                  </span>\n                  <span class="name truncate-text" tipsy-literal="{{ name }}" tipsy-ellipsis="yes" tipsy-ellipsis-check-method="width"\n                          tipsy-follow-element-width="true" ng-if="!inExam && resourceLoaded">{{ name }}</span>\n                  <span class="name load-failed" ng-if="!resourceLoaded && !isAudioLoading" ng-bind="notLoadedMessage[lang]"></span>\n                  <span class="simditor-audio-wrapper" ng-class="{\'with-name\': !inExam || !resourceLoaded}">\n                     <span class="duration">\n                          <span ng-bind="ui.currentTime | secondsToHms"></span><span>/</span><span ng-bind="ui.duration | secondsToHms"></span>\n                     </span>\n                     <span class="volume-bar" ng-class="{\'disabled\': (!allowPlay() && status == \'ready\') || !resourceLoaded}">\n                          <input class="volume-slider" type="range" min="0" max="100" ng-model="volume" ng-change="modifyVolume()">\n                          <i ng-show="volume" ng-click="mute()" class="font font-audio-volume2"></i>\n                          <i ng-hide="volume" ng-click="unmute()" class="font font-audio-volume-off2"></i>\n                     </span>\n                     <span class="progress-bar">\n                          <div class="progress"></div>\n                     </span>\n                  </span>\n                  <audio id="{{id}}" preload="none" class="audio">\n                     <source src="{{src}}">\n                  </audio>\n                </span>\n                <span class="warning-container" ng-if="play_limit && inExam">\n                    <span class="warning" ng-bind="leftTimesWarningMessage[lang] | format:[left_times]"></span>\n                </span>\n            </span>',link(e,t,n,r){var i=t.find("audio")[0],o=$(i),a=t.find("audio source")[0],l=t.find(".progress")[0],s=$(l);if(e.$parent.subject||e.$parent.currentSubject){e.play_record=e.$parent.play_record||{},e.play_times=e.play_record[e.id]||0,e.subject=e.$parent.subject||e.$parent.currentSubject,e.subject.settings=e.subject.settings||{},e.play_limit=e.subject.play_limit||e.subject.settings.play_limit||!1,e.play_limit_times=e.subject.play_limit_times||e.subject.settings.play_limit_times||0;var d=e.play_limit_times-e.play_times;e.left_times=d>=0?d:0}e.lang=e.$parent.lang,e.ui={currentTime:0,duration:0},e.volume=100,e.expandVolume=!1,e.currentAudioScope={},e.inExam=e.$parent.inExam||!1,e.status="ready",e.isAudioLoading=!0,setTimeout((function(){e.finishRendering=!0,e.$apply()}),1500),e.leftTimesWarningMessage={"en-GB":"Playback Limits : {0}","en-US":"Playback Limits : {0}","zh-CN":"剩余播放次数: {0}","zh-MO":"剩餘播放次數: {0}","zh-TW":"剩餘播放次數: {0}"},e.notLoadedMessage={"en-GB":"Error: data loss or transcoding.","en-US":"Error: data loss or transcoding.","zh-CN":"无法播放，文件遗失或转码中","zh-MO":"無法播放，檔案遺失或轉碼中","zh-TW":"無法播放，檔案遺失或轉碼中"},e.allowPlay=function(){return!!e.resourceLoaded&&(!e.inExam||(!e.subject||(!e.play_limit||e.left_times>0)))},e.playButton=function(t){return t.preventDefault(),!!e.allowPlay()&&("play"==e.status?!e.inExam&&e.pause():void(e.currentAudioScope!=e&&"play"==e.currentAudioScope.status?e.inExam?($("#switch-audio-confirmation-popup").foundation("reveal","open"),e.$root.$broadcast("initSwitchAudioPopup",{currentAudioScope:e.currentAudioScope,nextAudioScope:e})):e.$root.$broadcast("switchAudio",{currentAudioScope:e.currentAudioScope,nextAudioScope:e}):e.play()))},e.pause=function(){return i.pause(),e.status="pause",e.$root.$broadcast("simditorAudioStatus",e),e.updateSliderColor(),e.status},e.play=function(){e.subject&&(e.play_record[e.id]=(e.play_record[e.id]||0)+1,e.play_record.needSync=!0,e.$emit("playRecordUpdated"),e.left_times-=1),e.status="play",i.play(),e.$root.$broadcast("simditorAudioStatus",e),e.updateSliderColor()},e.end=function(){i.pause(),i.currentTime=0,e.status="ready",e.updateSliderColor(),e.$apply(),e.$root.$broadcast("simditorAudioStatus",e)},e.mute=function(){e.tempVolume=e.volume,e.volume=0,e.modifyVolume()},e.unmute=function(){e.volume=e.tempVolume||100,e.modifyVolume()},e.audio=i,i.onended=function(){i.currentTime=0,e.status="ready",e.updateSliderColor(),e.$apply(),e.$root.$broadcast("simditorAudioStatus",e)},i.onloadeddata=function(){e.resourceLoaded=!0,e.finishRendering=!0,e.isAudioLoading=!1,e.$apply(),"true"===n.autoplay&&e.play()},a.onerror=()=>{e.isAudioLoading=!1,e.$apply()},e.modifyVolume=function(){i.volume=e.volume/100,e.updateSliderColor()},e.updateSliderColor=function(){var t,n;t="ready"!=e.status?"#ffffff":"#6C6C6C",n="ready"!=e.status?"#0089B3":"#B5B5B5",$(".volume-slider").css("background","linear-gradient(to right, ".concat(t," 0%, ").concat(t," ").concat(e.volume,"%, ").concat(n,"  ").concat(e.volume,"%, ").concat(n," 100%)"))},o.on("durationchange",(function(){e.ui.duration=i.duration,e.$apply()})),o.on("timeupdate",(function(){e.ui.currentTime=i.currentTime,s.width("".concat(parseInt(100*i.currentTime/i.duration),"%")),e.$apply()})),e.$on("simditorAudioStatus",(function(t,n){e.currentAudioScope=n})),e.$on("switchAudio",(function(t,n){n.nextAudioScope==e?e.play():n.currentAudioScope==e&&(e.inExam?(i.pause(),i.currentTime=0,e.status="ready",e.updateSliderColor()):(i.pause(),e.status="pause",e.updateSliderColor()))})),t.find(".volume-bar").mouseover((function(){e.expandVolume=!0})),e.updateSliderColor(),i.load()}}),exports.expandableContent=()=>({restrict:"A",link(e,t,n,r){var i=n.expandableContent;e.isExpanded=["module","bulletin","classification","topic"].includes(i);var o=function(){return e.isExpanded?$(".".concat(i,"-summary"),t).addClass("expanded"):$(".".concat(i,"-summary"),t).removeClass("expanded")};return o(),$(".".concat(i,"-summary"),t).on("click",(function(){return $(".".concat(i,"-content"),t).slideToggle(100),e.isExpanded=!e.isExpanded,o(),e.$apply()}))}}),exports.expandableContentRemember=["$timeout",e=>({restrict:"A",scope:{cookieKey:"@",toggleModel:"="},link(t,n,r){var i=r.expandableContentRemember,o=null,a=r.manualExpandedModuleId?parseInt(r.manualExpandedModuleId):"",l=null==r.toggleEmptyContent||"true"===r.toggleEmptyContent,s=null!=r.defaultExpanded?"true"===r.defaultExpanded:"module"===i||"classification"===i||"syllabus"===i;t.isExpanded=s;var d={},c=function(){var e,r,o=$(".".concat(i,"-summary .expand-collapse-button > .icon"),n),a=["icon-module-toggle-collapsed","icon-toggle-collapsed-lighter","font-toggle-collapsed","font-module-collapse","font-down","font-collapse-arrow"],l=["icon-module-toggle-expanded","icon-toggle-expanded-lighter","font-toggle-expanded","font-module-expand","font-up","font-expand-arrow"];return t.isExpanded?(e=l,r=a,$(".".concat(i,"-summary"),n).addClass("expanded"),$(n).addClass("expanded"),t.$emit("expandableContentExpanded",t.toggleModel)):(e=a,r=l,$(".".concat(i,"-summary"),n).removeClass("expanded"),$(n).removeClass("expanded"),t.$emit("expandableContentCollapsed",t.toggleModel)),_.each(r,(function(t,n){if(o.hasClass(t))return o.removeClass(t),o.addClass(e[n])}))},u=function(){return _.has($.cookie(),t.cookieKey)?JSON.parse($.cookie()[t.cookieKey]):{}},p=function(){return""!==a?t.toggleModel.id===a:_.has(d,t.toggleModel.id)?d[t.toggleModel.id]:s},f=function(){d=u();var e=p();return $(".".concat(i,"-content"),n).slideToggle(100),t.isExpanded=!e,o&&o.trigger("memberUpdated"),d[t.toggleModel.id]=t.isExpanded,$.cookie(t.cookieKey,JSON.stringify(d),{expires:365}),c(),t.$apply()};return t.change=function(e){if(e!==t.isExpanded)return f()},t.isToggleable=()=>l||(null!=t.toggleModel.syllabuses?t.toggleModel.syllabuses.length:void 0)||(null!=t.toggleModel.activities?t.toggleModel.activities.length:void 0),$(".".concat(i,"-summary"),n).on("click",(function(){if(t.isToggleable())return f()})),$(".not-toggle-content",n).on("click",(function(e){e.stopPropagation()})),n.on("$destroy",(function(){if(o)return o.trigger("memberRemoved",t)})),e((function(){return d=u(),t.isExpanded=p(),t.isExpanded||$(".".concat(i,"-content"),n).hide(),r.toggleGroup&&(o=$("#"+r.toggleGroup)).trigger("memberCreated",t),c()}))}})],exports.foldableContentRemember=["$timeout","$rootScope",(e,t)=>({restrict:"A",scope:{cookieKey:"@"},link(n,r){var i={};$("#course-menubar-fold",r).on("click",(function(){i=o();var e=l();return t.isFold=!e,a(),n.$apply()}));var o=function(){return _.has($.cookie(),n.cookieKey)?JSON.parse($.cookie()[n.cookieKey]):{}},a=function(){return i.isFold=t.isFold,$.cookie(n.cookieKey,JSON.stringify(i),{expires:365})},l=function(){return!_.has(i,"isFold")||i.isFold};return e((function(){return i=o(),t.isFold=l()}))}})],exports.expandableContentNew=["$timeout",e=>({restrict:"A",link:(t,n,r)=>e((function(){var e=r.expandableContentNew;if(t.isExpanded="true"===r.isExpanded,$(".".concat(e)).length)return t.isExpanded||$(".".concat(e)).css("display","none"),n.on("click",(function(){var r=t.isExpanded?n.data("collapsed"):n.data("expanded");if(r&&n.html(r),$(".".concat(e)).slideToggle(100),t.isExpanded=!t.isExpanded,!t.$$phase)return t.$apply()}))}),300)})],exports.expandableContentIsolate=["$timeout",e=>({restrict:"A",scope:!0,link:(t,n,r)=>e((function(){var e=r.expandableContentIsolate;if(t.isExpanded="true"===r.isExpanded,$(".".concat(e)).length)return t.isExpanded||$(".".concat(e)).css("display","none"),n.on("click",(function(){var r=t.isExpanded?n.data("collapsed"):n.data("expanded");return r&&n.html(r),$(".".concat(e)).slideToggle(100),t.isExpanded=!t.isExpanded,t.$apply()}))}))})],exports.toggleGroupManager=()=>({restrict:"A",link(e,t,n){t.attr("id",n.toggleGroupManager),e.isExpanded="true"===n.defaultExpanded,e.members={};var r=!0,i=function(){return r=!r,t.toggle()},o=function(){if(r!==function(){for(var t=0,n=Object.keys(e.members||{});t<n.length;t++)return n[t],!0;return!1}())return i()},a=function(){if(function(){for(var t=!1,n=0,r=Object.keys(e.members||{});n<r.length;n++){var i=r[n],o=e.members[i];if(o.isToggleable()&&(t=!0,!o.isExpanded))return!1}return t}()!==e.isExpanded)return e.isExpanded=!e.isExpanded};return t.on("click",(function(){return e.isExpanded=!e.isExpanded,t=e.isExpanded,(()=>{for(var n=[],r=0,i=Object.keys(e.members||{});r<i.length;r++){var o=i[r],a=e.members[o];a.isToggleable()?n.push(a.change(t)):n.push(void 0)}return n})();var t})),t.on("click-to-expand",(function(){return e.isExpanded=!0,t=e.isExpanded,(()=>{for(var n=[],r=0,i=Object.keys(e.members||{});r<i.length;r++){var o=i[r],a=e.members[o];a.isToggleable()&&a.isExpanded===!t?n.push(a.change(t)):n.push(void 0)}return n})();var t})),t.on("memberCreated",(function(t,n){return e.members[n.$id]=n,o(),a()})),t.on("memberUpdated",(()=>a())),t.on("memberRemoved",(function(t,n){return e.members[n.$id]&&delete e.members[n.$id],o()})),i()}}),exports.smsPin=["$http","$timeout","toastr","commonApi",(e,t,n,r)=>({restrict:"A",link(e,n,i){var o=n.text(),a=i.waitingText,l=i.errorField,s=i.waitingSeconds||60,d="false"!==i.validateExist,c=e=>function(){var r=Math.floor((new Date).getTime()/1e3);if(r<e){var i=e-r;return n.text(a.replace("{0}",i)),t(c(e),1e3)}return n.text(o),n.on("click",f)},u=function(){n.unbind("click");var e=Math.floor((new Date).getTime()/1e3)+s;return c(e)()},p=function(t){if(e.errors=t.errors,l)return e.errors[l]=t.errors.mobile_phone},f=()=>r.requestSMSPinCode(i.phoneNumber,u,p,d);return n.on("click",f)}})],exports.datepicker=["$timeout",e=>({restrict:"A",require:"ngModel",link:(t,n,r,i)=>(n.prop("autocomplete","off"),e((()=>n.datetimepicker({format:"YYYY-MM-DD",language:$("html").attr("lang"),pickTime:!1,useCurrent:!1}).on("dp.hide",(()=>i.$setViewValue($(n).val()))))))})],exports.timepicker=["$timeout",e=>({restrict:"A",require:"ngModel",link:(t,n,r,i)=>(n.prop("autocomplete","off"),e((()=>n.datetimepicker({format:"HH:mm",language:$("html").attr("lang"),pickDate:!1,useCurrent:!1}).on("dp.hide",(()=>i.$setViewValue($(n).val()))))))})],exports.datetimepicker=["$timeout",e=>({restrict:"A",require:"ngModel",link(t,n,r,i){var o,a;n.prop("autocomplete","off"),r.hasOwnProperty("noTime")?(a=!1,o="YYYY-MM-DD"):(a=!0,o="YYYY-MM-DD HH:mm");return i.$parsers.push((function(e){var t=moment(e,o,!0);return t.isValid()?t.utc().format("YYYY-MM-DDTHH:mm:ss")+"Z":e})),i.$formatters.push((function(e){var t=moment(e);return t.isValid()?t.format(o):e})),i.$formatters.push((function(e){var t=moment(e),r=n.data("DateTimePicker");return t.isValid()&&r&&r.setValue(t),e})),e((()=>n.datetimepicker({format:o,language:$("html").attr("lang"),pickTime:a,useCurrent:!0}).on("dp.hide",(()=>i.$setViewValue($(n).val()))).on("keypress",(function(e){if(13===e.keyCode)return i.$setViewValue($(n).val()),$(this).blur()}))))}})],exports.confirmDialog=()=>({priority:-1,restrict:"A",scope:{getConfirmMessage:"&"},link:(e,t,n)=>t.on("click",(function(t){var r=function(){var t=n.confirmDialog;return!t&&e.getConfirmMessage&&(t=e.getConfirmMessage()),t}();if(n.disabled||!window.confirm(r))return t.stopImmediatePropagation(),t.preventDefault()}))}),exports.hasSecondLevelMenu=()=>({restrict:"A",scope:{expandLeft:"="},link(e,t,n){$(t).find("li:has(ul.second-level)").mouseenter((function(){if(e.expandLeft){var t=$(this).find("ul").first().width();$(this).find("ul").first().css("left",-t-2+"px")}$(this).find("ul").first().show()})).mouseleave((function(){$(this).find("ul").first().hide()})),$(t).find("li:has(ul.second-level)").on("touchstart",(function(){$(this).parent().children("li").children("ul").hide();var t=$(this).find("ul").first().width();if($(this).find("ul").first().css("left",-t-2+"px"),$(this).find("ul").first().show(),e.ui)return e.ui.touchList=!0}))}}),exports.closeDropdown=()=>({restrict:"A",link:(e,t,n)=>t.on("click",(()=>$("#".concat(n.closeDropdown)).foundation("dropdown","close",$("#".concat(n.closeDropdown)))))}),exports.replyList=["$timeout","$routeParams",(e,t)=>({restrict:"A",link(n,r){if(t.scrollTo){n.topic.replies.length>5&&(n.topic.showAllReplies=!0);return e((function(){var e=r.find(".".concat(t.scrollTo));if(e.length>0)return e[0].scrollIntoView()}))}}})],exports.unreadReply=()=>({restrict:"A",link(e,t,n){if("true"===n.unreadReply)return e.unreadReplies.push(t)}}),exports.unvisiableReply=()=>({restrict:"A",link(e,t,n){if(parseInt(n.id))return e.unvisiableReplies.push(t)}}),exports.scrollToLastReply=["$location","$anchorScroll","$timeout",(e,t,n)=>({restrict:"A",link(r,i,o){var a="last_reply";if(r.$eval(o.scrollToLastReply))return i.attr("id",a),n((function(){return e.hash(a),t()}),0)}})],exports.focus=["$timeout",e=>({restrict:"A",link:(t,n,r)=>t.$watch(r.focus,(function(t){if(t)return e((()=>n[0].focus()))}))})],exports.formatScore=()=>({restrict:"A",require:"?ngModel",link:(e,t,n,r)=>r.$formatters.push(utils.formatScore)}),exports.treeView=["$compile","$timeout",(e,t)=>({restrict:"A",require:"?ngModel",link(n,r,i){var o=i.treeId,a=i.treeModel,l=i.treeLevel||1,s=parseInt(l)+1,d=i.multiple||"false",c=i.needDefault,u=i.defaultName||"",p=i.defaultId,f=n.$eval(i.ngModel),g=i.usedFor||"departments",m=i.needFilter||"false",h=i.keywordPlaceholder||"",v=i.noResultsTip||"",b=i.conditionModel,y=i.alwaysResetClickEvent||"false",w=i.afterClickNode||"",k=i.initSelect||!1,x=i.initSelectModel||i.ngModel,C=i.stoppedDepartmentTip||"",S=i.needSwitchAll||"false",T=i.switchAllTip||"",A=i.updateErrorMessage||"false",E=i.triggerSearch||"true",M=i.name||"",I=i.dropDownMenu||"false",P=i.hideDropDown||"true";var F={study_course_classifications:"classification",departments:"departments",classifications:"children",subject_libs:"children",subject_libs_table:"children",bulletin_targets:"children",org:"children"},V=function(){if("true"===P)return r.hide()},L=e=>e[F[g||""]]||[],N=function(e){if("bulletin_targets"!==g||"gs".includes(e.id[0])){var t=e.id.toString(),n=f.indexOf(t);return e.selected&&-1===n&&f.push(e.id.toString()),e.selected||-1===n?void 0:f.splice(n,1)}},q=function(){var e=n.$eval(i.treeModel);return n.allChosen=!j(e)},O=function(e){if(e){var t=n[o].keyword;return"true"!==c||void 0!==t&&""!==t||n[o].defaultNode.selected?q():n.allChosen=!1}n.allChosen=!1},j=function e(t){return!(!t||!t.length)&&_.any(t,(t=>!t.selected||e(L(t))))},R=function e(t,n){t.selected=n,N(t);var r=F[g]||"";return t.hasOwnProperty(r)&&_.forEach(t[r]||[],(t=>e(t,n))),D()},H=e=>(()=>{var t,n=[],r=_createForOfIteratorHelper(L(e));try{for(r.s();!(t=r.n()).done;){var i=t.value;e.selected&&i.selected||(i.selected=e.selected,N(i)),L(i)?n.push(H(i)):n.push(void 0)}}catch(e){r.e(e)}finally{r.f()}return n})(),D=function(){var e,t,i=r.parent(".tree-view").find("span.title");f&&(e=_.filter(f,(e=>e&&e.toString().indexOf("root-")<0&&"a0"!=e)));var a=e?e.length:0;return t=0===a?r.parent(".tree-view").find("#default-text").text()||$("#selected-text-all").text():1===a?r.find("span[data-id="+e[0]+"]").data("name"):$("#selected-text").text().replace("#",a),i.text(t),n[o].title=t},z=function(e){return r.parent(".tree-view").find("span.select2-chosen").text(e.name)};n[o]=n[o]||{},n[o].defaultNode=n[o].defaultNode||{id:p,name:u,departments:[],selected:!!Array.isArray(f)&&f.includes(p)},n[o].toggleChildren=n[o].toggleChildren||function(e,t){return e.stopPropagation(),t.expanded=!t.expanded},"true"!==y&&null!=n[o].clickNode||(n[o].clickNode=function(e,t){(e.stopPropagation(),null!=t.id)&&(f=n.$eval(i.ngModel),"true"===d?function(e){if(e.selected=!e.selected,"true"===A&&n.errors&&n.errors[M]&&delete n.errors[M],N(e),["departments","study_course_classifications","classifications","bulletin_targets","org"].includes(g)&&helper.guard(L(e),(e=>e.length))&&H(e),D(),"true"===S&&O(e.selected),"function"==typeof n.search&&!["bulletin_targets"].includes(g)&&"true"===E)n.search()}(t):function(e){n.$eval("".concat(i.ngModel," = ").concat(e.id)),V(),z(e)}(t),w&&n.$eval(w)(t))}),1===l&&(n[o].switchAll=function(){var e=r.find("#switch_all").prop("checked");"true"===A&&n.errors&&n.errors[M]&&delete n.errors[M];var t=n.$eval(i.treeModel);f=n.$eval(i.ngModel);var a=n[o].keyword;if("true"!==c||void 0!==a&&""!==a||R(n[o].defaultNode,e),_.forEach(t,(t=>R(t,e))),"function"==typeof n.search&&!["bulletin_targets"].includes(g)&&"true"===E)return n.search()});var B='<li ng-click="'+o+".clickNode($event, "+o+'.defaultNode)"><div id="defaultTreeNode'+n.$id+'" class="item"><i class="blank"></i><span class="content" data-id="'+p+'" data-name="'+u+'"><input class="input" ng-if="'+d+' == true" type="checkbox" ng-checked="'+o+'.defaultNode.selected" /><span class="name truncate-text" ng-bind="'+o+'.defaultNode.name" tipsy="'+o+'.defaultNode.name" ng-attr-tipsy-follow-element-width="true" ng-attr-tipsy-ellipsis-check-method="width"></span><span class="status-label" ng-if="node.stopped">'+C+"</span></span></div></li>",W='<div class="search-header"  ng-click="$event.stopPropagation()"><div class="ui-multiselect-filter"><span class="search-content"><i class="icon icon-search-in-dropdown"></i><input class="keyword" type="text" ng-model="'+b+'.keyword" placeholder="'+h+'" ng-keyup="triggerSearchTreeView()" /></span></div></div>',U='<div class="search-header" ng-click="$event.stopPropagation()"><div class="ui-multiselect-filter"><div class="search-content"><i class="icon icon-search-in-dropdown"></i><input class="keyword" type="search" ng-model="'+b+'.keyword"placeholder="'+h+'" ng-change="triggerSearchTreeView()" /></div></div></div>',Y=1===l&&"true"===c?B:"",G="";1===l&&"true"===m&&(G=-1!==a.indexOf("departments")?U:W);var K="";1===l&&"true"===S&&(K='<div ng-click="$event.stopPropagation()"><div class="switch-all-nodes"><input class="input" id="switch_all" type="checkbox" ng-click="'+o+'.switchAll()" ng-model="allChosen"/>'+T+"</div></div>");var J="",X="";k&&(J=' ng-init="node.selected = '+x+'.indexOf(node.id.toString()) != -1"',X=' init-select-model="'+x+'" init-select="true"');var Q="";l>1&&(Q='style="overflow-y: hidden; max-height: 100%"');var Z=G+K+'<ul class="tree-level"'+Q+">"+Y+'<li class="no-result" ng-if="'+a+".length == 0 && !"+c+'"><div class="item"><span class="content">'+v+'</span></div></li><li ng-repeat="node in '+a+'" ng-click="'+o+'.clickNode($event, node)"><div class="item tree-level-'+l+'" style="padding-left: '+10*l+'px"><i class="font font-tree-expanded" ng-if="node.departments.length && !node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="font font-tree-collapsed" ng-if="node.departments.length && node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="blank" ng-hide="node.departments.length"></i><span class="content" data-id="[[node.id]]" data-name="[[node.name]]"'+J+'><input class="input" ng-if="'+d+' == true" type="checkbox" ng-checked="node.selected" /><span class="name truncate-text" tipsy="node.name" ng-attr-tipsy-follow-element-width="true"  ng-attr-tipsy-ellipsis-check-method="width">[[node.name]]</span><span class="status-label" ng-if="node.stopped">'+C+'</span></span></div><div tree-view="true" ng-if="node.expanded" tree-id="'+o+'" multiple="'+d+'" tree-model="node.departments" tree-level="'+s+'"'+X+'stopped-department-tip="'+C+'"></div></li></ul>',ee=G+'<ul class="tree-level">'+Y+'<li ng-if="'+a+".length == 0 && !"+c+'"><div class="item"><span class="content">'+v+'</span></div></li><li ng-repeat="node in '+a+'" ng-click="'+o+'.clickNode($event, node)"><div class="item-group" ng-if="!node.id"><span class="content" ng-bind="node.name"></span></div><div class="truncate-text item" style="padding-left: '+10*l+'px" ng-if="node.id"><i class="font font-tree-expanded" ng-if="node.children.length && !node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="font font-tree-collapsed" ng-if="node.children.length && node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="blank" ng-hide="node.children.length"></i><span class="content" data-id="[[node.id]]" data-name="[[node.name]]" title="[[node.display_name]]"><input class="input" ng-if="'+d+' == true" type="checkbox" ng-checked="node.selected" />[[node.display_name]]</span></div><div tree-view="true" ng-if="node.expanded" tree-id="'+o+'" multiple="[[node.childType === \'group\']]" used-for="'+g+'"tree-model="node.children" tree-level="'+s+'"></div></li></ul>',te='<ul class="tree-level"><li ng-repeat="node in '+a+'" ng-click="'+o+'.clickNode($event, node)"><div class="item" style="padding-left: '+10*l+'px"><i class="font font-tree-expanded" ng-if="node.classification.length && !node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="font font-tree-collapsed" ng-if="node.classification.length && node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="blank" ng-hide="node.classification.length"></i><span class="content" data-id="[[node.id]]" data-name="[[node.name]]"><input class="input" ng-if="'+d+' == true" type="checkbox" ng-checked="node.selected" />[[node.name]]</span></div><div tree-view="true" ng-if="node.expanded" tree-id="'+o+'" multiple="'+d+'"tree-model="node.classification" tree-level="'+s+'"></div></li></ul>',ne='<ul class="tree-level"><li ng-repeat="node in '+a+'" ng-click="'+o+'.clickNode($event, node)"><div class="item tree-level-'+l+'" style="padding-left: '+10*l+'px"><i class="font font-tree-expanded" ng-if="node.children.length && !node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="font font-tree-collapsed" ng-if="node.children.length && node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="blank" ng-hide="node.children.length"></i><span class="content" data-id="[[node.id]]" data-name="[[node.name]]"'+J+'><input class="input" ng-if="'+d+' == true" type="checkbox" ng-checked="node.selected" /><span class="name truncate-text" tipsy="node.name" ng-attr-tipsy-follow-element-width="true"  ng-attr-tipsy-ellipsis-check-method="width">[[node.name]]</span></div><div tree-view="true" ng-if="node.expanded" tree-id="'+o+'" multiple="'+d+'"used-for="'+g+'"tree-model="node.children" tree-level="'+s+'"'+X+'"></div></li></ul>',re='<ul class="tree-level"><li ng-repeat="node in '+a+'" ng-click="'+o+'.clickNode($event, node)"><div class="item tree-level-'+l+'" style="padding-left: '+17*l+'px"><i class="font font-down collapsed" ng-if="node.children.length && !node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="font font-down" ng-if="node.children.length && node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="blank" ng-hide="node.children.length"></i><i class="font font-file-folder" ng-if="node.type == \'folder\' && !node.expanded"></i><i class="font font-file-folder-expanded" ng-if="node.type == \'folder\' && node.expanded"></i><i class="font font-resource-subject-lib" ng-if="node.type == \'exam\'"></i><span class="content" data-id="[[node.id]]" data-name="[[node.title]]"><span class="name truncate-text" ng-class="{active: node.id == currentClassification.id, last: $last}" tipsy="node.title" ng-attr-tipsy-follow-element-width="true"  ng-attr-tipsy-ellipsis-check-method="width">[[node.title]]</span></div><div tree-view="true" ng-if="node.expanded" tree-id="'+o+'" multiple="'+d+'"used-for="'+g+'"tree-model="node.children" tree-level="'+s+'"></div></li></ul>',ie='<div class="lib-contents" ng-repeat="node in '+a+'" ng-click="'+o+'.clickNode($event, node)"><div class="lib-tr"><div class="lib-td lib-title tree-level-'+l+'"><div class="item tree-level-'+l+'" style="padding-left: '+13*l+'px"><div class="lib-border" ng-class="{\'indent\': node.children.length == 0}"><i class="font font-down collapsed" ng-if="node.children.length && !node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="font font-down" ng-if="node.children.length && node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="font font-file-folder" ng-if="node.type == \'folder\' && !node.expanded"></i><i class="font font-file-folder-expanded" ng-if="node.type == \'folder\' && node.expanded"></i><i class="font font-resource-subject-lib" ng-if="node.type != \'folder\'"></i><span class="content" data-id="[[node.id]]" data-name="[[node.title]]"><span class="name truncate-text" ng-class="{active: node.id == currentClassification.id, last: $last}" tipsy="node.title" ng-attr-tipsy-follow-element-width="true"  ng-attr-tipsy-ellipsis-check-method="width">[[node.title]]</span><span class="name num truncate-text" ng-if="node.type != \'folder\'"> (<span ng-bind="node.nums"></span><span ng-bind="i18nMessages[\'questions\']"></span>)</span></div></div></div><div class="lib-td lib-num"><span class="lib-vlaue" ng-bind="node.nums" ng-if="node.type != \'folder\'"></span></div><div class="lib-td lib-score"><div class="lib-input" ng-if="!selectRandomlyExam && node.type != \'folder\'">\x3c!--[if lte IE 9]><input type="text" ng-model="node.point" ng-change="calculate()" ng-class="{\'has-error\': node.hasPointFormatError || node.hasPointValueError}" float-precision="1"/><![endif]--\x3e\x3c!--[if gte IE 10]>\x3c!--\x3e<input type="number" ng-model="node.point" ng-change="calculate()"ng-class="{\'has-error\': node.hasPointFormatError}"float-precision="1"/><![endif]--\x3e<span class="has-error" ng-if="node.hasPointFormatError" ng-bind="i18nMessages[\'numFormat\']"></span></div></div><div class="lib-td lib-choose"><div class="lib-input" ng-if="node.type != \'folder\'">\x3c!--[if lte IE 9]><input type="text" ng-model="node.number" ng-change="calculate()" parse-integer ng-class="{\'has-error\': node.hasNumberFormatError || node.hasNumberValueError}" /><![endif]--\x3e\x3c!--[if gte IE 10]>\x3c!--\x3e<input type="number" ng-model="node.number" ng-change="calculate()"ng-class="{\'has-error\': node.hasNumberFormatError || node.hasNumberValueError}"/><![endif]--\x3e<span class="has-error" ng-if="node.hasNumberFormatError" ng-bind="i18nMessages[\'integerFormat\']"></span><span class="has-error" ng-if="node.hasNumberValueError && node.number <= 0">> 0</span><span class="has-error" ng-if="node.hasNumberValueError && node.number > node.nums" ng-bind="i18nMessages[\'subjectNum\']"></span></div></div></div><div class="lib-contents" tree-view="true" ng-if="node.expanded" tree-id="'+o+'" multiple="'+d+'"used-for="'+g+'"tree-model="node.children" tree-level="'+s+'"></div></div>',oe=G+'<ul class="tree-level">'+Y+'<li ng-if="'+a+".length == 0 && !"+c+'"><div class="item"><span class="content">'+v+'</span></div></li><li ng-repeat="node in '+a+'" ng-click="'+o+'.clickNode($event, node)"><div class="item tree-level-'+l+'" style="padding-left: '+10*l+'px"><i class="font font-tree-expanded" ng-if="node.children.length && !node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="font font-tree-collapsed" ng-if="node.children.length && node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="blank" ng-hide="node.children.length"></i><span class="content" data-id="[[node.id]]" data-name="[[node.name]]"'+J+'><input class="input" ng-if="'+d+' == true" type="checkbox" ng-checked="node.selected" /><span class="name truncate-text" tipsy="node.name" ng-attr-tipsy-follow-element-width="true"  ng-attr-tipsy-ellipsis-check-method="width">[[node.name]]</span></div><div tree-view="true" ng-if="node.expanded" tree-id="'+o+'" multiple="'+d+'"used-for="'+g+'"tree-model="node.children" tree-level="'+s+'"'+X+'"></div></li></ul>';"bulletin_targets"===g?r.html("").append(e(ee)(n)):"study_course_classifications"===g?r.html("").append(e(te)(n)):"classifications"===g?r.html("").append(e(ne)(n)):"subject_libs"===g?r.html("").append(e(re)(n)):"subject_libs_table"===g?r.html("").append(e(ie)(n)):"org"===g?r.html("").append(e(oe)(n)):r.html("").append(e(Z)(n)),1===l&&"true"===d&&t((()=>D())),n.$on("refreshTreeViewModel",(function(e){return f=n.$eval(i.ngModel),n[o].defaultNode&&(n[o].defaultNode.selected=!!Array.isArray(f)&&f.includes(p)),t((()=>D()))})),n.triggerSearchTreeView=()=>{n.$emit("searchTreeView",o,n);var e=n.searchTreeView;"function"==typeof e&&e(o)};return n.$watch(i.treeModel,(function(){q(),function(){var e=n.$eval(i.treeModel);if(e)if(0===("bulletin_targets"===g?_.filter(e,(e=>(null!=e.children?e.children.length:void 0)>0)):"study_course_classifications"===g?_.filter(e,(e=>(null!=e.classification?e.classification.length:void 0)>0)):["classifications"].includes(g)?1:["subject_libs","subject_libs_table","org"].includes(g)?_.filter(e,(e=>(null!=e.children?e.children.length:void 0)>0)):_.filter(e,(e=>(null!=e.departments?e.departments.length:void 0)>0))).length&&l<2){if(r.find(".blank").hide(),"true"===S)r.find(".switch-all-nodes").css("padding-left","10px")}else if(r.find(".blank").show(),"true"===S)r.find(".switch-all-nodes").css("padding-left","32px")}()})),n.$watch(o+".keyword",(function(e){var t=$("#defaultTreeNode"+n.$id);return(null!=e?e.length:void 0)>0?t.hide():t.show()})),r.parent().on("click",(function(e){var t=helper.guard(r.parent().offset(),(e=>e.top))||0;return window.innerHeight-t-r.parent().outerHeight()<r.outerHeight()&&r.outerHeight()<t&&"false"===I?r.css({top:-r.outerHeight()}):r.css({top:""}),e.stopPropagation()})),r.parent(".tree-view").on("click",(()=>{n.disabled||r.toggle()})),$("body")[0].addEventListener("click",(function(e){if(!(r.find(e.target).length>0||r.parent(".tree-view").find(e.target).length>0))return r.hasClass("tree-container")?V():void 0}),!0)}})],exports.scrollable=()=>({link:(e,t,n)=>t.on("opened",(function(){var e=t.find(".".concat(n.scrollable)),r=e.width();if(e.find(">div").width()<r&&!e.attr("width-fixed"))return e.width(r+17),e.attr("width-fixed",!0)}))}),exports.enterPress=["$parse",e=>({restrict:"A",link(t,n,r){var i=e(r.enterPress);return n.bind("keypress",(function(e){return 13!==e.keyCode||(e.preventDefault(),t.$apply((()=>i(t,{$event:e}))))}))}})],exports.escPress=()=>({restrict:"A",require:"ngModel",link:(e,t,n)=>t.bind("keydown",(function(t){return 27!==t.keyCode||(t.preventDefault(),e.$apply((function(){var t=n.ngModel+"="+(""===e.$eval(n.escPress)?'""':e.$eval(n.escPress));return e.$eval(t)})))}))}),exports.scrollableTimeline=["$timeout",e=>({link:(t,n)=>e((function(){return n.offset().top>$(window).scrollTop()+.9*$(window).height()&&n.find(".cd-timeline-img, .cd-timeline-content").addClass("is-hidden"),$(window).on("scroll",(function(){if(n.offset().top<=$(window).scrollTop()+.9*$(window).height()&&n.find(".cd-timeline-img").hasClass("is-hidden"))return n.find(".cd-timeline-img, .cd-timeline-content").removeClass("is-hidden").addClass("bounce-in")}))}))})],exports.videoPlayer=["$timeout","$parse","$sanitize","$window","$translate",function(e,t,n,r,i){var o=null,a=0,l=(e,t)=>Math.max(e,t),s=function(e,t,n){return e?$(t).parent("div").append('<div class="video-offline-warning">'+n+"</div>"):$(t).parent("div").find(".video-offline-warning").remove()};return{restrict:"A",scope:{activity:"=",upload:"=",logVideoPlayed:"&",playerInitiated:"&",resource:"="},link(d,c,u){var p,f;d.playerLoadErrorMessage={"en-GB":"The video cannot be played directly. Please wait for transcoding to complete.","en-US":"The video cannot be played directly. Please wait for transcoding to complete.","zh-CN":"当前视频无法支持直接播放，请等待转码完成","zh-MO":"當前影片無法提供直接播放，請等待轉檔完成","zh-TW":"當前影片無法提供直接播放，請等待轉檔完成"};var g=!1,m=null==u.allowFowardSeeking||t(u.allowFowardSeeking)(d.$parent),h=null==u.allowRightClick||t(u.allowRightClick)(d.$parent),v=u.forwardSeekingWarning,b=t(u.playerSettings)(),y=function(e,n){return{plugins:{videoJsResolutionSwitcher:{default:t(n.resolution)(e.$parent),dynamicLabel:!0}}}}(d,u);return b&&(p=parseInt(b.lastPlayed),f=parseInt(b.lastThreshold),p>0&&!b.disableAutoPlay&&(y.autoplay=!0)),y.controlBar={volumeMenuButton:{inline:!1,vertical:!0}},y.playbackRates=[.75,1,1.25,1.5,2],e((function(){var e=function(e,t){var n=e.controlBar.playbackRateMenuButton,r=n.children()[0];r.children().forEach((e=>{e.rate===t?$(e.el()).addClass("active"):$(e.el()).removeClass("active")})),$(r.el()).addClass("vjs-menu-hidden"),$(n.el()).hover((()=>{$(r.el()).removeClass("vjs-menu-hidden")}))};return o&&clearInterval(o),Promise.all([__webpack_require__.e(83366),__webpack_require__.e(58425)]).then(__webpack_require__.bind(__webpack_require__,103151)).then((function(t){var w,k=t.default(c[0],y,(function(){}));k.on("error",(function(e){$(e.target).find(".vjs-modal-dialog-content").text(d.playerLoadErrorMessage[d.$root.lang])})),e(k,1),k.on("ratechange",(t=>{e(t.target.player,t.target.player.playbackRate())})),"False"==u.enablePlayRate&&(w=k.controlBar.playbackRateMenuButton,$(w.el()).remove()),k.on("resolutionchange",(e=>{var t=e.target.player.controlBar.playbackRateMenuButton.children()[0].children().find((e=>e.el().classList.contains("active"))),n=t?t.rate:1;e.target.player.playbackRate(n)})),k.ready((function(){return function(e,t){var r=e.data("desc"),o=e.parents(".video-player"),a=o.find(".vjs-control-bar .vjs-remaining-time");if(a.after(o.find(".vjs-control-bar .vjs-fullscreen-control")),t&&t.download&&e.data("allow-download")&&a.after("<div class='download'>\n    <a  href='".concat(t.download_link,"' ng-if='allow_download && !activity.uploads[0].deleted'>\n        <i class='font-audio-download font'></i>\n    </a>\n</div>")),a.after(o.find(".vjs-control-bar .vjs-volume-menu-button")),t&&t.desc&&r){a.after("<div class='desc'>\n    <i class='font-audio-desc'></i>\n</div>");var l=a.next(".desc");l.attr("title",n(r)).tipsy({gravity:"sw",trigger:"hover",className:"video-desc-white-bg",html:!0,opacity:1,afterShow:e=>e.appendTo(l).css({top:"auto",bottom:"45px",left:"-248px"})})}a.after(o.find(".vjs-control-bar .vjs-resolution-button")),a.after(o.find(".vjs-control-bar .vjs-playback-rate")),a.after(o.find(".vjs-control-bar .vjs-duration")),o.find(".vjs-control-bar .vjs-resolution-button .vjs-menu .vjs-menu-content").after("<div class='resolution-arrow'></div>"),o.find(".vjs-control-bar .vjs-volume-menu-button .vjs-menu .vjs-menu-content").after("<div class='volume-arrow'></div>"),o.find(".vjs-control-bar .vjs-playback-rate .vjs-menu .vjs-menu-content").after("<div class='playback-rate-arrow'></div>"),o.find(".vjs-control-bar .vjs-playback-rate .vjs-playback-rate-value").after("<div class='playback-rate-value'>".concat(i.instant("videoSpeed"),"</div>"))}(c,b),c.parents(".video-player").find(".vjs-control-bar .vjs-play-control.vjs-control.vjs-button").addClass("vjs-paused"),c.parents(".video-player").find(".vjs-control-bar .vjs-resolution-button .vjs-resolution-button-label").on("click",(()=>!1))})),c.on("touchstart",(function(){return k.paused()?k.play():k.pause()})),b&&c.on("durationchange",(function(){if(!g&&p>0&&parseInt(p)<parseInt(k.duration())){a=p,k.currentTime(p);var e=b.playedMsg.replace("{0}",utils.secondsToHms(p));return $(c).parent("div").append('<div class="prompt-message last-played">'+e+"</div>"),$(".prompt-message.last-played").delay(2500).hide(200),g=!0}}));var _=$(c[0]).parent("div").find(".vjs-poster");if(function(e,t){t.unbind("dblclick"),t.dblclick((function(){return e.isFullscreen()?e.exitFullscreen():e.requestFullscreen()}))}(k,_),m||function(e,t,n){if(t){var r=$(".vjs-mouse-display");r.append('<div class="warning-text">'+t+"<em></em></div>");var i=$(".warning-text");e.controlBar.progressControl.seekBar.mouseTimeDisplay.update=function(e,t){n=l(n,a),r.css("left",t+"px");var o=i.width()/2+12;return i.css("right",-1*o),i.find("em").css("right",o-5.5),e>n?r.addClass("has-warning"):(r.removeClass("has-warning"),r.attr("data-current-time",utils.secondsToHms(e)))}}e.on("seeking",(function(){if((n=l(n,a))<e.currentTime()&&e.currentTime(a),!e.paused()&&n>e.currentTime())return e.pause()})),e.on("seeked",(function(){if(e.isResolutionSwitch&&(e.isResolutionSwitch=!e.isResolutionSwitch,a=e.currentTime()),(n=l(n,a))<e.currentTime())return e.currentTime(a)})),o=setInterval((function(){!0!==e.isResolutionLoading&&(a=e.currentTime())}),500)}(k,v,f),h||(e=>{e.on("contextmenu",(e=>e.preventDefault()))})(k),!b.disableTrack&&b.offlineWarning&&function(e,t){s(!r.navigator.onLine,e,t),r.addEventListener("online",(()=>s(!1,e))),r.addEventListener("offline",(()=>s(!0,e,t)))}(c,b.offlineWarning),b.disableTrack&&!d.resource||utils.enableTrack(d,k,d.activity,"video",d.resource),d.playerInitiated)return k.theCurrentTime=k.currentTime,d.playerInitiated({player:k})}))}))}}}],exports.vueVideoMultiPlayer=["$timeout",function(){return{restrict:"A",scope:{activity:"=",upload:"=",logVideoPlayed:"&",playerInitiated:"&",resource:"=",videoUrls:"=",videoSrcType:"=",resolutions:"=",defaultResolution:"=",seekable:"=",lastPlayed:"=",download:"=",downloadLink:"=",disableTrack:"=",lastThreshold:"=",eventTimestamps:"=",onCustomEvent:"&",inCastServer:"@",canEditCaption:"=",captionAiGenerate:"="},link:function(e,t,n){var r;Vue.use(vueMultiPlayer),e.playerLoadErrorMessage={"en-GB":"The video cannot be played directly. Please wait for transcoding to complete.","en-US":"The video cannot be played directly. Please wait for transcoding to complete.","zh-CN":"当前视频无法支持直接播放，请等待转码完成","zh-MO":"當前影片無法提供直接播放，請等待轉檔完成","zh-TW":"當前影片無法提供直接播放，請等待轉檔完成"};var i=e.defaultResolution,o=_.isEmpty(null===(r=e.activity)||void 0===r?void 0:r.uploads)?e.upload:e.activity.uploads[0],a=e.download?e.download:o.allow_download,l=e.downloadLink?e.downloadLink:"/api/uploads/".concat(o.id,"/blob");e.activity&&(e.activity.videoDuration=o.videos[0].duration),e.resource&&(e.resource.videoDuration=o.videos[0].duration);var s=[{sources:_.map(e.videoUrls,(function(t,n){return{src:t,label:e.resolutions[n],type:e.videoSrcType,selected:n===i}})),mute:!1,volume:.7}],d={download:{toggle:a,onClick:()=>window.location.href=l}},c=n.forwardSeekingWarning;e.vue=new Vue({el:"#".concat(t.attr("id")),delimiters:["{[","]}"],render:function(t){var r;return t("multi-player",{props:{mode:"replay",videos:s,autoPlay:!1,seekable:e.seekable,lastPlayed:e.lastPlayed>=(null===(r=e.activity)||void 0===r?void 0:r.videoDuration)?0:e.lastPlayed,plugins:d,customEventTimestamps:e.eventTimestamps,lastThreshold:e.lastThreshold,seekWarning:c,enablePlayRate:"False"!=n.enablePlayRate},on:{error:t=>{$(t.target).find(".vjs-text-track-display").css({"margin-top":"30px","font-size":"16px","text-align":"center"}).text(e.playerLoadErrorMessage[e.$root.lang])},playerReady:t=>{var n;e.disableTrack&&!e.resource||utils.enableTrack(e,t,e.activity,"video",e.resource),e.playerInitiated&&(t.theCurrentTime=e=>e?(t.currentTime=e,e):t.currentTime,e.playerInitiated({player:t}));var r="".concat(o.id,"-").concat(o.key),i=$("#userId").data("id"),a=$("#orgCode").val()||"",l=Boolean(e.canEditCaption&&o.created_by_id==i),s=utils.fileName(null!==(n=o.name)&&void 0!==n?n:""),d=n=>{t.configPlugin("caption",{toggle:Boolean(e.inCastServer),mediaId:r,server:e.inCastServer||"",source:e.videoUrls[0],organization:n.orgCode,callback:"",downloadUrl:"".concat(e.inCastServer,"/api/media-captions/").concat(r,"/download?org_code=").concat(a,"&filename=").concat(s),permissions:{create:l&&Boolean(e.captionAiGenerate),upload:l}})};o.orgCode&&o.key?d(o):uploadApi.previewUploadsInfo(o.id,(e=>{d(e.data)}))}}})},i18n:I18n}),e.$on("$destroy",(function(){e.vue.$destroy(),console.log("angular directive destroy ..")}))}}}],exports.sortable=()=>({link(e,t,n){var r=".".concat(n.sortable),i=n.index;return new Sortable(t[0],{draggable:r,group:"shared",animation:150,handle:".drag-area",scroll:!0,forceAutoScrollFallback:!0,onUpdate(t){if("course-syllabus"===n.sortable){var r=JSON.parse(window.localStorage.getItem("course-list-sort")||"{}");return r.oldModule=angular.element(t.to).scope().module.id,e.resortSyllabus(t.oldIndex,t.newIndex,r)}return e.resort(t.oldIndex,t.newIndex,n.type,t,i)},onAdd:function(t){if(!t.item.id.startsWith("module-")){var r,o=JSON.parse(window.localStorage.getItem("course-list-sort")||"{}");if(t.item.id.startsWith("syllabus-"))return o.newModule=angular.element(t.to).scope().module.id,e.resortSyllabus(t.oldIndex,t.newIndex,o);null!==(r=t.item).parentElement&&r.parentElement.removeChild(r),e.resortForModuleOrSyllabus(t.oldIndex,t.newIndex,o,n.type,t,i)}},onRemove:function(t){if("module"!==n.sortable&&"course-syllabus"!==n.sortable)return e.resortWhenRemove(t.oldIndex)},onEnd:function(t){"module"===n.sortable&&e.expandAll(),"course-syllabus"===n.sortable&&e.expandActivities(),"learning-activity"===n.sortable&&e.afterSort()},onStart(t){var r,i;if("module"===n.sortable)return e.collapseAll(),window.scrollTo(0,0);"course-syllabus"===n.sortable&&(e.expandModulesAndContents(),i=angular.element(t.item).scope().syllabus.id,e.collapseActivities(),window.scrollTo(0,0));var o=e.syllabus?e.syllabus.activities:e.module.directActivities;window.localStorage.setItem("course-list-sort",JSON.stringify({oldModule:null===(r=e.module)||void 0===r?void 0:r.id,oldSyllabus:e.syllabus?e.syllabus.id:i,fromActivities:o}))}})}}),exports.dragCloneable=()=>({restrict:"A",scope:{dragOptions:"=",dragType:"@",dragCallback:"&"},link(e,t,n){var r=e.dragOptions.id,i="".concat(n.dragCloneable,"-")+r,o={draggable:".clone-area",handle:".drag-area",sourceId:"cloneable-source",hoverClass:"drag-hover",trashId:"drag-trash-"+r,boxHeight:41};e.dragOptions.dragConfig=o;var a="from"!==e.dragType||"clone";return"trash"===e.dragType&&(a=!1),new Sortable(t[0],{group:{name:i,put:"from"!==e.dragType&&[i],pull:a},animation:300,draggable:o.draggable,handle:o.handle,sort:!1,scroll:!1,onAdd:function(t){if(e.dragOptions.dragging){var n=e.dragOptions.dragging,r=e.dragOptions.dragConfig;if(n.toTrash)t.item.parentNode.removeChild(t.item),e.dragOptions.elements=t.from.parentNode.parentNode;else{if(t.to.children.length>1)if(t.to.children[0].id==t.to.children[1].id)t.to.removeChild(t.item);else{var i=t.to.children[0].id===t.item.id?1:0;r.sourceId===t.from.id?t.to.removeChild(t.to.children[i]):t.from.appendChild(t.to.children[i])}e.dragOptions.elements=t.to.parentNode.parentNode,e.dragOptions.dragging.lastEle=null,t.to.classList.remove(r.hoverClass)}}else t.preventDefault()},onMove:function(t){if(e.dragOptions.dragging){var n=e.dragOptions.dragging,r=e.dragOptions.dragConfig;n.toPool=t.to&&r.sourceId===t.to.id,n.toTrash=t.to&&r.trashId===t.to.parentNode.id,n.lastEle&&n.lastEle.classList.remove(r.hoverClass),n.toPool||(n.lastEle=t.to,n.lastEle.classList.add(r.hoverClass)),0===t.to.children.length||n.toPool?n.toHeight=r.boxHeight:n.toHeight=t.to.offsetHeight,n.fromPool||(n.fromHeight=t.from.offsetHeight),e.dragOptions.dragging=n}else t.preventDefault()},onStart:function(t){var n=e.dragOptions.dragConfig,r={fillCount:0,fromHeight:t.item.offsetHeight,toHeight:n.boxHeight,toPool:!1,toTrash:!1,fromPool:n.sourceId===t.from.id};r.fromPool||(t.from.classList.add(n.hoverClass),document.getElementById(n.trashId).style.display="unset"),e.dragOptions.dragging=r},onEnd:function(t){if(e.dragOptions.dragging){var n=e.dragOptions.dragConfig,r=e.dragOptions.dragging;r.fromPool||(r.toTrash?t.from.style.height=n.boxHeight+"px":t.from.style.height=r.toHeight+"px",t.from.classList.remove(n.hoverClass),document.getElementById(n.trashId).style.display="none"),t.item&&t.item.parentNode&&(n.sourceId!==t.item.parentNode.id&&(t.item.parentNode.style.height=r.fromHeight+"px"),t.item.parentNode.classList.remove(n.hoverClass)),e.dragOptions.dragging=null,e.dragCallback()}else t.preventDefault()}})}});var hideTipsyWhenElemInvisible=(e,t)=>t.closest("a[href],[ng-click]").on("click",(()=>$(".tipsy:visible").hide()));exports.tipsy=["$timeout",e=>({restrict:"A",link(t,n,r){var i=function(){var e,i=t.$eval(r.tipsy),o="string"==typeof(e="no"!==r.tipsyEscape?_.escape(i):i)?e.replace(/\n/g,"<br />"):e;return n.attr("title",o),n.tipsy({ellipsis:"no"!==r.tipsyEllipsis,gravity:$.fn.tipsy.autoBounds(37,r.tipsyGravity||"sw"),opacity:.95,followElementWidth:"true"===r.tipsyFollowElementWidth,ellipsisCheckMethod:r.tipsyEllipsisCheckMethod,html:!0})};return i(),t.$watch(r.tipsy,i),hideTipsyWhenElemInvisible(e,n)}})],exports.tipsyLiteral=["$timeout",e=>({restrict:"A",link:(t,n,r)=>(t.$watch((()=>r.tipsyLiteral),(function(){var e="yes"===r.tipsyHtml,t=e?r.tipsyLiteral:_.escape(r.tipsyLiteral);return n.attr("title",t),n.tipsy({ellipsis:"yes"===r.tipsyEllipsis,gravity:$.fn.tipsy.autoBounds(37,r.tipsyGravity||"sw"),opacity:.95,className:r.tipsyClass||"",followElementWidth:"true"===r.tipsyFollowElementWidth,ellipsisCheckMethod:r.tipsyEllipsisCheckMethod,html:e,fade:!0})})),hideTipsyWhenElemInvisible(e,n))})],exports.tipsyAuto=["$timeout",e=>({restrict:"A",link:(t,n,r)=>(t.$watch((()=>n.text()),(function(){var e=n.text().replace(/\s+/g," ").trim();return n.attr("title",e),n.tipsy({ellipsis:"yes"===r.tipsyEllipsis,gravity:$.fn.tipsy.autoBounds(37,r.tipsyGravity||"sw"),opacity:.95,html:!0})})),hideTipsyWhenElemInvisible(e,n))})],exports.cornerButtonGroup=["$rootScope",e=>({controller(){e.showCornerButton=!0}})],exports.fixableNav=["$timeout","$rootScope",(e,t)=>({link(n,r,i){var o=parseFloat(i.offsetTop||0),a=0,l=window;if(null!=i.scrollEleCssSelector){var s=$(i.scrollEleCssSelector).first();"auto"===s.css("overflow")&&(l=s,a=s.offset().top,r.css("top",a+"px"))}var d=r.offset().top-o-a;return e((()=>d=r.offset().top-o-a)),$(l).scroll((function(){if($(this).scrollTop()>d&&!r.hasClass("fixed")&&(r.addClass("fixed"),e((()=>t.showBackToTopButton=!0))),$(this).scrollTop()<=d&&r.hasClass("fixed"))return r.removeClass("fixed"),e((()=>t.showBackToTopButton=!1))}))}})],exports.fixableButtons=["$location","$window",(e,t)=>({link:(n,r,i)=>(e.path().indexOf("classroom")>0?r.css("backgroundColor","white"):r.css("backgroundColor","#F4F4F4"),$(window).scroll((function(){if($(".subjects-edit-board").length){var e=$(this).scrollTop()+t.innerHeight<=$(".subjects-edit-board").height()+$(".subjects-edit-board").offset().top;if(e&&r.attr("class").indexOf("fixed-buttons")<0&&r.addClass("fixed-buttons"),!e&&r.attr("class").indexOf("fixed-buttons")>=0)return r.removeClass("fixed-buttons")}})))})],exports.fixableListHeader=()=>({link:(e,t,n)=>$(window).scroll((function(){var e=$(this).scrollTop()>n.startFixedPosition;if(e&&t.attr("class").indexOf("fixed-list-header")<0&&t.addClass("fixed-list-header"),!e&&t.attr("class").indexOf("fixed-list-header")>=0)return t.removeClass("fixed-list-header")}))}),exports.scrollToTop=["$document",e=>({link:(t,n)=>n.on("click",(()=>e.scrollTopAnimated(0,500)))})],exports.indeterminateCheckbox=()=>({link:(e,t)=>e.$watch("indeterminate",(()=>t.prop("indeterminate",e.indeterminate)))}),exports.uiSelect2=["$timeout",e=>({priority:0,restrict:"A",require:"?ngModel",link:(t,n,r,i)=>(n.on("click",(e=>$(".tipsy:visible").hide())),"true"===r.uiSelect2HideTipsyWhenOpening&&n.on("select2-opening",(()=>$(".tipsy:visible").hide())),"true"===r.uiSelect2ApplyWhenLoaded&&n.on("select2-loaded",(()=>t.$apply())),i&&n.on("change",(()=>i.$setValidity("server",!0))),e((()=>$(n).css("visibility","visible"))))})],exports.fixIeMinWidth=["$timeout",e=>({restrict:"A",link(e,t,n){if(-1!==navigator.userAgent.indexOf("MSIE 9")){var r=function(t){var n=$(t);return e.$watch((()=>n.children().length),(()=>i(t)))},i=function e(t){var n=$(t);if(n.children()){var i,o=_createForOfIteratorHelper(n.children());try{for(o.s();!(i=o.n()).done;){var a=i.value;r(a),e(a)}}catch(e){o.e(e)}finally{o.f()}}var l=parseInt(($(t).css("min-width")||"0").replace("px","")),s=n.parent().width(),d=n[0].getBoundingClientRect().width+1;if(l>0&&s>d&&null==n.parent().data("ie-width-fixed"))return n.parent().css({width:Math.ceil(d)}).data("ie-width-fixed",!0)};return r(t)}}})],exports.uiSelect2KeyPress=["$timeout",e=>({restrict:"A",link:(t,n,r)=>e((function(){var e=n.next("div.select2-container");return e.bind("keypress",(function(t){return 9===t.keyCode||(t.stopPropagation(),t.preventDefault(),e.next("select.rubric-score-box").select2("open")),!0}))}),100)})],exports.addSlideSelect2=["$window",e=>({restrict:"A",link:(t,n,r)=>n.on("select2-selecting",(function(t){if("-1"===t.val)return t.preventDefault(),n.select2("close"),$("#slide-refresh-popup").foundation("reveal","open"),e.open("".concat(e.location.protocol,"//").concat(e.location.host,"/user/resources/slides#/?comeFrom=activity"),"_blank")}))})],exports.simEditor=["simditor","$timeout","$sanitize","$compile",(e,t,n,r)=>({require:"?ngModel",restrict:"A",scope:{submitCallback:"&",rollbackCallback:"&"},link(i,o,a,l){if(l){i.patronCtrl={patronValue:null},i.enableAutoSubmit=helper.guard(i.$eval(a.simEditor),(e=>e.enableAutoSubmit));var s,d,c,u,p=function(){return l.$setViewValue(i.patronCtrl.patronValue),l.$render()},f=function(){return i.submitCallback().then((()=>i.patronCtrl.patronValue=l.$modelValue),(()=>p()))},g=function(){var e=l.$modelValue,t=i.patronCtrl.patronValue;return String(e)===String(t)},m={allowedAttributes:{img:["src","alt","width","height","data-non-image","data-latex","class","data-mathml","role","align","style","data-id"],span:["contenteditable","class","data-id"],a:["href","target","data-id","class"],svg:["class","width","height"],use:["href"]}};if(a.simToolbar)m.toolbar=a.simToolbar.split(",");else if(a.simToolbarExtendDefault){m.toolbar=["title","bold","italic","underline","strikethrough","fontScale","color","ol","ul","blockquote","code","table","link","lmsimage","hr","indent","outdent","superscript","subscript"].concat(a.simToolbarExtendDefault.split(","))}if(m.toolbar)i.$root.isFormulaEditorEnable&&"True"===i.$root.isFormulaEditorEnable||(m.toolbar=_.filter(m.toolbar,(e=>"lmsformula"!==e))),i.$root.isSimditorMediaEnable&&"true"===i.$root.isSimditorMediaEnable||(m.toolbar=_.filter(m.toolbar,(e=>"lmsaudio"!==e))),null!==(s=window.featureToggles)&&void 0!==s&&s.vocabulary||(m.toolbar=m.toolbar.filter((e=>"entry"!==e))),null!==(d=window.featureToggles)&&void 0!==d&&d.editorActivityRefer||(m.toolbar=m.toolbar.filter((e=>"activity"!==e))),null!==(c=window.featureToggles)&&void 0!==c&&c.simditor_embed_video||(m.toolbar=m.toolbar.filter((e=>"lmsembed"!==e))),null!==(u=window.featureToggles)&&void 0!==u&&u.simditor_attachment||(m.toolbar=m.toolbar.filter((e=>"lmsattachment"!==e)));var h=["a","abbr","acronym","address","area","article","aside","audio","b","big","blockquote","br","button","canvas","caption","center","cite","code","col","colgroup","command","datagrid","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","event-source","fieldset","figcaption","figure","footer","font","form","header","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","keygen","kbd","label","legend","li","m","map","menu","meter","multicol","nav","nextid","ol","output","optgroup","option","p","pre","progress","q","s","samp","section","select","small","sound","source","spacer","span","strike","strong","sub","sup","table","tbody","td","textarea","time","tfoot","th","thead","tr","tt","u","ul","var","video","style","svg","use"],v=["azimuth","background","background-color","border-bottom-color","border-collapse","border-color","border-left-color","border-right-color","border-top-color","clear","color","cursor","direction","display","elevation","float","font","font-family","font-size","font-style","font-variant","font-weight","height","line-height","overflow","pause","pause-after","pause-before","pitch","pitch-range","richness","speak","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","text-align","text-decoration","unicode-bidi","vertical-align","voice-family","volume","white-space","width"];m.allowedTags=h,m.allowedStyles={};for(var b=0,y=h;b<y.length;b++){var w=y[b];void 0===m.allowedAttributes[w]?m.allowedAttributes[w]=["class","style"]:m.allowedAttributes[w].concat(["class","style"]),m.allowedStyles[w]=v}m.$compile=r,a.courseId&&(m.courseId=a.courseId);return m.upload={pasteImageUpload:function(e,t){var n={name:e.name,size:e.size,parent_id:0,is_scorm:!1,is_wmpkg:!1};uploadApi.preUpload(n).then((n=>{var r=n.body;uploadApi.uploadResource(r,e.obj,(function(n){n.lengthComputable&&t.trigger("uploadprogress",[e,n.loaded,n.total])}),(function(n){uploadService.isUploadCallback(r)&&uploadApi.uploadCallback(r.id).then((()=>{}));var o={success:!0,filePath:"".concat(i.simditor.url_prefix,"api/uploads/").concat(r.id,"/in-rich-content")+"?created_at=".concat(r.created_at),uploadId:r.id};t.trigger("uploadprogress",[e,e.size,e.size]),t.trigger("uploadsuccess",[e,o]),t.trigger("uploadcomplete")}),(function(n,r){t.trigger("uploaderror",[e,n,r]),t.trigger("uploadcomplete")}))}))}},e.create(o,m).then((function(e){i.simditor=e;var r=e=>e.stopPropagation();return i.simditor.body.on("focus",(function(){return i.enableAutoSubmit&&(i.patronCtrl.patronValue=l.$modelValue),i.simditor.body.on("wheel",r)})),i.simditor.body.on("blur",(function(){if(i.simditor.body.off("wheel",r),i.enableAutoSubmit)return g()?(p(),i.rollbackCallback()):f()})),l.$render=()=>i.simditor.setValue(n(l.$viewValue||"")),i.simditor.on("insertUpload",(function(e,t){i.$emit("simditorInsertUpload",t.uploads)})),void 0!==a.cleanFontSizePaste&&(i.simditor.opts.cleanFontSizePaste=!0),void 0!==a.disabledPaste&&i.simditor.on("pasting",((e,t)=>!1)),i.simditor.on("removeUpload",(function(e,t){i.$emit("simditorRemoveUpload",t.uploads)})),i.simditor.on("valuechanged",(function(){var e=i.simditor.getValue();return/^\s*<[^<>]+>\s*$/.test(e)&&(e=""),document.querySelectorAll("div.simditor-body pre").forEach((e=>{e.className=e.dataset.lang,e.contentEditable=!1,hljs.highlightElement(e)})),t((()=>l.$setViewValue(e)))}))}))}}})],exports.modelPatron=()=>({require:["modelPatron","ngModel"],restrict:"A",scope:{ngModel:"=",submitCallback:"&",rollbackCallback:"&"},controller:()=>({}),link(e,t,n,r){var i,o={required:!0,enterToSubmit:!0,bindConvertValue:!0};angular.extend(o,e.$eval(n.modelPatron));var a=_slicedToArray(Array.from(r),2),l=a[0],s=a[1];t.bind("focus",(function(){var e=s.$modelValue;return l.patronValue=d(e).toString()})),t.bind("keydown",(function(e){if(27===e.keyCode)return e.preventDefault(),u()})),t.bind("blur",(()=>c())),t.bind("keypress",(function(e){if(13===e.keyCode&&o.enterToSubmit)return e.preventDefault(),t.blur()}));var d=function(e){return!o.bindConvertValue||isNaN(e)||""===e||null===e?e:parseFloat(e)},c=function(){return i()?(u(),e.rollbackCallback()):p()},u=function(){return s.$setViewValue(l.patronValue||""),s.$render()},p=function(){return e.submitCallback().then((()=>l.patronValue=s.$modelValue),(()=>u()))};return i=function(){var e=d(s.$modelValue).toString(),t=l.patronValue;return o.required?s.$isEmpty(e)||String(e)===String(t):e===t}}}),exports.modelTimeScorePatron=()=>({require:["modelTimeScorePatron","ngModel"],restrict:"A",scope:{ngModel:"=",submitCallback:"&",editingStatusCallback:"&",showFloatingMessage:"&",removeFloatingMessage:"&"},controller:()=>({}),link(e,t,n,r){var i,o={required:!0,type:"number"};angular.extend(o,e.$eval(n.modelTimeScorePatron));var a=_slicedToArray(Array.from(r),2),l=a[0],s=a[1];t.bind("focus",(function(){var e=s.$modelValue;if(isNaN(e)||""===e||null===e?l.patronValue=e:l.patronValue=parseFloat(e),!l.status)return l.correctPatronValue=l.patronValue})),t.bind("keydown",(function(e){if(27===e.keyCode)return e.preventDefault(),p()})),t.bind("keyup",(function(e){if("number"===o.type)return c()}));var d=function(t){return l.status=t,e.editingStatusCallback({status:t})},c=function(){var t=0,r=100,i=!0,o=!1;void 0!==n.minimum&&""!==n.minimum&&(t=n.minimum),void 0!==n.maximum&&""!==n.maximum&&(r=n.maximum),void 0!==n.validate&&""!==n.validate&&"false"===n.validate&&(i=!1),void 0!==n.nullable&&""!==n.nullable&&"true"===n.nullable&&(o=!0);var a=s.$modelValue;if(!(!1===i||0===a.length&&o)){if(""!==a&&void 0!==a){var c=parseFloat(a);c<t||c>r?d("process-error"):c>=t||c<=r?d("editing"):String(parseFloat(a))===String(l.correctPatronValue)?d(null):d("processing")}else l.correctPatronValue?d("process-error"):d(null);return e.removeFloatingMessage()}};t.bind("blur",(()=>u())),t.bind("keypress",(function(e){if(13===e.keyCode)return e.preventDefault(),t.blur()}));var u=function(){return i()?d(null):f()},p=function(){return s.$setViewValue(l.correctPatronValue),s.$render()},f=function(){d("processing"),e.showFloatingMessage({status:"processing",disappear:!1});return e.submitCallback({oldValue:l.correctPatronValue}).success((function(t){return e.showFloatingMessage({status:"process-success"}),l.patronValue=s.$modelValue,d(null)})).error((function(t,n){return 400===n?e.showFloatingMessage({status:"process-valid-error",msg:t.errors[o.field][0],disappear:!1}):e.showFloatingMessage({status:"process-failed",msg:"",disappear:!1}),d("process-error")}))};return i=function(){var e=s.$modelValue,t=l.patronValue;return"number"===o.type?s.$isEmpty(e)&&s.$isEmpty(l.correctPatronValue)||String(parseFloat(e))===String(l.correctPatronValue):String(e)===String(t)}}}),exports.modelScorePatron=()=>({require:["modelScorePatron","ngModel"],restrict:"A",scope:{ngModel:"=",submitCallback:"&",editingStatusCallback:"&",showFloatingMessage:"&",removeFloatingMessage:"&"},controller:()=>({}),link(e,t,n,r){var i,o={required:!0,type:"number"};angular.extend(o,e.$eval(n.modelScorePatron));var a=_slicedToArray(Array.from(r),2),l=a[0],s=a[1];t.bind("focus",(function(){var e=s.$modelValue;if(isNaN(e)||""===e||null===e?l.patronValue=e:l.patronValue=parseFloat(e),!l.status)return l.correctPatronValue=l.patronValue})),t.bind("keydown",(function(e){if(27===e.keyCode)return e.preventDefault(),p()})),t.bind("keyup",(function(e){if("number"===o.type)return c()}));var d=function(t){return l.status=t,e.editingStatusCallback({status:t})},c=function(){var t=s.$modelValue;if(""!==t&&void 0!==t){var n=parseFloat(t);n<0||n>100?d("process-error"):String(parseFloat(t))===String(l.correctPatronValue)?d(null):d("processing")}else l.correctPatronValue?d("process-error"):d(null);return e.removeFloatingMessage()};t.bind("blur",(()=>u())),t.bind("keypress",(function(e){if(13===e.keyCode)return e.preventDefault(),t.blur()}));var u=function(){if(!i())return f()},p=function(){return s.$setViewValue(l.correctPatronValue),s.$render()},f=function(){d("processing"),e.showFloatingMessage({status:"processing",disappear:!1});return e.submitCallback({oldValue:l.correctPatronValue}).success((function(t){return e.showFloatingMessage({status:"process-success"}),l.patronValue=s.$modelValue,d(null)})).error((function(t,n){return 400===n?e.showFloatingMessage({status:"process-valid-error",msg:t.errors[o.field][0],disappear:!1}):e.showFloatingMessage({status:"process-failed",msg:"",disappear:!1}),d("process-error")}))};return i=function(){var e=s.$modelValue,t=l.patronValue;return"number"===o.type?s.$isEmpty(e)&&s.$isEmpty(l.correctPatronValue)||String(parseFloat(e))===String(l.correctPatronValue):String(e)===String(t)}}}),exports.stopPropagation=()=>({restrict:"A",link:(e,t,n)=>t.bind("click",(e=>e.stopPropagation()))}),exports.contentLengthLimit=["$parse",e=>({restrict:"A",link(t,n,r,i){var o=e(r.contentLengthLimit),a=t.$eval(r.contentLengthMax);if(a)return n.bind("input keydown",(function(e){return n.val().length>=a&&function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.which||e.keyCode||e.charCode;if(t&&9===n)return!1;var r={8:"Backspace",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",46:"Delete"},i={metaKey:{88:"X",65:"A"},ctrlKey:{88:"X",65:"A"},shiftKey:{},altKey:{}};for(var o in i)if(e[o]&&i[o][n])return!1;return!r[n]}(e)?(e.preventDefault(),e.stopPropagation(),t.$apply((()=>o(t,{$exceeded:!0})))):t.$apply((()=>o(t,{$exceeded:!1}))),setTimeout((()=>t.$digest()))})),n.bind("keyup",(function(e){if(n.val().length>a)return n.val(n.val().substr(0,a)),t.$apply((()=>o(t,{$exceeded:!0}))),setTimeout((()=>t.$digest()))}))}})],exports.contentLengthLeft=["$parse",e=>({restrict:"A",scope:{bindModel:"="},link(e,t,n,r){var i=e.$parent.$eval(n.contentLengthMax);if(i)return t.bind("keyup",(()=>e.bindModel.leftCharacterCount=i-t.val().length)),e.bindModel.leftCharacterCount=i}})],exports.toggleDropdownList=["$timeout","$rootScope","$window",(e,t,n)=>({restrict:"A",link(n,r,i){r.hide();var o=!0;return e((function(){$("#".concat(i.toggleDropdownList)).on("touchstart click",(function(e){if(o){if(o=!1,!t.displayedDropdown)return r.show(),t.displayedDropdown=r,setTimeout((()=>o=!0),300),e.stopPropagation();$(r).is(t.displayedDropdown)?(r.hide(),t.displayedDropdown=null):(t.displayedDropdown.hide(),r.show(),t.displayedDropdown=r)}return setTimeout((()=>o=!0),300),e.stopPropagation()})),$("body").on("click",(function(){return o&&t.displayedDropdown?(t.displayedDropdown.hide(),t.displayedDropdown=null):setTimeout((()=>o=!0),300)}))}))}})],exports.expandHeight=["$timeout",e=>({restrict:"A",link(t,n,r){n.css("overflow-y","hidden");var i=function e(){var t=$("#"+r.container),i=t.is(":visible");i||t.show();var o=n.find("textarea");o.css("height","auto"),o.off("change keyup keydown paste",e).on("change keyup keydown paste",e);var a,l=0,s=_createForOfIteratorHelper(o);try{for(s.s();!(a=s.n()).done;){var d=a.value;$(d).css("height","auto"),d.scrollHeight>l&&(l=d.scrollHeight)}}catch(e){s.e(e)}finally{s.f()}o.css("height",l+10);var c,u=0,p=_createForOfIteratorHelper(n.find(">.column"));try{for(p.s();!(c=p.n()).done;){var f=c.value;$(f).css("height","auto"),f.scrollHeight>u&&(u=f.scrollHeight),$(f).css("height","")}}catch(e){p.e(e)}finally{p.f()}if(n.css("height",u),!i)return t.hide()};return t.$on("refreshHeight",(()=>e((()=>i())))),t.$watch(r.expandHeight,(()=>e((()=>i()))),!0)}})];var _formatDatetime=e=>t=>utils.formatDatetime(t,e);exports.formatDatetime=()=>({restrict:"A",require:"?ngModel",link:(e,t,n,r)=>r.$formatters.push(_formatDatetime(n.formatDatetime))}),exports.parseBoolean=()=>({restrict:"A",require:"?ngModel",link:(e,t,n,r)=>(r.$parsers.push(utils.parseBoolean),r.$formatters.push(utils.formatBoolean))}),exports.goBack=["$window",e=>({restrict:"A",link:(t,n)=>n.bind("click",(function(){e.history.length>2&&e.history.back();var t=$("#courseId").val();return t?e.location.href="/course/".concat(t,"/content"):e.history.back()}))})],exports.autoSelect=()=>({restrict:"A",link:(e,t,n)=>t.bind("click",(()=>t.select()))}),exports.onFileSelected=["$rootScope","$parse",(e,t)=>({restrict:"A",priority:-1,link:(n,r,i)=>(n.fileSelectorClicked=!1,r.bind("click",(function(){if(n.$emit("fileSelectOpen"),e.$apply(),!n.fileSelectorClicked){n.fileSelectorClicked=!0;var r=i.fileSelectScopeId?"filesSelected"+i.fileSelectScopeId:"filesSelected";return n.$on(r,((e,r)=>t(i.onFileSelected)(n)(angular.copy(r))))}})))})],exports.floatPrecision=()=>({restrict:"A",require:"?ngModel",link(e,t,n,r){var i=parseInt(n.floatPrecision,10);return r.$parsers.push((function(e){if(![0,0].includes(e)&&!e)return"";var t=(e+="").replace(/[^0-9 .]+/g,"");if(t!==e)return r.$setViewValue(t),r.$render(),t;var o=e.indexOf(".");if(-1!==o){t.match("^\\.")&&(t="0"+t,r.$setViewValue(t),r.$render());var a=e.indexOf(".",o+1);a>-1?(t=e.substring(0,a),r.$setViewValue(t),r.$render()):0===i&&-1!==o?(t=e.replace(".",""),r.$setViewValue(t),r.$render()):e.length-(o+1)>i&&(t=e.substr(0,o+i+1),r.$setViewValue(t),r.$render())}return void 0!==n.parseFloat&&(t=utils.formatFloat(t)),void 0!==n.min&&utils.formatFloat(n.min)>t&&(t=n.min,r.$setViewValue(t),r.$render()),void 0!==n.max&&utils.formatFloat(n.max)<t&&(t=n.max,r.$setViewValue(t),r.$render()),t}))}}),exports.alert=()=>({restrict:"A",link:(e,t,n)=>t.on("click",(()=>window.alert(n.alert)))}),exports.previewer=["$rootScope",e=>({restrict:"A",link:(t,n,r)=>n.click((function(){e.fromPage=r.fromPage;var n=t.$eval(r.previewer);if(n){var i,o,a;if("LARK"===(null==n||null===(i=n.currentFile)||void 0===i?void 0:i.source))return window.open(n.currentFile.url);if("page"===(null===(o=n.activity)||void 0===o?void 0:o.type))return e.$broadcast("previewPageContent",n.activity);if("lesson"===(null===(a=n.activity)||void 0===a?void 0:a.type))return e.$broadcast("previewLesson",n.activity);if("video-quiz"===(null==n?void 0:n.currentFile.type)){var l=((null==n?void 0:n.currentFile.uploads)||n.uploads||[])[0];if(l&&!l.deleted)return e.$broadcast("previewFile",l,t.upload)}if(!n.currentFile.deleted){var s=n.uploads,d=n.isAttachment||!1;return e.$broadcast("previewFiles",s,n.currentFile,n.activity,n.canAddNote,n.canGuestPreview,n.forceShowDownloadButton,d)}}else if("video-quiz"===t.upload.type){var c,u=(null!==(c=t.upload.uploads)&&void 0!==c?c:[])[0];if(u&&!u.deleted)return e.$broadcast("previewFile",u,t.upload)}else if(!t.upload.deleted)return e.$broadcast("previewFile",t.upload,t.activity)}))})],exports.resourceReferencePreviewer=["$rootScope",e=>({restrict:"A",link(t,n,r){var i=t.ccLicenseMapping[t.resource.cc_license_name];return i&&(t.resource.upload.cc_license_description=i.description,t.resource.upload.cc_license_code=i.code,t.resource.upload.cc_license_name=i.name,t.resource.upload.cc_license_link=i.link),n.click((()=>e.$broadcast("previewResourceReference",t.resource)))}})],exports.hypothesisStat=["$rootScope",e=>({restrict:"A",link:(t,n,r)=>n.click((function(){if(!t.upload.deleted)return e.$broadcast("openHypothesisStat",t.upload,t.activity)}))})],exports.integerLimit=()=>({restrict:"A",require:"?ngModel",link:(e,t,n,r)=>r.$parsers.push((function(e){if(null==e)return"";var t=typeof e,i=e.toString().replace(/[^0-9]/g,""),o=parseInt(n.max)?n.max:"1000000",a=parseInt(n.min)?n.min:"0";return parseInt(i)>parseInt(o)&&(i=o),parseInt(i)<parseInt(a)&&(i=a),(i="number"===t?parseInt(i):i)!==e&&(r.$setViewValue(i),r.$render()),i}))}),exports.uuidFormatter=()=>({restrict:"A",require:"?ngModel",link:(e,t,n,r)=>r.$formatters.push((function(e){return e&&0===e.indexOf("_uuid_")?"":e}))}),exports.refreshOn=["$parse",e=>({restrict:"A",link(t,n,r){if(r.ngInit)return t.$watch(r.refreshOn,(()=>e(r.ngInit)(t)))}})],exports.backgroundImage=()=>({restrict:"A",link:(e,t,n)=>n.$observe("backgroundImage",(function(e){if(e)return t.css({"background-image":"url("+n.backgroundImage+")"})}))}),exports.beforeController=()=>({restrict:"A",priority:550,scope:!0,controller:["$scope","$attrs",(e,t)=>e.$eval(t.beforeController)]}),exports.activityCheckpointLock=["$timeout",e=>({restrict:"E",replace:!0,template:'<div class="activity-lock"> <i class="font font-thin-lock"></i> </div>'})],exports.rootScopeVariable=["$rootScope",e=>({restrict:"E",link(t,n,r){if(!_.isEmpty(r.name))return e[r.name]=r.value}})],exports.fixNgModelName=()=>({restrict:"A",require:["ngModel","^?form"],link(e,t,n,r){var i=_slicedToArray(Array.from(r),2),o=i[0],a=i[1];if(a)return n.$observe("name",(function(e){if(e!==o.$name)return a.$removeControl(o),o.$name=e,a.$addControl(o)}))}});var treeViewTemplate='<script type="text/ng-template" id="treeSelector">\n    <div class="form-element-wrapper">\n        <div class="select2-container tree-selector">\n            <a href="javascript:void(0)" class="select2-choice" ng-click="showTreeContainer=!showTreeContainer">\n                <span class="select2-chosen">\n                    <div class="select2-line-content"></div>\n                </span>\n                <span class="select2-arrow"></span>\n            </a>\n            <div class="tree-container" ng-include="\'treeNode\'" ng-show="showTreeContainer">\n            </div>\n        </div>\n    </div>\n<\/script>',treeNodeTemplate='<script type="text/ng-template" id="treeNode">\n    <div ng-repeat="node in nodes" class="tree-node" ng-click="selectTreeNode(node)" stop-propagation>\n        <span style="visibility: [[node.children.length > 0?\'visible\':\'hidden\']]" stop-propagation>\n            <i class="font font-tree-expanded" ng-click="node.expanded = !node.expanded" ng-if="!node.expanded"></i>\n            <i class="font font-tree-collapsed" ng-click="node.expanded = !node.expanded" ng-if="node.expanded"></i>\n        </span>\n        <span id="[[ node.id ]]" ng-bind="node.name"></span>\n        <div class="children" ng-if="(nodes=node.children) && nodes && nodes.length > 0 && node.expanded" ng-include="\'treeNode\'"></div>\n    </div>\n<\/script>';$("body").append(treeNodeTemplate),$("body").append(treeViewTemplate),exports.treeSelector=()=>({restrict:"EA",require:"?treeModel",scope:{treeModel:"=",nodes:"="},link(e,t,n){var r=void 0,i=function(e){t.find(".select2-chosen .select2-line-content").text(e.name)},o=e.$parent.$eval(n.nodes),a=function e(t,n){var i,o=_createForOfIteratorHelper(n);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(r)return r;if(a.id===t)return r=a;a.children&&e(t,a.children)}}catch(e){o.e(e)}finally{o.f()}}(e.treeModel,o);return a&&i(a),e.selectTreeNode=function(t){return e.treeModel=t.id,e.showTreeContainer=!1,i(t)},$("body")[0].addEventListener("click",(function(n){if(!(t.find(n.target).length>0))return e.showTreeContainer=!1,e.$apply()}),!0)},templateUrl:"treeSelector"}),exports.autoScrollToLastPosition=["$document","$timeout","$location",(e,t,n)=>({restrict:"A",link:(r,i,o)=>(r.okSaveScroll=!0,r.scrollPos={},r.previousLocationPath="",e.bind("scroll",(function(){if(r.okSaveScroll)return r.scrollPos[n.path()]=$(window).scrollTop()})),r.scrollClear=e=>r.scrollPos[e]=0,r.$on("$locationChangeSuccess",(function(){window.scrollTo(0,0);var e=0;return r.scrollPos[n.path()]&&(e=r.scrollPos[n.path()]),n.path()!==r.previousLocationPath&&t((function(){return $("html, body").stop().animate({scrollTop:e},400,"swing"),r.okSaveScroll=!0}),0),r.previousLocationPath=n.path()})),r.$on("$locationChangeStart",(e=>r.okSaveScroll=!1)))})],exports.circleBar=function(){return{restrict:"E",replace:!0,require:"^ngModel",scope:{ngModel:"="},link:(e,t,n)=>e.$watch("ngModel",(()=>function(e,t){var n=null!=t.ngModel?t.ngModel:0;e.find(".mask :first-child").text(n+"%");var r=e.css("background-color");return n<=50?e.find(".circle-bar-right").css("transform","rotate("+3.6*n+"deg)"):(e.find(".circle-bar-right").css({transform:"rotate(0deg)","background-color":r}),e.find(".circle-bar-left").css("transform","rotate("+3.6*(n-50)+"deg)"))}(t,e)),!0),template:'<div id="circle-bar" class="circle-bar"> <div class="circle-bar-left"></div> <div class="circle-bar-right"></div> <div class="mask"> <span class="percent">{{ ngModel }}%</span> </div> </div>'}},exports.lazyload=()=>({restrict:"A",link:(e,t,n)=>t.lazyload()}),exports.draggable=function(){return{restrict:"A",link(e,t){if(!_.isEmpty(t))return function(e){var t;e=e[0];var n=0,r=0,i=0,o=0,a=function(t){return(t=t||window.event).preventDefault(),n=i-t.clientX,r=o-t.clientY,i=t.clientX,o=t.clientY,e.style.top=e.offsetTop-r+"px",e.style.left=e.offsetLeft-n+"px"};return e.onmousedown=function(e){return(e=e||window.event).preventDefault(),i=e.clientX,o=e.clientY,document.onmouseup=t,document.onmousemove=a},t=function(){return document.onmouseup=null,document.onmousemove=null}}(t)}}},exports.onRepeatFinished=["$timeout",e=>({restrict:"A",link(t,n,r){if(t.$last)return e((()=>t.$eval(r.onRepeatFinished)))}})],exports.uiBreadcrumbs=["$route","$translate",function(e,t){return{restrict:"E",template:'    <div id=\'breadcrumb\' class="row">\n      <span ng-repeat="crumb in breadcrumbs" class="crumb" ng-class="{ \'current-crumb\': $last }">\n          <a ng-href="#{{ crumb.originalPath }}" ng-if="!$last">{{ crumb.displayName }}</a>\n          <span ng-show="$last">{{ crumb.displayName }}</span>\n          <span class="crumb-delimiter" ng-if="!$last"> > </span>\n      </span>\n    </div>    ',link:function(n){n.breadcrumbs=[];var r=e.routes?Object.values(e.routes):[];function i(e,n){var r=[],o=e.find((e=>e.code===n));return o?(o.displayName=t.instant(o.code),r.push(o),o.parent&&r.push(...i(e,o.parent)),r):r}n.$on("$routeChangeSuccess",(function(e,t){var o=i(r,t.$$route.code);o.reverse(),n.breadcrumbs=o}))}}}],exports.vueWrapper=function(){return{restrict:"A",link:function(e,t){Promise.all([__webpack_require__.e(62831),__webpack_require__.e(4301),__webpack_require__.e(67728),__webpack_require__.e(91403),__webpack_require__.e(91275),__webpack_require__.e(33309),__webpack_require__.e(42529),__webpack_require__.e(8499),__webpack_require__.e(14982),__webpack_require__.e(61819),__webpack_require__.e(25261),__webpack_require__.e(2079),__webpack_require__.e(74632),__webpack_require__.e(77768),__webpack_require__.e(17455),__webpack_require__.e(25303),__webpack_require__.e(27177),__webpack_require__.e(54174),__webpack_require__.e(27916),__webpack_require__.e(29357),__webpack_require__.e(15169),__webpack_require__.e(76299),__webpack_require__.e(95416),__webpack_require__.e(6671)]).then(__webpack_require__.bind(__webpack_require__,548908)).then((()=>{if(!t._vue){var n=new Vue({el:t[0],i18n:I18n,provide:e.vueParam,data:()=>e.vueParam||{},methods:e.vueMethods||{}});e.vue=n,t._vue=n}}))}}},exports.vueSlider=["$timeout",function($timeout){return{restrict:"E",scope:{},template:'\n          <div style="width: 100%" vue-wrapper>\n            <wg-slider :value="value" :stop="stop" :max="max" :show-tips="showTips" :published="published" @input="sliderInput"></wg-slider>\n          </div>',controller:["$scope",function(e){e.stop=0,e.max=100,e.vueLoaded=!1,e.httpLoaded=!1,e.showTips=!1,e.published=!1,e.value=0,e.vueParam={stop:e.stop,max:e.max,showTips:e.showTips,published:e.published,value:e.value},e.vueMethods={sliderInput(t){e.$emit("inputChange",t)}},e.$watch("vue",(()=>{e.vue&&(e.vueLoaded=!0,e.httpLoaded&&e.$emit("resetVueParam"))})),e.$on("resetVueParam",(()=>{e.vueLoaded&&e.httpLoaded?void 0!==e.vue.stop&&(e.vue.stop=e.stop,e.vue.max=e.max,e.vue.showTips=e.showTips,e.vue.published=e.published,e.vue.value=e.value):e.$apply()}))}],link($scope,_,$attrs){var leftPercentField=$attrs.leftPercent,percentField=$attrs.percent,publishedField=$attrs.published,isScoredField=$attrs.isScored,useMax=void 0!==$attrs.max||"true"===$attrs.max,showTips=void 0!==$attrs.showTips||"true"===$attrs.showTips;$scope.$watch("$parent.".concat(leftPercentField),(newValue=>{if($scope.$parent[leftPercentField]&&$scope.$parent[leftPercentField].minus){if(useMax){var max=Number(new Decimal(100).minus($scope.$parent[leftPercentField]).toFixed());$scope.max=max}showTips&&($scope.showTips=!0),$scope.published=eval("$scope.$parent.".concat(publishedField)),$scope.value=Number(eval("$scope.$parent.".concat(percentField))),$scope.stop=Number(newValue.toFixed()),$scope.httpLoaded=!0,$scope.vueLoaded&&$scope.$emit("resetVueParam")}})),isScoredField&&$scope.$watch("$parent.".concat(isScoredField),(()=>{$timeout((()=>{$scope.$emit("resetVueParam")}),50)})),$scope.$on("inputChange",((_,data)=>{$timeout(eval("$scope.$parent.".concat(percentField," = ").concat(data)))}))}}}],exports.elementReady=function(){return{priority:-1e3,restrict:"A",link:function(e,t,n){e.$eval(n.elementReady)}}};var ace=__webpack_require__(722085);ace.config.set("basePath","/static/js/ace"),exports.code=function(){return{priority:-100,restrict:"E",transclude:!0,replace:!0,scope:!0,template:'<pre style="min-width:600px;background:white;" id="{{uuid}}"><ng-transclude></ng-transclude></pre>',link:function(e,t,n){e.lang=_.find((n.class||"").split(/\s+/),(e=>e.includes("lang")))||"lang-javascript",e.uuid=[(new Date).getTime(),Math.floor(1e4*Math.random())].join("_"),setTimeout((function(){$("#".concat(e.uuid)).length<=0||(e.editor=ace.edit(e.uuid,{maxLines:25,wrap:!0,highlightActiveLine:!1,mode:"ace/mode/".concat(e.lang.replace("lang-","")),useWorker:!1}),e.editor.setReadOnly(!0))}),500)}}},exports.previewContentInIframe=["$timeout",e=>({restrict:"A",link(e,t,n){$(t).html('<iframe id="previewContentInIframe" src="'.concat(n.iframeSrc,'" style="width:100%;height:').concat(n.iframeHeight,'px;border:none"></iframe>')),"true"==n.resize&&iFrameResize({log:!1,checkOrigin:!1},"#previewContentInIframe")}})],exports.groupSelector=()=>({restrict:"E",template:'<div id="group-selector" ng-style="{\'width\': boxWidth}" ng-class="{\'group-selector-forbidden\': readonly == \'true\'}">\n            <div class="group-selector-btn btn-size-[[btnSize]]" ng-class="{\'border-hide\': hideBorder == \'true\', \'border-show\': hideBorder != \'true\'}" ng-click="openSelector()">\n              <label class="selected-name" ng-if="selectedName !=\'\'" ng-bind="selectedName" tipsy="selectedName" tipsy-ellipsis="no"></label>\n              <label class="dropdown-icon"><i class="icon icon-arrow-down"></i></label>\n            </div>\n            <ul id="group-selector-box" class="hidden-selector" ng-style="{\'width\': boxWidth, \'max-height\': boxHeight}">\n              <li ng-repeat="item in selectList"\n                ng-class="{\'selected-option\': item.value==selected && item.highlight, \'highlight-option\': item.highlight, \'secondary-option\': item.level > 1}"\n                ng-click="selectItem(item)"\n                tipsy="item.key" tipsy-ellipsis="no">{{item.key}}</li>\n            </ul>\n          </div>',scope:{groups:"=",selected:"=",disabled:"=",hideBorder:"@",width:"@",height:"@",readonly:"@",btnSize:"@"},link(e,t,n){e.selectList=[],e.selectedName="",e.boxWidth=e.width&&""!=e.width?e.width:"320px",e.boxHeight=e.height&&""!=e.height?e.height:"300px",e.btnSize=e.btnSize&&""!=e.btnSize?e.btnSize:"small",e.showDropDown=!1,e.groupLength=0,e.$watch("groups+selected",(function(){e.groups&&e.groupLength!=e.groups.length&&(e.groupLength=e.groups.length,e.selectList=[],e.selected=e.selected&&""!=e.selected&&-1!=e.selected&&0!=e.selected?e.selected:e.groups[0].value,e.selectedName="",e.oldGroupLen=e.groups.length,e.groups.forEach((t=>{var n=!t.items||0==t.items.length;e.selectList.push({key:t.name,value:n?t.value:9999,highlight:n,level:1}),e.selected&&e.selected==t.value&&(e.selectedName=t.name),n||t.items.forEach((t=>{e.selectList.push({key:t.name,value:t.value,highlight:!0,level:2}),e.selected&&e.selected==t.value&&(e.selectedName=t.name)}))})),""==e.selectedName&&(e.selectedName=e.groups[0].name,e.selected=e.groups[0].value),document.addEventListener("mouseup",(e=>{e=e||window.event;var n=$(".group-selector-btn");n.is(e.target)||0!==n.has(e.target).length||(t[0].children[0].children[1].classList.add("hidden-selector"),t[0].children[0].children[0].classList.remove("highlight-btn"))}))),e.selectList.length>0&&e.selectList.forEach((t=>{e.selected==t.value&&(e.selectedName=t.key)}))})),e.$watch("disabled",(function(){e.selectList.forEach((t=>{t.highlight=t.value!=e.disabled&&9999!=t.value})),e.selected&&e.selected==e.disabled&&(e.selected=e.groups[0].value,e.selectedName=e.groups[0].name)})),e.openSelector=function(n){"true"!=e.readonly&&(t[0].children[0].children[0].classList.add("highlight-btn"),t[0].children[0].children[1].classList.remove("hidden-selector"))},e.selectItem=function(n){n.highlight&&(e.selected=n.value,e.selectedName=n.key,t[0].children[0].children[1].classList.add("hidden-selector"),t[0].children[0].children[0].classList.remove("highlight-btn"))}}}),exports.injectContext=["$compile",e=>({restrict:"A",link(){window.$compile||(window.$compile=e)}})],exports.checkUploadStatus=()=>({restrict:"A",link(e,t,n){e.uploads&&e.uploads.length&&_.find(e.uploads,(e=>e.audit_status))?e.hasAuditStatus=!0:e.hasAuditStatus=!1}}),exports.iframeonload=()=>({restrict:"A",link:(e,t,n)=>{t.bind("load",(()=>{e.$apply((()=>e.$eval(n.iframeonload)))}))}}),exports.autoHeightTextarea=["$timeout",function(e){return{restrict:"A",link:function(t,n){t.initialHeight=t.initialHeight||n[0].style.height;var r=function(){n[0].style.height=t.initialHeight,n[0].style.height=Math.floor(n[0].scrollHeight+5)+"px"};n.on("input change",r),e(r,0)}}}],exports.autoHeightTable=["$timeout",function(e){return{restrict:"A",link(t,n,r){var i,o=n.index(),a=null!==(i=r.autoHeightTable)&&void 0!==i?i:"",l=r.useIndex,s=a.split(",");e((()=>{var e=n.height();s.forEach((t=>{var n=$(".".concat(t))[l?o:o-1];n&&$(n).height(e)})),n.height(e)}))}}}],exports.verticalSelf=["$timeout",function(e){return{restrict:"A",link(t,n){var r=n.parent();e((()=>{var e=n.height(),t=r.height()/2-e/2;n.css({marginTop:t})}))}}}],exports.autoHeightForState=["$timeout",function(e){return{restrict:"A",link(t,n){var r=$(n).index(),i=$(".activity-body .module-content-wrapper"),o=$(".module-overall, .module-block, .syllabus-block, .activity-block",i);console.log(),e((()=>{var e=n.height();o.each(((t,n)=>{$($(n).children().get(r)).css({height:e+"px","line-height":e+"px"})}));var t=$(".basic-info-header + div").height();$(".activity-body .module-header-wrapper .module-header").height(t),$(".activity-body .module-header-wrapper").parent().height(t).parent().height(t)}))}}}],exports.waterMark=[()=>({restrict:"A",link(e,t,n){var r=n.waterMark,i=n.color,o=n.font,a=utils.createWaterMakerImage(r,{fillStyle:i,font:o}),l=$("<div class='water-mark'>").css({position:"fixed",top:0,left:0,pointerEvents:"none",width:"100vw",height:"100vh",background:"red",background:"url(".concat(a,") repeat")});$(t).find(".water-mark").length||$(t).append(l)}})],exports.circleProgress=[()=>({restrict:"A",link(e,t,n){var r=n.circleValue;t[0].parentElement.style.setProperty("--progress-value",r)}})]},201351:function(e,t,n){var r=n(370538).default;n(323123),e.exports={preUpload:e=>r.http.post("/api/uploads",e),uploadBlob(e,t,n,r){var i=new FormData,o=t.type.split("/")[1];return i.append("file",t,"file.".concat(o)),"QINIU"===e.storage_type?this.upload2Qiniu(e,i,n,r):this.upload2Local(e,i,n,r)},uploadResource(e,t,n,r,i){var o=new FormData;return o.append("file",t),"QINIU"===e.storage_type?this.upload2Qiniu(e,o,n,r,i):this.upload2Local(e,o,n,r,i)},updateToken:e=>r.http.get("/api/uptoken?id=".concat(e.id)),upload2Qiniu(e,t,n,i,o){return this.updateToken(e).then((function(a){var l="UpToken ".concat(a.body.uptoken),s="".concat(e.upload_url,"/mkblk/").concat(t.get("file").size),d="".concat(e.upload_url,"/mkfile/").concat(t.get("file").size),c={Authorization:l,"Content-Type":"application/octet-stream"},u={Authorization:l,"Content-Type":"text/plain;charset=UTF-8"};return r.http.post(s,t.get("file"),{headers:c}).then((e=>r.http.post(d,e.data.ctx,{headers:u,progress:n}).then(i,o)),o)}),(()=>o()))},upload2Local(e,t,n,i,o){if("S3"===e.storage_type&&"WRPC"===e.transcoder){var a=t.get("file"),l={headers:{"Content-Type":a.type},progress:n};return r.http.put(e.upload_url,a,l).then(i,o)}return r.http.put(e.upload_url,t,{progress:n}).then(i,o)},uploadCallback:e=>r.http.post("/internal-api/upload/callback/".concat(e),{file_key:e}),previewUploadsInfo:(e,t,n)=>r.http.get("/api/uploads/".concat(e,"?preview=true")).then(t,n),createParseWord:(e,t,n,i,o)=>r.http.post("/api/data-import/from-word",{upload_id:e,html:n,belong:t}).then(i,o)}},606565:function(e){e.exports={isUploadCallback:e=>"S3"===e.storage_type&&"WRPC"===e.transcoder}},246955:function(e,t,n){var r,i,o,a=n(904072);!function(n){"use strict";function l(e,t,n){"addEventListener"in window?e.addEventListener(t,n,!1):"attachEvent"in window&&e.attachEvent("on"+t,n)}function s(e,t,n){"removeEventListener"in window?e.removeEventListener(t,n,!1):"detachEvent"in window&&e.detachEvent("on"+t,n)}function d(e){return N+"["+function(e){var t="Host page: "+e;return window.top!==window.self&&(t=window.parentIFrame&&window.parentIFrame.getId?window.parentIFrame.getId()+": "+e:"Nested host page: "+e),t}(e)+"]"}function c(e){return H[e]?H[e].log:F}function u(e,t){g("log",e,t,c(e))}function p(e,t){g("info",e,t,c(e))}function f(e,t){g("warn",e,t,!0)}function g(e,t,n,r){!0===r&&"object"==typeof window.console&&console[e](d(t),n)}function m(e){function t(){n("Height"),n("Width"),_((function(){$(m),y(S),c("resizedCallback",m)}),m,"init")}function n(e){var t=Number(H[S]["max"+e]),n=Number(H[S]["min"+e]),r=e.toLowerCase(),i=Number(m[r]);u(S,"Checking "+r+" is in range "+n+"-"+t),n>i&&(i=n,u(S,"Set "+r+" to min value")),i>t&&(i=t,u(S,"Set "+r+" to max value")),m[r]=""+i}function r(e){return g.substr(g.indexOf(":")+L+e)}function i(e,t){T((function(){x("Send Page Info","pageInfo:"+function(){var e=document.body.getBoundingClientRect(),t=m.iframe.getBoundingClientRect();return JSON.stringify({iframeHeight:t.height,iframeWidth:t.width,clientHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),offsetTop:parseInt(t.top-e.top,10),offsetLeft:parseInt(t.left-e.left,10),scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset})}(),e,t)}),32)}function o(e){var t=e.getBoundingClientRect();return b(S),{x:Math.floor(Number(t.left)+Number(O.x)),y:Math.floor(Number(t.top)+Number(O.y))}}function a(e){var t=e?o(m.iframe):{x:0,y:0},n={x:Number(m.width)+t.x,y:Number(m.height)+t.y};u(S,"Reposition requested from iFrame (offset x:"+t.x+" y:"+t.y+")"),window.top!==window.self?window.parentIFrame?window.parentIFrame["scrollTo"+(e?"Offset":"")](n.x,n.y):f(S,"Unable to scroll to requested position, window.parentIFrame not found"):(O=n,d(),u(S,"--"))}function d(){!1!==c("scrollCallback",O)?y(S):w()}function c(e,t){return h(S,e,t)}var g=e.data,m={},S=null;"[iFrameResizerChild]Ready"===g?function(){for(var e in H)x("iFrame requested init",C(e),document.getElementById(e),e)}():N===(""+g).substr(0,q)&&g.substr(q).split(":")[0]in H?(m=function(){var e=g.substr(q).split(":");return{iframe:H[e[0]]&&H[e[0]].iframe,id:e[0],height:e[1],width:e[2],type:e[3]}}(),S=m.id,H[S]&&(H[S].loaded=!0),!function(){var e=m.type in{true:1,false:1,undefined:1};return e&&u(S,"Ignoring init message from meta parent page"),e}()&&function(e){var t=!0;return H[e]||(t=!1,f(m.type+" No settings for "+e+". Message was: "+g)),t}(S)&&(u(S,"Received: "+g),function(){var e=!0;return null===m.iframe&&(f(S,"IFrame ("+m.id+") not found"),e=!1),e}()&&function(){var t=e.origin,n=H[S]&&H[S].checkOrigin;if(n&&""+t!="null"&&!(n.constructor===Array?function(){var e=0,r=!1;for(u(S,"Checking connection is from allowed list of origins: "+n);e<n.length;e++)if(n[e]===t){r=!0;break}return r}():function(){var e=H[S]&&H[S].remoteHost;return u(S,"Checking connection is from: "+e),t===e}()))throw new Error("Unexpected message received from: "+t+" for "+m.iframe.id+". Message was: "+e.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return!0}()&&function(){switch(H[S]&&H[S].firstRun&&(H[S]&&(H[S].firstRun=!1)),m.type){case"close":H[S].closeRequestCallback?h(S,"closeRequestCallback",H[S].iframe):v(m.iframe);break;case"message":!function(e){u(S,"MessageCallback passed: {iframe: "+m.iframe.id+", message: "+e+"}"),c("messageCallback",{iframe:m.iframe,message:JSON.parse(e)}),u(S,"--")}(r(6));break;case"scrollTo":a(!1);break;case"scrollToOffset":a(!0);break;case"pageInfo":i(H[S]&&H[S].iframe,S),function(){function e(e,r){function o(){H[n]?i(H[n].iframe,n):t()}["scroll","resize"].forEach((function(t){u(n,e+t+" listener for sendPageInfo"),r(window,t,o)}))}function t(){e("Remove ",s)}var n=S;e("Add ",l),H[n]&&(H[n].stopPageInfo=t)}();break;case"pageInfoStop":H[S]&&H[S].stopPageInfo&&(H[S].stopPageInfo(),delete H[S].stopPageInfo);break;case"inPageLink":!function(e){var t=e.split("#")[1]||"",n=decodeURIComponent(t),r=document.getElementById(n)||document.getElementsByName(n)[0];r?function(){var e=o(r);u(S,"Moving to in page link (#"+t+") at x: "+e.x+" y: "+e.y),O={x:e.x,y:e.y},d(),u(S,"--")}():window.top!==window.self?window.parentIFrame?window.parentIFrame.moveToAnchor(t):u(S,"In page link #"+t+" not found and window.parentIFrame not found"):u(S,"In page link #"+t+" not found")}(r(9));break;case"reset":k(m);break;case"init":t(),c("initCallback",m.iframe);break;default:t()}}())):p(S,"Ignored: "+g)}function h(e,t,n){var r=null,i=null;if(H[e]){if("function"!=typeof(r=H[e][t]))throw new TypeError(t+" on iFrame["+e+"] is not a function");i=r(n)}return i}function v(e){var t=e.id;u(t,"Removing iFrame: "+t),e.parentNode&&e.parentNode.removeChild(e),h(t,"closedCallback",t),u(t,"--"),delete H[t]}function b(e){null===O&&u(e,"Get page position: "+(O={x:window.pageXOffset!==n?window.pageXOffset:document.documentElement.scrollLeft,y:window.pageYOffset!==n?window.pageYOffset:document.documentElement.scrollTop}).x+","+O.y)}function y(e){null!==O&&(window.scrollTo(O.x,O.y),u(e,"Set page position: "+O.x+","+O.y),w())}function w(){O=null}function k(e){u(e.id,"Size reset requested by "+("init"===e.type?"host page":"iFrame")),b(e.id),_((function(){$(e),x("reset","reset",e.iframe,e.id)}),e,"reset")}function $(e){function t(t){e.iframe.style[t]=e[t]+"px",u(e.id,"IFrame ("+i+") "+t+" set to "+e[t]+"px")}function n(t){V||"0"!==e[t]||(V=!0,u(i,"Hidden iFrame detected, creating visibility listener"),function(){function e(){function e(e){function t(t){return"0px"===(H[e]&&H[e].iframe.style[t])}function n(e){return null!==e.offsetParent}H[e]&&n(H[e].iframe)&&(t("height")||t("width"))&&x("Visibility change","resize",H[e].iframe,e)}for(var t in H)e(t)}function t(t){u("window","Mutation observed: "+t[0].target+" "+t[0].type),T(e,16)}function n(){var e=document.querySelector("body"),n={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0};new r(t).observe(e,n)}var r=window.MutationObserver||window.WebKitMutationObserver;r&&n()}())}function r(e){t(e),n(e)}var i=e.iframe.id;H[i]&&(H[i].sizeHeight&&r("height"),H[i].sizeWidth&&r("width"))}function _(e,t,n){n!==t.type&&j?(u(t.id,"Requesting animation frame"),j(e)):e()}function x(e,t,n,r,i){var o=!1;r=r||n.id,H[r]&&(n&&"contentWindow"in n&&null!==n.contentWindow?function(){var i=H[r]&&H[r].targetOrigin;u(r,"["+e+"] Sending msg to iframe["+r+"] ("+t+") targetOrigin: "+i),n.contentWindow.postMessage(N+t,i)}():f(r,"["+e+"] IFrame("+r+") not found"),i&&H[r]&&H[r].warningTimeout&&(H[r].msgTimeout=setTimeout((function(){!H[r]||H[r].loaded||o||(o=!0,f(r,"IFrame has not responded within "+H[r].warningTimeout/1e3+" seconds. Check iFrameResizer.contentWindow.js has been loaded in iFrame. This message can be ingored if everything is working, or you can set the warningTimeout option to a higher value or zero to suppress this warning."))}),H[r].warningTimeout)))}function C(e){return e+":"+H[e].bodyMarginV1+":"+H[e].sizeWidth+":"+H[e].log+":"+H[e].interval+":"+H[e].enablePublicMethods+":"+H[e].autoResize+":"+H[e].bodyMargin+":"+H[e].heightCalculationMethod+":"+H[e].bodyBackground+":"+H[e].bodyPadding+":"+H[e].tolerance+":"+H[e].inPageLinks+":"+H[e].resizeFrom+":"+H[e].widthCalculationMethod}function S(e,t){var r=function(n){return n,""===n&&(e.id=n=function(){var e=t&&t.id||z.id+P++;return null!==document.getElementById(e)&&(e+=P++),e}(),F=(t||{}).log,n,u(n,"Added missing iframe ID: "+n+" ("+e.src+")")),n}(e.id);r in H&&"iFrameResizer"in e?f(r,"Ignored iFrame, already setup."):(function(t){t=t||{},H[r]={firstRun:!0,iframe:e,remoteHost:e.src.split("/").slice(0,3).join("/")},function(e){if("object"!=typeof e)throw new TypeError("Options is not an object")}(t),function(e){for(var t in z)z.hasOwnProperty(t)&&(H[r][t]=e.hasOwnProperty(t)?e[t]:z[t])}(t),H[r]&&(H[r].targetOrigin=!0===H[r].checkOrigin?function(e){return""===e||"file://"===e?"*":e}(H[r].remoteHost):"*")}(t),function(){switch(u(r,"IFrame scrolling "+(H[r]&&H[r].scrolling?"enabled":"disabled")+" for "+r),e.style.overflow=!1===(H[r]&&H[r].scrolling)?"hidden":"auto",H[r]&&H[r].scrolling){case!0:e.scrolling="yes";break;case!1:e.scrolling="no";break;default:e.scrolling=H[r]?H[r].scrolling:"no"}}(),function(){function t(t){1/0!==H[r][t]&&0!==H[r][t]&&(e.style[t]=H[r][t]+"px",u(r,"Set "+t+" = "+H[r][t]+"px"))}function n(e){if(H[r]["min"+e]>H[r]["max"+e])throw new Error("Value for min"+e+" can not be greater than max"+e)}n("Height"),n("Width"),t("maxHeight"),t("minHeight"),t("maxWidth"),t("minWidth")}(),("number"==typeof(H[r]&&H[r].bodyMargin)||"0"===(H[r]&&H[r].bodyMargin))&&(H[r].bodyMarginV1=H[r].bodyMargin,H[r].bodyMargin=H[r].bodyMargin+"px"),function(t){l(e,"load",(function(){x("iFrame.onload",t,e,n,!0),function(){var t=H[r]&&H[r].firstRun,n=H[r]&&H[r].heightCalculationMethod in R;!t&&n&&k({iframe:e,height:0,width:0,type:"init"})}()})),x("init",t,e,n,!0)}(C(r)),Function.prototype.bind&&H[r]&&(H[r].iframe.iFrameResizer={close:v.bind(null,H[r].iframe),resize:x.bind(null,"Window resize","resize",H[r].iframe),moveToAnchor:function(e){x("Move to anchor","moveToAnchor:"+e,H[r].iframe,r)},sendMessage:function(e){x("Send Message","message:"+(e=JSON.stringify(e)),H[r].iframe,r)}}))}function T(e,t){null===D&&(D=setTimeout((function(){D=null,e()}),t))}function A(e){u("window","Trigger event: "+e),T((function(){M("Window "+e,"resize")}),16)}function E(){"hidden"!==document.visibilityState&&(u("document","Trigger event: Visiblity change"),T((function(){M("Tab Visable","resize")}),16))}function M(e,t){function n(e){return H[e]&&"parent"===H[e].resizeFrom&&H[e].autoResize&&!H[e].firstRun}for(var r in H)n(r)&&x(e,t,document.getElementById(r),r)}function I(){l(window,"message",m),l(window,"resize",(function(){A("resize")})),l(document,"visibilitychange",E),l(document,"-webkit-visibilitychange",E),l(window,"focusin",(function(){A("focus")})),l(window,"focus",(function(){A("focus")}))}if("undefined"!=typeof window){var P=0,F=!1,V=!1,L="message".length,N="[iFrameSizer]",q=N.length,O=null,j=window.requestAnimationFrame,R={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},H={},D=null,z={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,warningTimeout:5e3,tolerance:0,widthCalculationMethod:"scroll",closedCallback:function(){},initCallback:function(){},messageCallback:function(){f("MessageCallback function not defined")},resizedCallback:function(){},scrollCallback:function(){return!0}};a&&function(e){e.fn?e.fn.iFrameResize||(e.fn.iFrameResize=function(e){return this.filter("iframe").each((function(t,n){S(n,e)})).end()}):p("","Unable to bind to jQuery, it is not fully loaded.")}(a),i=[],void 0===(o="function"==typeof(r=function(){function e(e,n){n&&(function(){if(!n.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==n.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+n.tagName+">")}(),S(n,e),t.push(n))}var t;return function(){var e,t=["moz","webkit","o","ms"];for(e=0;e<t.length&&!j;e+=1)j=window[t[e]+"RequestAnimationFrame"];j||u("setup","RequestAnimationFrame not supported")}(),I(),function(r,i){switch(t=[],function(e){e&&e.enablePublicMethods&&f("enablePublicMethods option has been removed, public methods are now always available in the iFrame")}(r),typeof i){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(i||"iframe"),e.bind(n,r));break;case"object":e(r,i);break;default:throw new TypeError("Unexpected data type ("+typeof i+")")}return t}})?r.apply(t,i):r)||(e.exports=o)}}()}}]);