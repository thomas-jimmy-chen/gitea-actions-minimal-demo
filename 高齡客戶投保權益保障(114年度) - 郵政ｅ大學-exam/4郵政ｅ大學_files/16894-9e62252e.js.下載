(self.webpackChunklms=self.webpackChunklms||[]).push([[16894,27551],{940635:function(e,t,r){var n=r(904072),o=r(361204),i=r(708468);r(923157),r(30138),r(692624),r(589842),r(749807),r(148510);var a=n("html").attr("lang"),s=r(978571),c=r(704873),u=r(103982),l=r(726356),d=r(926082),p=r(942518),f=r(19e4),m=r(635224),h=r(752104),v=r(932135),g=r(693604),y=r(117403).default,w=r(979262),b=["ngRoute","stringFormat","ngProgress","monospaced.qrcode","ui.select2","ng-sortable","duScroll","ngSanitize","ui.calendar","linkify","angular-clipboard","i18n"];window.CONFIGS&&window.CONFIGS.sentryClientKey&&b.push("ngSentry"),e.exports=o.module("base",b).directive("avatar",r(267038)).directive("svgIcon",r(845032)).directive("fdSlider",r(746794)).directive("autoHeightTable",s.autoHeightTable).directive("verticalSelf",s.verticalSelf).directive("expandableContent",s.expandableContent).directive("expandableContentNew",s.expandableContentNew).directive("expandableContentRemember",s.expandableContentRemember).directive("expandableContentIsolate",s.expandableContentIsolate).directive("foldableContentRemember",s.foldableContentRemember).directive("toggleGroupManager",s.toggleGroupManager).directive("datepicker",s.datepicker).directive("datetimepicker",s.datetimepicker).directive("timepicker",s.timepicker).directive("confirmDialog",s.confirmDialog).directive("revealModal",c.revealModal).directive("resetable",c.resetable).directive("reveal",c.reveal).directive("closePopup",c.closePopup).directive("closePlayerPopup",c.closePlayerPopup).directive("serverValidated",u.serverValidated).directive("errorFor",u.errorFor).directive("errorForTreeView",u.errorForTreeView).directive("closeDropdown",s.closeDropdown).directive("uiSelect2",s.uiSelect2).directive("addSlideSelect2",s.addSlideSelect2).directive("focus",s.focus).directive("simEditor",s.simEditor).directive("formatScore",s.formatScore).directive("multiSelect",l).directive("multipleSelect",d).directive("scrollable",s.scrollable).directive("simditorAudio",s.simditorAudio).directive("ngCompileHtml",s.ngCompileHtml).directive("enterPress",s.enterPress).directive("escPress",s.escPress).directive("scrollableTimeline",s.scrollableTimeline).directive("videoPlayer",s.videoPlayer).directive("vueVideoMultiPlayer",s.vueVideoMultiPlayer).directive("vueSlider",s.vueSlider).directive("vueWrapper",s.vueWrapper).directive("sortable",s.sortable).directive("dragCloneable",s.dragCloneable).directive("tipsy",s.tipsy).directive("tipsyLiteral",s.tipsyLiteral).directive("tipsyAuto",s.tipsyAuto).directive("fixableNav",s.fixableNav).directive("cornerButtonGroup",s.cornerButtonGroup).directive("fixableButtons",s.fixableButtons).directive("fixableListHeader",s.fixableListHeader).directive("scrollToTop",s.scrollToTop).directive("onModalStateChange",r(716858).p).directive("indeterminateCheckbox",s.indeterminateCheckbox).directive("ngPlaceholder",r(450171).w4).directive("focusPlaceholder",r(450171).he).directive("uiSelect2KeyPress",s.uiSelect2KeyPress).directive("stopPropagation",s.stopPropagation).directive("contentLengthLimit",s.contentLengthLimit).directive("modelPatron",s.modelPatron).directive("modelScorePatron",s.modelScorePatron).directive("modelTimeScorePatron",s.modelTimeScorePatron).directive("contentLengthLeft",s.contentLengthLeft).directive("toggleDropdownList",s.toggleDropdownList).directive("expandHeight",s.expandHeight).directive("autoResizeTextarea",r(864604)).directive("dotdotdot",r(80320)).directive("formatDatetime",s.formatDatetime).directive("parseInteger",s.parseInteger).directive("parseBoolean",s.parseBoolean).directive("goBack",s.goBack).directive("autoSelect",s.autoSelect).directive("onFileSelected",s.onFileSelected).directive("floatPrecision",s.floatPrecision).directive("alert",s.alert).directive("spaceTrim",r(625167)).directive("previewer",s.previewer).directive("resourceReferencePreviewer",s.resourceReferencePreviewer).directive("hypothesisStat",s.hypothesisStat).directive("integerLimit",s.integerLimit).directive("uuidFormatter",s.uuidFormatter).directive("wgPlaceholder",r(450171).jC).directive("toggleDropdown",r(956212)).directive("togglePopup",r(908760)).directive("refreshOn",s.refreshOn).directive("backgroundImage",s.backgroundImage).directive("beforeController",s.beforeController).directive("activityCheckpointLock",s.activityCheckpointLock).directive("rootScopeVariable",s.rootScopeVariable).directive("fixNgModelName",s.fixNgModelName).directive("hasSecondLevelMenu",s.hasSecondLevelMenu).directive("treeView",s.treeView).directive("draggable",s.draggable).directive("swfObject",r(529149)).directive("calcElementHeight",r(985396)).directive("mathjax",r(892958)).directive("code",s.code).directive("groupSelector",s.groupSelector).directive("injectContext",s.injectContext).directive("checkUploadStatus",s.checkUploadStatus).directive("iframeonload",s.iframeonload).directive("autoHeightTextarea",s.autoHeightTextarea).directive("waterMark",s.waterMark).directive("circleProgress",s.circleProgress).filter("duration",p.duration).filter("formatTime",p.formatTime).filter("statFormatTime",p.statFormatTime).filter("humanizeBytes",p.humanizeBytes).filter("humanizeSpeed",p.humanizeSpeed).filter("courseFilter",p.courseFilter).filter("limitLength",p.limitLength).filter("statDatetime",p.statDatetime).filter("datetime",m.datetime).filter("date",m.date).filter("time",m.time).filter("monthAndDay",m.dateWithoutYear).filter("secondsToHms",h).filter("percent",p.percent).filter("formatScore",p.formatScore).filter("truncateText",p.truncateText).filter("fileName",p.fileName).filter("fileExtension",p.fileExtension).filter("clearText",p.clearText).filter("sanitizeHtml",p.sanitizeHtml).filter("year",p.year).filter("month",p.month).filter("day",p.day).filter("trustSrc",p.trustSrc).filter("scoreAsActivity",p.scoreAsActivity).filter("uuidFilter",p.uuidFilter).filter("intToChar",p.intToChar).filter("trustAsHtml",p.trustAsHtml).filter("removeHtmlTag",p.removeHtmlTag).filter("replaceImgTag",p.replaceImgTag).filter("unescapeHtmlChar",p.unescape).filter("displayName",p.displayName).filter("insert",p.insert).filter("displayUserNo",p.displayUserNo).filter("orderBySort",p.orderBySort).directive("formatValidated",f.formatValidated).config(["$locationProvider",function(e){e.hashPrefix("")}]).config(["$interpolateProvider",function(e){return e.startSymbol("[["),e.endSymbol("]]")}]).config(["$httpProvider",function(e){return e.defaults.headers.patch={"Content-Type":"application/json;charset=utf-8"},e.defaults.useXDomain=!0,e.interceptors.push(v.progressInterceptor),e.interceptors.push(v.cacheBusterInterceptor)}]).config(["$sanitizeProvider",function(e){e.enableSvg(!0),e.addValidAttrs(["data-latex","data-non-image"]),e.addValidElements(["use"])}]).run(["uiSelect2Config",function(e){e.formatResult=function(e){var t=n("<div></div>");t.addClass("select2-line-content"),t.attr("title",e.text).text(e.text);var r=n("<span></span>");return r.addClass("truncate-text"),r.tipsy({ellipsis:!0,gravity:n.fn.tipsy.autoBounds(37,"sw"),opacity:1,html:!0}),t.append(r),t},e.formatSelection=e=>"<div title ='".concat(e.text,"' class='select2-line-content'>").concat(i.escape(e.text),"</div>")}]).run(["$rootScope",function(e){return e.$t=y.t.bind(y),e.$tc=y.tc.bind(y),e.$te=y.te.bind(y),e.$on("$routeChangeSuccess",(function(e,t){n(".tipsy").remove()})),e.isIE9=window.isIE9,e.lang=a,["en-US","en-GB"].includes(e.lang)?e.langForTca="en":["zh-TW","zh-MO"].includes(e.lang)?e.langForTca="zh-TW":e.langForTca=a,e.isEnglish=g.startsWith(a,"en"),e.canPreview=e=>["document","image","video","audio","scorm","evercam","swf","video-quiz","link","file","other"].includes(e.type),e.canShowResource=(e,t)=>t||!(null!=e&&e.audit_status)||"agree"===(null==e?void 0:e.audit_status),e.openChatRobot=()=>{var e=new CustomEvent("chat-robot:open");window.dispatchEvent(e)},e.openHustLib=()=>{n("#hust-library-popup").foundation("reveal","open")},e.openFeedbackWebApp=()=>{var e=JSON.stringify({orgUrl:document.location.href}),t=w.name+":"+w.version,r="WEB"+document.getElementsByTagName("html")[0].version;window.open("".concat("https://support.qq.com/product/288301","?clientVersion=").concat(r,"&os=").concat(t,"&customInfo=").concat(e))},e.canEditByPdfEditor=e=>!e.deleted&&g.canEditByPdfEditor(e),e.canEditByPdfEditorInHomework=e=>["document","image","audio","video","file"].includes(e.type),e.isIE9CannotUploadFile=()=>e.isIE9&&"QINIU"===e.storageType,e.fileTypeByExtension=g.fileTypeByExtension,e.wpsPreview=g.wpsPreview,e.showTranscodeUnreadyTips=g.showTranscodeUnreadyTips,Foundation.libs.reveal.settings.animation=null,e.$watch((function(){if(window.MathJax&&MathJax.Hub)return MathJax.Hub.Queue(["Typeset",MathJax.Hub]),!0}))}]).run(["highlight",e=>o.element.prototype.highlight=e.highlight]).run(["$rootScope","$route","$location",function(e,t,r){var n=r.path;return r.path=function(o,i){if(!0===i&&!1===i)var a=t.current,s=e.$on("$locationChangeSuccess",(function(){return t.current=a,s()}));return n.apply(r,[o])}}]).name},16578:function(e){e.exports=["$scope","$http","toastr","$timeout",function(e,t,r,n){return e.copiedCode=()=>n((()=>r.success(e.copiedSuccessfullyText))),e.fallbackToManuallyCopy=t=>window.prompt(e.copyFallbackText,t),e.resetAssociationCode=function(){return t.put("/api/user/association-code").success((function(t){return r.success(e.resetSuccessfullyText),e.associationCode=t.association_code})).error((()=>r.error(e.resetFailedText)))}}]},454169:function(e,t,r){var n=r(904072);e.exports=["$scope","$rootScope","$document",function(e,t,r){t.$on("attachment-delete-element",((t,r)=>{e.element=r})),e.confirm=()=>{e.element.remove();var t=new CustomEvent("after-delete-attachment");window.dispatchEvent(t),n("#attachment-delete-confirm").foundation("reveal","close")}}]},805802:function(e,t,r){var n=r(904072);e.exports=["$scope","$window",function(e,t){e.isSelect=!1,t.addEventListener("attachment-edit-id",(t=>{e.editId=t.detail.id})),e.confirm=()=>{if(e.isSelect){var t=JSON.parse(window.localStorage.getItem("attachment-tips"))||[];t.push(e.exam.id),window.localStorage.setItem("attachment-tips",JSON.stringify(t))}var r={id:e.editId},o=new CustomEvent("attachment-confirm",{detail:r});window.dispatchEvent(o),n("#attachment-warning").foundation("reveal","close")}}]},608632:function(e,t,r){var n=r(904072),o=r(293789),i=r(708468);r(556977),r(323123);var a=r(693604);e.exports=["$rootScope","$scope","$timeout","$http","$window",function(e,t,r,s,c){t.ui={isPlaying:!1,isMuting:!1,currentTimeStr:"00:00",durationStr:"00:00",maskWidth:0,sliderBarStartPosition:0,sliderWidth:0};var u={isSliding:!1,isOnAudioUpdate:!1,currentTime:0,duration:0,volume:60,seekingThreshold:0},l=function(e){t.ui.currentTimeStr=a.secondsToHms(e.currentTime),t.ui.durationStr=a.secondsToHms(e.duration),t.$apply();t.ui.currentTimeStr,t.ui.durationStr};t.deleteClass=function(){return n(".audio-wrapper .slider-bar").removeClass("has-warning"),n(".slider-tip-arrow").css("display","none"),!0};t.refreshPos=function(e){var r=n(".audio-wrapper .slider-bar");r.addClass("has-warning"),0==t.ui.sliderBarStartPosition&&(t.ui.sliderBarStartPosition=n(e.target).offset().left+15),0==t.ui.sliderWidth&&(t.ui.sliderWidth=n(e.target).width());var o=t.ui.sliderBarStartPosition,i=t.ui.sliderWidth,a=e.pageX-o;a<0&&r.removeClass("has-warning");var s=n(".audio-wrapper .audio")[0];s.duration&&d(s,i,a)};var d=function(r,o,i){var s,c,l,d=n(".slider-tip"),p=n(".slider-tip-arrow"),f=i-d.width()/2+7.5+"px",m=i+10+"px";if(i<function(t,r){var n=e.refuseForwardSeeking?u.seekingThreshold:t.duration;return r/t.duration*n}(r,o)){c={padding:"0  5px",top:"-5px"},s={display:"none"};var h=parseFloat(i/o*100).toFixed(1)/100*r.duration;t.currentTime=h,t.sliderTip=a.secondsToHms(h),t.enterSliderMask=!1}else c={padding:"12px",top:"-30px"},s={left:m,display:"block"},t.sliderTip="",t.enterSliderMask=!0;c.left=f,d.css(c),p.css(s),l=i,n(".slider-tip-line").css("left",l+15+"px")};t.downloadBlob=function(){var e=o.guard(null!=t.activity?t.activity.uploads:void 0,(e=>e[0]));if(e)return statistics.track({activity_type:"courseware",activity_id:t.activity.id,sub_type:e.name.split(".").pop(),sub_id:e.id,action:statistics.enums.CourseWareAction.download,mode:statistics.enums.Mode.normal,channel:statistics.enums.Channel.web})},t.togglePlay=function(e){var r=n(e.target).parents(".audio-wrapper").find("audio")[0];return t.ui.isPlaying?r.pause():r.play(),t.ui.isPlaying=!t.ui.isPlaying},t.toggleVolume=function(e){var r=n(e.target).parents(".audio-wrapper");t.ui.isMuting=!t.ui.isMuting,t.ui.isMuting?r.find(".volume-slider").slider({value:0}):r.find(".volume-slider").slider({value:u.volume})};var p=function(e){return u.seekingThreshold=Math.max(u.seekingThreshold,e.currentTime),f()},f=function(){var e=n(".audio-wrapper .audio")[0];if(!e||!e.duration)return 0;var r=parseFloat(u.seekingThreshold/e.duration).toFixed(4),o=n(".audio-wrapper .audio-slider").width();return t.ui.maskWidth=String((1-r)*o)};return t.init=function(){return n(".audio").each((function(o,s){var d,m,h;return e.refuseForwardSeeking&&(h=i.find(t.activitiesRead,{activity_type:"learning_activity",activity_id:t.activity.id}),u.seekingThreshold=function(e){if(e&&e.data&&e.data.ranges&&e.data.ranges.length>0)return e.data.ranges[e.data.ranges.length-1][1]}(h)||0,f()),function(e){var r=n(e).parent().find(".audio-slider");r.slider({step:Math.pow(10,-1),range:"max",value:0,min:0,max:100,slide:()=>u.isSliding=!0,start:()=>n(e).trigger("beforeSeeking",{timeBeforSeeking:e.currentTime}),change(){if(!u.isOnAudioUpdate){var t=r.slider("value");return e.currentTime=parseInt(t/100*e.duration)||0,u.isSliding=!1}},stop(){if(t.enterSliderMask){var n=parseFloat(100/e.duration*u.seekingThreshold).toFixed(1);return r.slider("value",n)}}});var o=n(e).parent().find(".volume-slider");o.slider({range:"max",value:u.volume,min:0,max:100,orientation:"vertical",change(){var r=o.slider("value");return t.ui.isMuting=!r>0,r>0&&(u.volume=r),((e,t)=>e.volume=t)(e,r/100)}})}(s),(t.pauseWhenLeavingWindow||null!==(d=t.activity)&&void 0!==d&&null!==(m=d.data)&&void 0!==m&&m.pause_when_leaving_window)&&c.addEventListener("blur",(function(){s&&(s.pause(),t.ui.isPlaying=!1)})),r((function(){!function(r){r.ontimeupdate=function(){if(!u.isSliding&&u.duration){u.isOnAudioUpdate=!0;var o=parseInt(100*r.currentTime/r.duration);return n(r).parent().find(".audio-slider").slider({value:o}),r.currentTime===r.duration&&(t.ui.isPlaying=!1),u.isOnAudioUpdate=!1,l(r),e.refuseForwardSeeking&&p(r),u.currentTime=r.currentTime}},r.ondurationchange=function(){return l(r),u.duration=r.duration},(t.activity&&!t.canGuestPreview||t.resource)&&a.enableTrack(t,n(r),t.activity,"audio",t.resource)}(s);var r=n(s).find("source").attr("src");return r&&sessionStorage.setItem("audioSrc",r),s.src=sessionStorage.getItem("audioSrc"),s.currentTime=t.lastPlayed||0,t.$parent.ui.player=s}))})),!1}}]},646321:function(e,t,r){var n=r(904072),o=r(722085);o.config.set("basePath","/static/js/ace"),e.exports=["$rootScope","$scope","$timeout",function(e,t,r){var i=n("#code-editor");i.on("codeInit",((e,n)=>{r((function(){n.content&&t.editor.setValue(n.content,0),n.lang&&(t.mode=n.lang,t.changeMode()),t.editor.focus()}))})),init=function(){t.editor=o.edit("editor"),t.modes=["javascript","python"],t.mode="javascript",t.editor.session.setMode("ace/mode/javascript"),t.editor.focus()},t.save=function(){var e,r;e=t.editor.getValue(),r={lang:t.mode,content:e},i.trigger("codeEdited",r),t.close()},t.close=function(){t.editor.setValue("",0),t.editor.destroy(),r((function(){i.foundation("reveal","close")}))},t.changeMode=function(){t.editor.session.setMode("ace/mode/".concat(t.mode))},init()}]},406177:function(e,t,r){var n=r(904072),o=r(708468);r(682772),r(788674),r(327852),r(132023);var i=r(887757);function a(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}r(535666);var s=r(693604),c=r(693604).Timer,u=r(751840).default;e.exports=["$rootScope","$scope","$http","$window","$location","activityRepository","toastr","courseManagementApi",function(e,t,r,l,d,p,f,m){var h=n("#courseId").val();t.vueParam={courseCode:""},t.ui={hideCompleteness:!0},t.displayedName="",t.location="",t.teachingClasses="",t.enableEnterDingTalkChat=!1,t.showDingTalkChatButton=!1,t.dingTalkUserInfo={},t.shouldSync=!1,t.hasSubCourses=!1,t.isShowMoodleImportButton=!1,t.isShowMoodleImportPopup=!1,t.isShowMoodleImportPopupFooter=!1,t.moodleImporterStatus=void 0,t.vueMethods={isShowMoodleImportButton(e){t.isShowMoodleImportButton=e,t.$apply()},isShowMoodleImportPopupFooter(e){t.isShowMoodleImportPopupFooter=e,t.$apply()},moodleImporterStatus(e){t.moodleImporterStatus=e,t.$apply(),S()},hasSubCourses(e){t.hasSubCourses=!!e}},t.isSynchronizing=!1;var v=new c,g=new c,y=function(){p.initUserReadsRecords("course_teaching_mode_update").then((e=>{e.show_teaching_mode_change_info&&n("#child-course-teaching-mode-popup").foundation("reveal","open")}))};t.checkRoleButton=function(e){r.put("/api/course/".concat(h,"/role"),{active:e}).success((()=>{l.location.reload()})).error((e=>{f.error(e.message)}))};var w=()=>{p.initUserReadsRecords("course_score_percentage_update").then((function(r){r.show_score_percent_remind?(t.usersReadsCourseScorePercentageInfo=r,r.consumed_child_score_percent>r.child_score_percent?(e.courseScoreSetting={popupType:"excess",limitCourseScorePercent:t.usersReadsCourseScorePercentageInfo.child_score_percent,currentPercentage:t.usersReadsCourseScorePercentageInfo.consumed_child_score_percent,excessPercentage:t.usersReadsCourseScorePercentageInfo.consumed_child_score_percent-t.usersReadsCourseScorePercentageInfo.child_score_percent,warningTemplate:'<span class="error-detail">'.concat(t.usersReadsCourseScorePercentageInfo.child_score_percent,"%</span>")},n("#score-percentage-popup").foundation("reveal","open"),t.$on("scorePercentageUpdated",(function(){t.knew()}))):n("#course-score-synchronized-remind-popup").foundation("reveal","open")):y()}))},b=function(e,t){r.get("/api/course/".concat(h,"/sync-status?status_key=").concat(e)).success(t).error((function(){}))},_=function(){if(1===t.isDeletingContent){var e=function(e){1!==e.status&&(g.stop(),location.reload())};g.start((function(){b("is_deleting_content",e)}),5e3)}},S=function(){var e=function(e){e.status&&1!==e.status&&2!==e.status||(v.stop(),1===e.status&&location.reload())};v.start((function(){b("course_importer_status",e)}),5e3)},x=function(){var e,r=null===(e=t.course.course_attributes.data)||void 0===e?void 0:e.course_importer_status;void 0===r||2===r?t.isShowMoodleImportButton=!0:0===r&&S(),t.moodleImporterStatus=r},C=()=>l.location.href="/course/"+h+"/content";t.inviteUsers=()=>e.invitingCourseUsers=!0,t.addNewModule=function(){return s.endsWith(d.absUrl(),"/content#/")?e.$emit("$addNewModule"):l.location.href="/course/".concat(h,"/content")},t.previewCourse=()=>r.put("/api/courses/".concat(h,"/preview")).success(C).error((function(){})),t.enterClassmode=function(e){return u({action:"inclass.enter",course_id:e}),r.post("/api/course/".concat(e,"/inclass-report")).success((()=>{})).error((()=>{})),window.open("/inclass/courses/".concat(e)),!1},t.validateLiteCourseConditions=function(e){r.get("/api/courses/".concat(e,"/validate-lite-course-condition")).success((function(){n("#switch-lite-course").foundation("reveal","open")})).error((function(e){t.ui.disableLiteCourse=!0,n("#switch-lite-course").foundation("reveal","open")}))},t.switchToLiteCourse=function(e){r.put("/api/courses/".concat(e,"/switch-lite")).success(C).error((function(e){if(e.message)return f.warning(e.message)}))},t.switchToNormalCourse=function(e){r.put("/api/courses/".concat(e,"/switch-normal")).success(C).error((function(){}))},t.cancelPreview=()=>r.delete("/api/courses/".concat(h,"/preview")).success(C).error((function(){})),t.cancelInspect=function(){return C=function(e){return window.opener?l.close():l.location.href=e.refer||"/management/course#/"},r.delete("/api/courses/".concat(h,"/inspect")).success(C).error((function(){}))},t.displayTeacherPortfolio=function(e){e.portfolio_url&&l.open(e.portfolio_url,"_blank")},t.hasKlassInfo=function(){if(!e.course)return!1;var r=e.course,n=r.academic_year?r.academic_year.name:null,i=r.semester?r.semester:null,a=r.department?r.department.name:null,s=r.grade?r.grade.name:null,c=r.klass?r.klass.name:null,u=r.subject_code?"("+r.subject_code+")":null;return t.message=o.compact([n,i,a,s,c,u]).join(" "),Boolean(n||i||a||s||c||u)};var k=function(){var e,n=(e=i.mark((function e(){var n,a,s;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.get("/api/ding-talk/user-id");case 3:return n=e.sent,t.dingTalkUserInfo=n?n.data:{},e.next=7,r.get("/api/ding-talk/chat?course_id=".concat(h));case 7:a=e.sent,s=o.isEmpty(a.data)?[]:a.data.useridlist,t.enableEnterDingTalkChat=!!(s.length>0&&t.dingTalkUserInfo.dingtalk_user_id)&&!s.includes(t.dingTalkUserInfo.dingtalk_user_id),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0);case 15:return e.prev=15,t.showDingTalkChatButton=!0,e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,12,15,18]])})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function s(e){a(i,n,o,s,c,"next",e)}function c(e){a(i,n,o,s,c,"throw",e)}s(void 0)}))});return function(){return n.apply(this,arguments)}}();t.enterDingtalkChat=function(){t.enableEnterDingTalkChat&&r.put("/api/ding-talk/chat?course_id=".concat(h),{users_2_add:[t.dingTalkUserInfo.dingtalk_user_id]}).then((()=>{t.enableEnterDingTalkChat=!1}))},t.confirmSynchronize=function(){t.isSynchronizing=!0;t.shouldSync?t.shouldSync&&r.post("/api/blueprint-course/".concat(h,"/synchronize")).success((function(e){f.success(e.message),n("#synchronize-course-popup").foundation("reveal","close"),t.isSynchronizing=!1})).error((()=>{t.isSynchronizing=!1})):n("#synchronize-course-popup").foundation("reveal","close")},t.synchronizeCourse=function(){r.get("/api/blueprint-course/".concat(h,"/should-synchronize")).success((e=>{t.shouldSync=e.should_synchronize,t.isSynchronizing=!1,n("#synchronize-course-popup").foundation("reveal","open")})).error((()=>{}))},t.knew=function(){r.post("/api/course/".concat(h,"/record-user-reads"),{type:"course_score_percentage_update"}).success((()=>{y()}))},t.showSubCourseList=function(){n("#sub-course-list-popup").foundation("reveal","open")},t.showCourseImport=function(){0!==t.moodleImporterStatus&&(n("#moodle-course-import-popup").foundation("reveal","open"),t.isShowMoodleImportPopup=!0)},t.closeCourseImportPopup=function(){n("#moodle-course-import-popup").foundation("reveal","close"),t.isShowMoodleImportPopup=!1,t.isShowMoodleImportPopupFooter=!1},t.confirmTeachingMode=function(){r.post("/api/course/".concat(h,"/record-user-reads"),{type:"course_teaching_mode_update"})},t.publishCourse=function(){n("#course-publish-popup").hasClass("open")||n("#course-publish-popup").foundation("reveal","open")},t.confirmPublish=e=>{t.updateCoursePublishStatus(e),n("#course-publish-popup").foundation("reveal","close")},t.updateCoursePublishStatus=function(e){return m.updateCoursePublishStatus(e.id,!e.course_attributes.published,(function(){l.location.reload()}),(function(e){return f.error(e.errors.published[0])}))};var M=function(){return m.getCourseCanUnPublished(t.course.id,(function(e){t.courseCanUnpublished=e.can_unpublished}),(()=>{}))};p.initCourseInfo(h).then((function(r){var i,a;e.course=r,t.course=r,t.displayedName=r.display_name,_(),t.courseNeedPublish=null===(i=l.featureToggles)||void 0===i?void 0:i.courseNeedPublish;var s,c="True"===n("#enrollmentIsInstructor").val();t.courseNeedPublish&&c&&(M(),t.coursePublished=null===(s=r.course_attributes)||void 0===s?void 0:s.published),"SHTVU"===t.deliveryOrg&&p.initCourseTimeTable(t.course.id).then((function(e){p.setTimeTableProperty(t.course,e)})),["ZJU","ZUCC"].indexOf(t.deliveryOrg)>-1&&t.isSimulatingInstructor&&k();var u="checkpoint"===r.learning_mode?"True":"False";n("#is-course-in-checkpoint-mode").val(u),t.vueParam.courseCode=r.course_code,x(),r.instructorNames=o.map(r.instructors,"name").join(" / "),!t.isSimulatingInstructor&&t.allowCourseCatlogEdit&&null!==(a=window.globalData)&&void 0!==a&&a.isOpenUniversity&&w()}))}]},581986:function(e,t,r){var n=r(708468),o=r(904072);e.exports=["$rootScope","$scope","navSettingRepository","$timeout",function(e,t,r,i){var a;t.ui={inMateriaList:!1,showMateriaList:!1,inGroupList:!1,showGroupList:!1},t.courseNeedPublish=null===(a=window.featureToggles)||void 0===a?void 0:a.courseNeedPublish,t.hasMenu=e=>n.any(t.courseMenus,{type:e,disabled:!1}),t.showMaterialList=function(){return o(".course-menu-material .dropdown").focus(),t.ui.showMateriaList=!0},t.hideMaterialList=function(){if(!t.ui.inMateriaList)return t.ui.showMateriaList=!1},t.showGroupList=function(){return o(".course-menu-group .dropdown").focus(),t.ui.showGroupList=!0},t.hideGroupList=function(){if(!t.ui.inGroupList)return t.ui.showGroupList=!1},t.inviteUsers=()=>e.invitingCourseUsers=!0,t.findEnabledItemOfParent=function(e){return-1!==n.findIndex(t.courseMenus,{parent:e,disabled:!1,can_disabled:!0})};var s;return s=o("#courseId").val(),r.initNavSetting(s).then((function(r){return t.courseMenus=r.nav_setting,t.$emit("fetchCourseNavSetting",r),i((()=>e.$emit("initCourseMenuFinished")),300)}))}]},329362:function(e,t,r){var n=r(904072);r(115306);var o=r(180736);e.exports=["$rootScope","$scope","toastr","uploadService","$window",function(e,t,r,i,a){a.addEventListener("open-cover-selector",(()=>{n("#select-cover").foundation("reveal","open")}));var s=o(t),c=function(e){s.hide();var t=new CustomEvent("cover-upload",{detail:e});return window.dispatchEvent(t),n("#select-cover").foundation("reveal","close")};return t.onCoverSelect=function(n,o,a){if(e.isIE9CannotUploadFile())r.warning(e.isIE9CannotUploadFileMsg);else if(!(n.length<1))if(n.length>1)r.warning(t.errorText.singleFile);else{if(i.checkFiles(n,o,a))return s.show(),i.updateConfig("course_cover"),i.bindCallback(c,(function(){})),e.course_cover_upload=i.uploadFiles(n)[0];var u=i.humanizeBytes(o);r.warning(t.errorText.formatAndLimit.replace(/\{0\}/gi,u).replace(/\{1\}/gi,a))}}}]},108300:function(e,t,r){var n=r(708468),o=r(904072);r(788674),r(132023);var i=r(887757);function a(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}r(535666),e.exports=["$rootScope","$scope","revealModalParams","$http","$interval","$timeout","toastr","$window","$document",function(e,t,r,s,c,u,l,d,p){t.isTimeCollapsed=!0,t.isError=!1,t.inputCode=null;var f=null;t.countDown=60;e.urlPrefix="";var m=function(){return d.location.pathname.includes("/management/")},h=function(){var r,i={};(e.urlPrefix||(e.urlPrefix=m()?"management":"score"),"score"===e.urlPrefix)?(i.unique_id=null===(r=t.course)||void 0===r?void 0:r.id,i.unique_id_type="course"):(i.unique_id=n.parseInt(o("#userId").data("id")),i.unique_id_type="user");return i},v=function(){t.isTimeCollapsed=!t.isTimeCollapsed};t.sendCode=function(){v(),params=h(),s.post("/api/auth_code/get_auth_code",params).then((()=>{}),(function(e){return l.error(e.errors)})),f=c((()=>{--t.countDown}),1e3),u((()=>{c.cancel(f),t.countDown=60,v()}),6e4)},t.validateAndRedirect=function(r){var n=()=>{t.isError=!0};return r&&6===r.length||n(),params=h(),params.user_input_auth_code=r,s.post("/api/auth_code/validate_auth_code",params).then((function(){return t.isError=!1,o("#dingtalk-validate-popup").foundation("reveal","close"),"score"===e.urlPrefix?d.location.href="score":d.location.href="/management/"}),n)};var g=function(){return params=h(),s.get("/api/auth_code/auth_validate",{params:params}).then((function(t){e.dingtalkAuthValidate=t.data.dingtalk_auth_validate,e.dingtalkAuthValidate||!m()||o("#dingtalk-validate-popup").hasClass("open")||e.openValidatePopup("management")}))};t.enableDingtalkValidate&&m()&&!o("#dingtalk-validate-popup").hasClass("open")&&g(),p.on("close.fndtn.reveal","#dingtalk-validate-popup",(function(){!e.dingtalkAuthValidate&&m()&&(d.location.href="/user/index")})),e.openValidatePopup=function(){var t,r=(t=i.mark((function t(r){return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.urlPrefix=r,t.next=3,g();case 3:if(e.dingtalkAuthValidate){t.next=7;break}o("#dingtalk-validate-popup").foundation("reveal","open"),t.next=12;break;case 7:if("score"!==e.urlPrefix){t.next=11;break}return t.abrupt("return",d.location.href="score");case 11:return t.abrupt("return",d.location.href="/management/");case 12:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function s(e){a(i,n,o,s,c,"next",e)}function c(e){a(i,n,o,s,c,"throw",e)}s(void 0)}))});return function(e){return r.apply(this,arguments)}}()}]},66129:function(e,t,r){var n=r(904072),o=r(693604);e.exports=["$rootScope","$scope",function(e,t){var r=n("#embed-video-popup");init=function(){t.orginalUrl="",t.embedUrl="",t.errors={}},t.checkUrl=function(){o.isSupportedOnlineVideoLink(t.orginalUrl)?t.errors={}:t.errors.orginalUrl=!0};t.save=function(){var e;t.checkUrl(),o.isSupportedOnlineVideoLink(t.orginalUrl)&&(t.embedUrl=o.parseOnlineVideoUrl(t.orginalUrl),e={url:t.embedUrl},r.trigger("urlEntered",e),t.close())},t.close=function(){r.foundation("reveal","close")},init()}]},211376:function(e,t,r){var n=r(904072);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r(66992),r(864765),r(454747),r(333948);var s=r(180736);e.exports=["$rootScope","$scope","$http",function(e,t,r){var o=s(t);t.close=()=>{n("#entries-select").foundation("reveal","close")},t.searching=!1,t.isSelectAll=!1,t.keyword="",t.save=()=>{e.$broadcast("selectEntry"),t.close()};var a=r=>{var n=r.data.result,a=n.entries.map((e=>{var t,r,n=e.keywords?e.keywords.map((e=>e.name)).join(" ; "):"";return i(i({},e),{},{keywordsStr:n,fileCount:null!==(t=null===(r=e.uploads)||void 0===r?void 0:r.length)&&void 0!==t?t:0,selected:!1})}));t.pagination={currentList:a,currentPage:n.page,totalPage:n.pages,inputPage:n.page},e.entries=t.pagination.currentList,o.hide()};t.openEntryPopup=()=>{e.$broadcast("openEntryContentPopup")};var c="id,org_id,name,created_at,updated_at,created_by_id,updated_by_id,keywords(name),uploads(id)",u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{reverse:!0},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c;return o.show(!0),r.get("/api/entries",{params:{fields:n,page:t,conditions:e}}).then(a)};t.search=()=>{u({keyword:t.keyword,reverse:!0})},t.selectAll=()=>{t.isSelectAll?t.pagination.currentList.forEach((e=>{e.selected=!0})):t.pagination.currentList.forEach((e=>{e.selected=!1}))},t.changeEntrySelectStatus=()=>{var e=t.pagination.currentList.every((e=>e.selected));t.isSelectAll=e},t.changePage=e=>{o.show(!0),u({keyword:t.keywords,reverse:!0},e)},t.$on("reloadEntriesList",(()=>{u().then((()=>{t.pagination.currentList[0].selected=!0}))})),u()}]},389465:function(e,t,r){var n=r(293789),o=r(708468),i=r(904072),a=r(895523);e.exports=["$rootScope","$scope","$http","$timeout",function(e,t,r,s){var c;t.statChart=null,e.$on("openHypothesisStat",(function(e,r,n){return t.activity=n,t.upload=r,c()}));var u=function(){t.ui.noStatData=!0},l=function(){var e={uri:"urn:tronclass:upload:".concat(t.pdfFileKey),source:"course",sort:"created",group:"__world__",course_id:i("#courseId").val(),enrollment_role:"student",token:t.noteBeneToken},c="".concat(t.noteBeneUrl,"/api/statistic");return r.get(c,{params:e}).success((function(e){var r=n.range(1,t.numPages,!0);return t.statSeries=o.map(r,(t=>n.guard(o.find(e.positions,{position:"".concat(t)}),(e=>e.count))||0)),((e,r)=>s((()=>t.statChart=a.drawLineChart(e,r,t.chartMessage))))(r,{statSeries:t.statSeries})})).error(u)};return c=function(){return t.statChart&&a.clearChart(t.statChart),t.ui={noStatData:!1},t.numPages=null,t.pdfFileKey=null,t.statSeries=[],e="/api/uploads/reference/document/".concat(t.upload.reference_id,"/pdf-info-for-stat?preview=true"),void r.get(e).success((function(e){return t.numPages=parseInt(e.num_pages||0),t.statSeries=o.range(0,t.numPages,0),t.pdfFileKey=e.file_key,l()})).error(u);var e}}]},86434:function(e,t,r){var n=r(904072),o=r(708468);r(747042),r(132023),r(115306),r(323123);var i=r(881063),a=r(693604);r(9075);e.exports=["$rootScope","$scope","$http","toastr","$sce","$timeout","$window","statHelper","scormUtils",function(e,t,r,s,c,u,l,d,p){var f,m,h,v;a.fixMultiModalOverlay("#file-previewer"),a.fixMultiModalOverlay("#file-previewer-with-note"),t.fileExtension=a.fileExtension,t.trustAsResourceUrl=c.trustAsResourceUrl,t.ui={urlLoaded:!1,fullScreen:!1,ytplayer:null,checkTimerId:null,videoStartFrom:0,loggerOffline:!1,showQuestionPanel:!1,showQuestionPanelBtn:!1,commentsCount:0},t.courseId=null===(f=window.globalData)||void 0===f||null===(m=f.course)||void 0===m?void 0:m.id,t.isSimulatingInstructor=(null===(h=window.globalData)||void 0===h||null===(v=h.course)||void 0===v?void 0:v.isSimulatingInstructor)||!1;var g=0,y=0,w=1,b=0,_=function(){w=1,b=0,g=0,y=0};t.clearActivity=function(){delete t.activity};var S=function(){var e="scale(".concat(w,") rotate(").concat(b,"deg)");return{"-webkit-transform":e,"-moz-transform":e,"-ms-transform":e,"-o-transform":e,transform:e,margin:"".concat(y,"px 0 0 ").concat(g,"px")}};t.hasFlashPlayer=!0,t.isWebkitBrowser=/webkit/i.test(navigator.userAgent),t.isFirefoxBrowser=/firefox/i.test(navigator.userAgent);var x=["doc","docx","xls","xlsx","ppt","pptx","uof","uot","uos","uop","ofd"];t.viewMode={mode:"normal",enablePreviewMode:function(e){var r,n=e&&(null===(r=window.featureToggles)||void 0===r?void 0:r.yz_office_preview)&&"document"==e.type&&x.includes(a.fileExtension(e.name||e.file_name||"",!0));return n||(t.viewMode.mode="normal"),n}};var C=t.isVisitor?"anonymous-api":"api",k=function(){if(t.ui.showQuestionPanelBtn=!1,t.activity&&"material"===t.activity.type){var e,n,o=a.fileExtension(t.upload.name);if(["doc","docx","ppt","pptx","xls","xlsx","pdf"].includes(o))t.ui.showQuestionPanelBtn=!0,t.isVisitor||(e=t.activity.id,n={referrer_id:t.upload.reference_id,referrer_type:"upload_reference",type:"question"},r.get("/api/activities/".concat(e,"/comment/count?conditions=").concat(JSON.stringify(n))).success((e=>{t.ui.commentsCount=e.question||0})).error(s.decorateError()));else t.ui.showQuestionPanel=!1}},M=function(){return t.ui.urlLoaded=!0,k(),u((()=>I()))};t.uploadCanAddNote=function(e){if(e)return["image","video"].includes(e.type)||"document"===e.type&&!e.isTextFile};var T=function(e){var n;if(n=t.canGuestPreview&&t.isVisitor&&(null!=t.activity?t.activity.id:void 0)?"/anonymous-api/".concat(t.activity.id,"/uploads/").concat(e.id,"/text?preview=true"):"/api/uploads/".concat(e.id,"/text?preview=true"),!e.textContent)return r.get(n).success((t=>e.textContent=t)).error(s.decorateError())},E=null;n(document).on("closed.fndtn.reveal",(()=>{"function"==typeof E&&E(),$=!1,t.ui.showQuestionPanel=!1,t.focusInputCount=0}));var P=function(){t.isOrgArrears=!1;var c=t.upload;!function(){var e=t.upload;if(e){t.uploadStatus=a.setUploadFeature(e);var r="material";t.activity&&"tencent_meeting"===t.activity.type&&(r="tencent_meeting"),E=()=>statistics.track({activity_type:r,activity_id:null!=t.activity?t.activity.id:void 0,sub_type:e.name.includes(".")?e.name.split(".").pop():e.name,sub_id:e.id,action:statistics.enums.CourseWareAction.close,mode:statistics.enums.Mode.normal,channel:statistics.enums.Channel.web}),statistics.track({activity_type:r,activity_id:null!=t.activity?t.activity.id:void 0,sub_type:e.name.includes(".")?e.name.split(".").pop():e.name,sub_id:e.id,action:statistics.enums.CourseWareAction.open,mode:statistics.enums.Mode.normal,channel:statistics.enums.Channel.web})}}(),_();var l=function(){return t.swfLoaded=function(){t.ui.swfLoading=!1,n("#swf-object param").length<=0&&(t.hasFlashPlayer=!1)},t.ui.swfLoading=!0,M()},d=function(e){var n=f(e);return r.get(n).success((function(r){if(M(),e.status=r.status,"ready"===r.status&&r.scorm.data){var n=r.scorm.id,o=p.bindResourcesBaseLocation(r.scorm.data.manifest);return t.scormManifest=r.scorm.data.manifest,t.resourceId?p.bindItemResources(o,n,t.scormManifest.organizations.organization.item,t.scormManifest.resources.resource,C,t.resourceId):p.bindItemResources(o,n,t.scormManifest.organizations.organization.item,t.scormManifest.resources.resource),u((()=>t.viewScorm(p.getFirstScoItem(t.scormManifest.organizations.organization.item))))}return t.error={status_code:r.scorm.status_code,message:r.scorm.message}})).error(s.decorateError((function(){})))},f=function(e){return t.canGuestPreview&&t.isVisitor&&(null!=t.activity?t.activity.id:void 0)?"/anonymous-api/".concat(t.activity.id,"/uploads/").concat(e.id,"?preview=true"):t.resourceId?"/".concat(C,"/shared-resources/").concat(t.resourceId,"/uploads"):"/api/uploads/".concat(e.id,"?preview=true")};if(c.third_part_referrer_id&&!c.source)return function(e){var n=f(e);return"video"===e.type?(e.video_urls={},r.get(n).success((function(t){M(),e.status=t.status,e.video_urls=t.video_urls})).error(s.decorateError((function(){})))):"audio"===e.type?r.get(n).success((function(r){M(),e.status=r.status,t.audioUrl=r.audio_url})).error(s.decorateError((function(){}))):"swf"===e.type?l():"document"===e.type?r.get(n).success((function(t){M(),e.status=t.status,e.downloadUrl=t.document_url;var r=encodeURIComponent(t.document_url);if(e.documentUrl="".concat(pdfViewer,"?file=").concat(r,"&upload_id=").concat(e.id),"txt"===a.fileExtension(e.name,!0))return e.isTextFile=!0,T(e)})):"scorm"===e.type?d(e):M()}(c);if("SHTVU"===c.source)return function(e){var r,n;t.isOrgArrears=!1,t.ui.urlLoaded=!0,"video"===e.type?(e.video_urls={QVGA:e.url+"/360p.mp4",VGA:e.url+"/480p.mp4",HD:e.url+"/720p.mp4"},e.video_src_type="video/mp4"):"audio"===e.type?t.audioUrl=e.url+"/file.mp3":"document"===e.type?e.documentUrl=e.url+"/"+(r=e.url,(n=(n=r.split("/"))[n.length-1].split("."))[0].replace("a@","")+".PDF"):"image"===e.type&&(e.imageUrl=e.url+"/preview.jpg")}(c);var m,h,v=function(p){t.isOrgArrears=p.is_org_transfer_arrears,t.isOrgArrears?t.ui.urlLoaded=!0:"video"===c.type?function(e){var n=f(e);e.video_urls=void 0,r.get(n).success((function(r){M(),e.status=r.status,e.videos=r.videos,e.video_src_type=r.video_src_type,e.orgCode=r.orgCode,t.resourceId?e.video_urls=i.getUrls(e,C,t.resourceId):e.video_urls=i.getUrls(e,C)})).error(s.decorateError((function(e){})))}(c):"audio"===c.type?function(e){var n=f(e);delete t.audioUrl,r.get(n).success((function(r){M(),e.status=r.status,r.audio&&r.audio.id&&(t.canGuestPreview&&t.isVisitor&&(null!=t.activity?t.activity.id:void 0)?t.audioUrl="/anonymous-api/".concat(t.activity.id,"/uploads/audio/").concat(r.audio.id,"?preview=true"):t.resourceId?t.audioUrl="/".concat(C,"/shared-resources/").concat(t.resourceId,"/audios"):t.audioUrl="/api/uploads/audio/".concat(r.audio.id,"?preview=true"))})).error(s.decorateError((function(e){})))}(c):"swf"===c.type?l():"document"===c.type?function(e){var n,o,i;e.reference_id?(o="/reference",n=e.reference_id):(o="",n=e.id);var c=a.wpsPreview(e);i=t.canGuestPreview&&t.isVisitor&&(null!=t.activity?t.activity.id:void 0)?"/anonymous-api/".concat(t.activity.id,"/uploads").concat(o,"/document/").concat(n,"/url?preview=true"):c?"/api/uploads/".concat(e.id,"/preview/wps?preview=true"):t.resourceId?"/".concat(C,"/shared-resources/").concat(t.resourceId,"/documents"):"/api/uploads".concat(o,"/document/").concat(n,"/url?preview=true"),r.get(i).success((function(r){var n;if(M(),c){var o=r.preview_url;e.documentUrl=o}else{e.status=r.status,e.downloadUrl=r.url;var i=encodeURIComponent(r.url);if(n=t.canGuestPreview&&t.isVisitor&&(null!=t.activity?t.activity.id:void 0)?"/anonymous-api/".concat(t.activity.id,"/uploads/pdf-viewer"):t.resourceId?"/".concat(C,"/shared-resources/").concat(t.resourceId,"/pdf-viewer"):"/note-bene/pdf-viewer",e.documentUrl="".concat(n,"?file=").concat(i,"&upload_id=").concat(e.id,"&is_attachment_view=").concat(t.isAttachment),"txt"===a.fileExtension(e.name,!0))return e.isTextFile=!0,T(e)}})).error(s.decorateError((function(e){})))}(c):"scorm"===c.type?d(c):"evercam"===c.type?function(e){var o,i=f();r.get(i).success((function(r){return M(),e.status=r.status,"ready"===r.status&&"evercam"===r.type?(o=t.resourceId?"/".concat(C,"/shared-resources/").concat(t.resourceId,"/evercams"):"/api/uploads/embed-material/".concat(e.id),u((()=>{n(".file-previewer #".concat(e.type,"-viewer")).attr("src",o)}))):t.error={status_code:r.status_code||r.status,message:r.message}})).error(s.decorateError((function(){})))}(c):"lesson-resource"===c.type?function(n){var i=n.id;U({width:"100%",height:"calc(100%-50px)"},!1);var a=e.fromPage||"";r.get("/api/resource-file/".concat(i,"/player-url?from_page=").concat(a)).success((function(r){o.include(r.url,"?")?t.lesson_resource_url="".concat(r.url,"&lang=").concat(e.langForTca):t.lesson_resource_url="".concat(r.url,"?lang=").concat(e.langForTca)})).error((e=>s.error(e.message)))}(c):"link"===c.type&&"youtube"===c.link.type?M():function(e){var t=f(e);r.get(t).success((function(t){M(),e.status=t.status})).error(s.decorateError((function(e){})))}(c)};return"video-quiz"===t.previewType(c.type)?(t.videoQuizId=c.id,m=t.videoQuizId,h=v,r.get("/api/video-quizzes/org/arrears/".concat(m,"?no-intercept=true")).success(h).error(s.decorateError())):"lesson-resource"===t.previewType(c.type)?((e,t)=>r.get("/api/resource-file/org/arrears/".concat(e,"?no-intercept=true")).success(t).error(s.decorateError()))(c.id,v):c.id?((e,t)=>r.get("/".concat(C,"/uploads/org/arrears/").concat(e,"?no-intercept=true")).success(t).error(s.decorateError()))(c.id,v):(t.isOrgArrears=!1,t.ui.urlLoaded=!0,c.videos=[c],void(c.video_urls={ORIGINAL:c.video_url+"?preview=true"}))};t.enterHTML5FullScreen=function(e){return e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():void 0};var A=()=>t.isFirefoxBrowser||t.isWebkitBrowser,F=()=>{var e=n(".img-container"),t=n(".img-container > img");if(e.length&&t.length){var r=e.slice(-1)[0].getBoundingClientRect(),o=t.slice(-1)[0].getBoundingClientRect();g=Math.max(Math.ceil(o.width-r.width),0),y=Math.max(Math.ceil(o.height-r.height)/2,0),t.css(S()),A()&&t.hide().show(0)}};t.zoomOut=function(e){e=e||n(".img-container > img"),w=Math.max(w-.2,.2),e.css(S()),A()&&e.hide().show(0),F()},t.reset=function(){return t.uploads&&t.uploads.length>0&&n(document).off("keydown"),delete t.upload},t.zoomIn=function(e){e=e||n(".img-container > img"),w=Math.min(w+.2,5),e.css(S()),A()&&e.hide().show(0),F()},t.rotateImg=function(e){e=e||n(".img-container > img"),b=Math.floor((b-90)%360),e.css(S()),A()&&e.hide().show(0),F()},t.restoreImg=function(e){e=e||n(".img-container > img"),_(),e.css(S()),A()&&e.hide().show(0)},t.enterFullScreen=function(e){return t.ui.fullScreen=!0,e=e||"#file-previewer .reader-wrapper .reader-wrapper",t.enterHTML5FullScreen(n(e).get(0))},t.exitFullScreen=function(){return document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),t.ui.fullScreen=!1},t.viewScorm=function(e){n(".file-previewer #scorm-viewer").attr("src",e.scormUrl)};var I=function(){var e=function(){if(!(document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen||document.msFullScreenElement))return t.ui.fullScreen=!1,t.$apply()};if(document.addEventListener)return document.addEventListener("webkitfullscreenchange",e,!1),document.addEventListener("mozfullscreenchange",e,!1),document.addEventListener("fullscreenchange",e,!1),document.addEventListener("MSFullscreenChange",e,!1)};e.$on("previewFile",(function(r,o,i){(t.fileAddNote||1!==n("#file-previewer-with-note").length)&&(t.upload=o,t.activity=i,t.lesson_resource_url=null,delete t.uploads,P(),e.$broadcast("pdfEditor:loading",!1))})),window.parent.postMessage("previewFileReady","*"),e.$on("previewResourceReference",(function(e,r){if(t.fileAddNote||1!==n("#file-previewer-with-note").length)return t.upload=r.upload,t.lesson_resource_url=null,t.resource=r,delete t.uploads,P()})),e.$on("previewFiles",(function(e,r,i,a){var s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(!s==!t.fileAddNote){t.isAttachment=l,t.activity=a,o.remove(r,(e=>"source_file"===e.parent_type)),t.uploads=r,t.canGuestPreview=c,t.forceShowDownloadButton=u;var d=0;null!=i.id?d=o.findIndex(t.uploads,(e=>e.id===i.id)):null!=i.url&&(d=o.findIndex(t.uploads,(e=>e.url===i.url))),t.changeFile(d);var p=37,f=39;return n(document).keydown((function(e){if(!(t.focusInputCount>0))switch(e.which){case p:return t.changeFile(t.currentFileIndex-1);case f:return t.changeFile(t.currentFileIndex+1)}}))}})),t.currentFileIndex=0;var $=!1;t.changeFile=function(r){r<0?r=t.uploads.length-1:r>t.uploads.length-1&&(r=0),t.uploads[r].deleted||(t.currentFileIndex=r,t.upload=t.uploads[r],P(),t.$broadcast("previewFile",t.upload,t.activity)),$&&e.$emit("changeFile",t.upload,t.activity),$=!0},t.$watch("ui.fullScreen",(function(e){var t=n("body > .wrapper > .footer");return e?t.hide():t.show()})),t.previewType=function(e){return["lesson-resource","video-quiz"].includes(e)?e:"file"},l.onmessage=e=>R(e);var R=function(e){if("adjustPlayerSize"===e.data.name)return U(e.data.args,!0),t.$apply()},U=function(e,r){t.iframeStyle=t.iframeStyle||{};var o=r?B(t.iframeStyle.width,e.width):e.width,i=r?B(t.iframeStyle.height,e.height):e.height;return n("#file-previewer .popup-content").css({"min-height":0}),n(".pdf-reader-detail .content").css({height:i,"min-height":0}),t.iframeStyle={width:o,height:i,border:"none","min-width":900}},B=function(e,t){var r;return 0<(r=Math.abs(e-t))&&r<=4?e:t};t.retry=function(e){a.retryTranscode(r,s,l,e)},t.downloadBlob=function(e,t){if(!t.deleted)return e?d.track(e.type,"download",{activity_id:e.id,upload_id:t.id,file_name:t.name,upload_reference_id:t.reference_id}):void 0},t.showQuestionPanel=function(){t.ui.showQuestionPanel=!0,window.dispatchEvent(new CustomEvent("open-question-submit-panel"))},t.focusInputCount=0,l.addEventListener("comment-question-emit-event",(e=>{var r;switch(e.detail.event){case"count-change":return t.ui.commentsCount=null===(r=e.detail.data)||void 0===r?void 0:r.count,void t.$apply();case"close":return t.ui.showQuestionPanel=!1,void t.$apply();case"focus":return void t.focusInputCount++;case"blur":return void t.focusInputCount--;default:return void(t.allowChangeFile=0)}}))}]},3196:function(e,t,r){var n=r(904072);e.exports=["$rootScope","$scope","$timeout","$window",function(e,t,r,o){var i;t.isShowingNoteBox=!1,t.ui.showQuestionPanel=!1,e.hasEdited=!1,t.courseId=null===(i=window.globalData)||void 0===i?void 0:i.course.id,t.enterFullScreen=function(e){return t.hideNoteBoxWithoutAnimate(),t.ui.fullScreen=!0,"#file-previewer-with-note .reader-wrapper",t.enterHTML5FullScreen(n("#file-previewer-with-note .reader-wrapper").get(0))},t.showNoteBox=function(){if(t.canAddNote()&&!t.isShowingNoteBox){t.ui.showQuestionPanel=!1,t.isShowingNoteBox=!0;var e=n("#file-previewer-with-note .content").width();console.log(e),n("#file-previewer-with-note .file-previewer").animate({width:e-290},500),n(".file-preview-note-box").css("z-index",1)}},o.addEventListener("open-question-submit-panel",(()=>{console.log("open panel"),t.hideNoteBox(),t.ui.showQuestionPanel=!0})),t.hideNoteBox=function(){if(t.isShowingNoteBox){var e=n("#file-previewer-with-note .file-previewer");e.animate({width:e.width()+290},500),n(".file-preview-note-box").css("z-index",-1),r((function(){return t.isShowingNoteBox=!1,500}))}},t.hideNoteBoxWithoutAnimate=function(){if(t.isShowingNoteBox)return n("#file-previewer-with-note .file-previewer").width("100%"),t.isShowingNoteBox=!1},n(document).on("close.fndtn.reveal","#file-previewer-with-note",(function(){return t.hideNoteBox(),e.$broadcast("noteEdited",e.hasEdited),e.hasEdited=!1})),t.playerInitiated=e=>t.player=e;return t.canAddNote=function(){if("image"===t.upload.type)return!0;if("document"===t.upload.type&&"ready"===t.upload.status){var e=n("#file-previewer-with-note #pdf-viewer");return Boolean(e&&e[0]&&e[0].contentWindow&&e[0].contentWindow.PDFViewerApplication&&e[0].contentWindow.PDFViewerApplication.pdfViewer&&e[0].contentWindow.PDFViewerApplication.pdfViewer.onePageRendered)}return Boolean("video"===t.upload.type&&"ready"===t.upload.status&&t.player&&0!==("function"==typeof(r=t.player).readyState?r.readyState():r.readyState));var r}}]},273085:function(e,t,r){var n=r(904072),o=r(708468),i=r(361204);r(132023),r(864765),r(454747);var a=r(887757);function s(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){s(i,n,o,a,c,"next",e)}function c(e){s(i,n,o,a,c,"throw",e)}a(void 0)}))}}function u(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r(535666);var d=r(693604),p=r(180736);e.exports=["$rootScope","$scope","$timeout","fileSelectModel","uploadService","toastr","blobstorage","$window",function(e,t,r,s,l,f,m,h){var v="True"===n("#enrollmentIsStudent").val(),g=p(t),y=[],w={OnlineVideo:"video,audio",Material:"video,audio,image,document,swf,file",Interaction:"video",Homework:"video,audio,image,document,swf,file",online_video:"video,audio",interaction:"video",material:"video,audio,image,document,swf,file",homework:"video,audio,image,document,swf,file"},b=function(){var e,t=u(y);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(1!==s.pagination.currentPage)break;r.progress<99&&("all"===s.fileType||s.identifyFileType(r)===s.fileType)&&s.pagination.currentList.push(r)}}catch(e){t.e(e)}finally{t.f()}return g.hide()},_=function(){return s.filterFileTypes=w[e.activityType],s.courseCode=e.courseCode};t.changeFileType=function(e){return g.show(!0),_(),s.changeFileType(e,b)},t.changePage=function(e){return g.show(!0),_(),s.changePage(e,b)},t.search=function(){return g.show(!0),_(),s.search(b)},t.deleteUploadingUpload=function(e){return s.removeUpload(e),o.remove(y,(t=>t.id===e.id)),o.remove(s.selectedUploads,(t=>t.id===e.id)),l.deleteUploadingUpload(e)};var S=function(){if(s.limitTypes.length>0){var e,t=[],r=u(s.limitTypes);try{for(r.s();!(e=r.n()).done;){var n=e.value;t=t.concat(s.supportFormat[n])}}catch(e){r.e(e)}finally{r.f()}return t}return v?s.getLimitUploadedFileAllowList():d.getSupportedFormats()};t.openClient=function(){m.getOpenClientURL().then((function(e){if(e)return h.open(e)}))},t.isShowLarkSpace=()=>{var r,n=null===(r=e.activityType)||void 0===r?void 0:r.toLowerCase(),o="material"===n||"homework"===n&&!t.isInstructorView;return Boolean(s.showLarkSpace&&!s.limitTypes.includes("image")&&!s.limitTypes.includes("audio")&&o)},t.isShowWeDriveSpace=()=>{var t;return"material"===(null===(t=e.activityType)||void 0===t?void 0:t.toLowerCase())},t.onFileSelect=function(){var r=c(a.mark((function r(n,i){var c,u,d,p,m,h,v,g,w,b;return a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(0!==n.length){r.next=2;break}return r.abrupt("return");case 2:if(t.error=!1,c=S(),u=[],t.isFileExtensionCheckEnable?(u=l.filterByFileFormat(n,c)).length!==n.length&&(f.error(t.uploadFileFormatLimitErrorMessage),t.error=!0):u=l.filterByFileFormat(n),(d=l.filterByFileSize(u,i)).length!==u.length&&(t.error||((p=l.filterByFileSizeZero(u)).length>0&&1==u.length?f.error(t.uploadZeroSizeFileErrorMessage):p.length>0&&u.length>1?f.error("".concat(t.uploadSizeLimitErrorMessage,", ").concat(t.uploadZeroSizeFileErrorMessage)):f.error(t.uploadSizeLimitErrorMessage)),t.error=!0),0!==d.length){r.next=10;break}return r.abrupt("return");case 10:return m=function(t){return t.selectable=!0,s.singleSelect?s.singleSelectedUpload=t:(t.selected=!0,o.find(s.selectedUploads,(e=>e.id===t.id&&e.isThirdPartResource===t.isThirdPartResource))||s.selectedUploads.push(t)),window.st.track("personal_resource","upload",{},{upload_id:t.id,file_name:t.name,upload_type:e.fileTypeByExtension(t)}),e.$broadcast("fileUploadSuccess",t),e.$broadcast("refreshStorageBar")},h=function(e){if(e.message)return f.error(e.message)},v="scorm"===s.fileType,g="wmpkg"===s.fileType,w=["evercam"].includes(s.fileType)?s.fileType:"",l.updateConfig(null,v,g,w),l.bindCallback(m,h),s.tab="repository",r.next=20,x();case 20:return b=l.uploadFiles(d),s.addUploads(b),y=y.concat(b),r.abrupt("return",s.mode="list");case 24:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}();var x=function(){var r=c(a.mark((function r(){return a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("JLU"===t.deliveryOrg&&void 0!==e.course){r.next=2;break}return r.abrupt("return");case 2:return s.path=[],r.next=5,l.getUserCourseResourceFolder(e.course.id);case 5:courseFolder=r.sent,s.changePath(courseFolder,b),l.config.parentId=courseFolder.id;case 8:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),C=function(e){return s.limitTypes="all"===e.fileType?[]:[e.fileType],s.singleSelect=e.singleSelect,s.filters=e.filters,s.searching=!1,e.includeSlides&&(s.context.includeSlides=e.includeSlides),s.keyword=""};t.save=function(r){s.copySelectedThirdPartResources((function(r){var a,s,c,u;return a=r,s=o.each(i.copy(a),(function(e){delete e.audit_status})),c=e.fileSelectScopeId?"filesSelected"+e.fileSelectScopeId:"filesSelected",u=new CustomEvent("filesSelected",{detail:s}),window.dispatchEvent(u),e.$broadcast(c,s),function(e){e.forEach((e=>{e.sizeStr=t.humanizeBytes(e.size)}));var r={originalFiles:e,files:o.collect(e,(e=>({id:e.id,created_at:e.created_at,name:e.name,key:e.key,sizeStr:e.sizeStr})))};return n("#file-select, #scorm-file-select").trigger("filesSelected",r)}(r)})),s.clearSelected(),t.closePopup(r)},e.$on("reset-file-select",(()=>s.clearSelected())),t.changeTab=function(e){if(s.tab=e,"local"!==e)return t.changeFileType(s.fileType)},t.isOnlyLimitedFileType=e=>o.isEqual(s.limitTypes,[e]),t.isAllowedFileType=function(e){return"academic_learning_platform"!==s.tab&&(("third_part_resource"!==s.tab||!["slide","video-quiz","subject-lib","open-office","lesson-resource"].includes(e))&&("slide"===e?s.context.includeSlides:"subject-lib"===e?s.context.includeSubjectLibs:"video-quiz"===e?s.context.includeVideoQuizzes:"lesson-resource"===e?s.context.includeLessonResources:!("all"!==e||!s.context.lesson_resource_only)||(0===s.limitTypes.length||("all"===e?s.limitTypes.length>1:s.limitTypes.includes(e)))))},t.selectedCount=function(){var e=o.countBy(s.selectedUploads,{type:"folder"});return[e[!0]||0,e[!1]||0]};var k=function(){return t.error&&delete t.error,s.clearSelected()};n(document).on("close.fndtn.reveal","#file-select",(()=>{k(),s.context={}})),t.checkAllSelected=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.pagination.currentList;return 0!==e.length&&(s.isSelectAll=o.all(o.reject(e,{type:"folder"}),{selected:!0}),s.isSelectAll)},t.switchAll=function(){var e=o.filter(s.pagination.currentList,(e=>!e.failed));return(()=>{var r,n=[],o=u(e);try{for(o.s();!(r=o.n()).done;){var i=r.value;"folder"!==i.type&&i.selected!=s.isSelectAll&&(i.selected=s.isSelectAll,n.push(t.toggleUploadClick(i)))}}catch(e){o.e(e)}finally{o.f()}return n})()},t.enterFolder=function(e){if(e.is_folder)return g.show(!0),s.changePath(e,b),k()},t.toggleUploadClick=function(e){return s.singleSelect?s.singleSelectedUpload=e:e.selected?s.selectedUploads.includes(e)?void 0:s.selectedUploads.push(e):"SHTVU"===e.source?o.remove(s.selectedUploads,{url:e.url}):"LARK"===e.source?o.remove(s.selectedUploads,{token:e.token,source:"LARK"}):o.remove(s.selectedUploads,{id:e.id,isThirdPartResource:e.isThirdPartResource})},t.gotoPrev=function(){return s.path.length>=2?(g.show(!0),s.path.pop(),s.changePath(s.path.pop(),b)):s.context.lesson_resource_only?t.changeFileType("lesson-resource"):t.changeFileType("all")};var M=function(){return n("#file-select, #scorm-file-select").on("limitFileType",(function(e,n){return C({fileType:n,singleSelect:"scorm"===n,filters:[]}),r((()=>t.$apply()))})),n("#file-select, #scorm-file-select").on("preCheckFiles",((e,r)=>t.preCheckFiles=r))};t.$watch("twOrg",(()=>t.hasReadIPR=!t.twOrg)),t.readIPR=()=>t.hasReadIPR=!0,t.closePopup=e=>{d.closePopup(e||"file-select")};var T=()=>n(document).on("closed.fndtn.reveal","#file-select, #scorm-file-select",(function(e){if("upload_hint_popup"!==e.target.id)return C({fileType:"all",singleSelect:!1,filters:[],includeSlides:!1}),s.resetPagination()}));t.model=s,w.hasOwnProperty(e.activityType)&&(t.model.showAcademicLearningPlatformTab=!0),t.model.setLimitUploadedFiles(),t.preCheckFiles=null,t.humanizeBytes=l.humanizeBytes,t.isUploading=()=>l.isUploading(),t.hasReadIPR=!0,s.isSelectAll=!1,M(),T(),t.$watch("model.pagination.currentList",(function(e){if(t.preCheckFiles&&e.length>0)return o.each(e,(function(e){return e.selected=t.preCheckFiles.includes(e.id),!0})),t.preCheckFiles=null})),t.ui&&"other"===t.ui.videoType?(s.tab="other_video_resources",s.singleSelect=!0):e.$broadcast("refreshStorageBar"),t.changeFileType(s.getDefaultFileType())}]},97592:function(e,t,r){var n=r(904072),o=r(708468),i=r(361204),a=r(693604);e.exports=["$rootScope","$scope","uploadService","toastr","blobstorage","$window",function(e,t,r,s,c,u){var l="True"===n("#enrollmentIsStudent").val();e.uploaded=[],e.notUploading=()=>o.all(e.uploads,(e=>e.finished||e.failed)),t.humanizeBytes=r.humanizeBytes,t.deleteUploadingUpload=e=>r.deleteUploadingUpload(e),t.delete=function(t){return o.remove(e.uploaded,t),o.remove(e.uploads,t)},t.deleteFailedUpload=function(e){return r.deleteUpload(e,(()=>t.userFreeSpace+=e.size))};var d=function(){return i.isFunction(t.getParentId)?t.getParentId():0};return t.openClient=function(){var e=d();c.getOpenClientURL(e).then((function(e){if(e)return u.open(e)}))},t.onFileSelect=function(n,o,i,c){if(e.isIE9CannotUploadFile())s.warning(e.isIE9CannotUploadFileMsg);else{t.error=!1;var u=[],p=[];p=l?model.getLimitUploadedFileAllowList():a.getSupportedFormats(),t.isFileExtensionCheckEnable?(u=r.filterByFileFormat(n,p)).length!==n.length&&(s.error(t.uploadFileFormatLimitErrorMessage),t.error=!0):u=r.filterByFileFormat(n);var f=r.filterByFileSize(u,o);if(f.length!==u.length){if(!t.error){var m=r.filterByFileSizeZero(u);m.length>0&&1==u.length?s.error(t.uploadZeroSizeFileErrorMessage):m.length>0&&u.length>1?s.error("".concat(t.uploadSizeLimitErrorMessage,", ").concat(t.uploadZeroSizeFileErrorMessage)):s.error(t.uploadSizeLimitErrorMessage)}t.error=!0}if(0!==f.length){var h=!(!e.ui||!e.ui.isScorm)&&e.ui.isScorm,v=!(!e.ui||!e.ui.isWmpkg)&&e.ui.isWmpkg,g=e.ui&&e.ui.embedMaterialType?e.ui.embedMaterialType:"",y=d();return r.updateConfig(i,h,v,g,y),r.bindCallback((function(t){return e.uploaded.push(t),e.$broadcast("fileUploaded",t,c),window.st.track("personal_resource","upload",{},{upload_id:t.id,file_name:t.name,upload_type:e.fileTypeByExtension(t)}),e.$broadcast("refreshStorageBar")}),(function(e){if(e.message)return s.error(e.message)})),r.uploadFiles(f)}}},n("div.dropzone").click((function(){return n('input[name="fileSelector"]').click()}))}]},970811:function(e,t,r){var n=r(904072);r(682772),e.exports=["$rootScope","$scope","uploadService","$window","toastr",function(e,t,r,o,i){n("#formula-editor-frame").attr("src","/static/kityformula/kity_formula_editor.html");t.closePopup=()=>n("#formula-editor-popup").foundation("reveal","close"),t.save=function(){var e=n("#formula-editor-frame")[0].contentWindow.kfe;return e.execCommand("get.image.data",(function(r){var o=e.execCommand("get.source");o.indexOf("placeholder ")>0?i.error(t.i18nMessages.latexEmptyTip):((e=>{n("#formula-editor-popup").trigger("formulaEntered",e)})({img:r.img,latex:o}),t.closePopup())}))},t.mouseEnter=function(){t.showLatex=!0},t.mouseLeave=function(){t.showLatex=!1}}]},223957:function(e,t,r){var n=r(904072),o=r(708468);r(804723),r(841812);var i=r(693604);e.exports=["$rootScope","$scope","$http","toastr",function(e,t,r,a){t.ui={isIE9:window.isIE9,showEmailWarning:!0,showMobileDeviceWarning:!1,showNoMailWarning:!0,isIOS:/\b(iPad|iPhone|iPod)(?=;)/.test(navigator.userAgent),warningWidth:Math.min(window.innerWidth,window.outerWidth)};var s=null,c=function(){var e=n("html").attr("version");return s=setInterval((()=>r.get("/d/version").success((function(r){if(r!==e)return function(){s&&clearInterval(s);var e={preventDuplicates:!0,closeButton:!1,timeOut:-1,extendedTimeOut:-1,onHidden:()=>window.location.reload()};return a.warning(t.warningVersionExpire,e)}()}))),6e5)};t.sendVerificationEmail=function(e){var t=e?"/api/user/send_org_sing_up_verification_email":"/api/user/send_verification_email";return r.post(t,{}).success((function(e){return a.success(e.message,{preventDuplicates:!1}),n("#welcome-verification-email-popup").foundation("reveal","close")})).error((e=>a.error(e.message,{preventDuplicates:!1})))},t.syncSemesters=function(){return api.mySemesters(t.conditions.academic_year_id,(function(e){return t.semesters=e.semesters,t.conditions.semester_id=[],multiSelect.multiSelect("#semester-select")}),(()=>t.semesters=[]))},t.dismissEmailWarning=function(){return n.cookie("warning:verification_email","hide",{path:"/"}),t.ui.showEmailWarning=!1},t.dismissChangePasswordWarning=function(){i.hideChangePasswordWarning(t.changePasswordNotifyInterval),t.ui.showChangePasswordWarning=!1},t.dismissMobileBrowserWarning=()=>t.ui.showMobileDeviceWarning=!1,t.dismissNoMailWarning=function(){return n.cookie("warning:no_email_warning","hide",{path:"/"}),t.ui.showNoMailWarning=!1},t.showVerificationPopup=function(){return n("#welcome-verification-email-popup").foundation("reveal","open"),!0};var u=function(){var e;return c(),e=navigator.userAgent.toLowerCase().match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i),t.ui.showMobileDeviceWarning=!o.isEmpty(e),t.ui.showMobileDeviceWarning&&n(window).resize((()=>{t.ui.warningWidth=Math.min(window.innerWidth,window.outerWidth),t.$apply()})),t.ui.showEmailWarning=!(t.ui.isIE9&&t.ui.showMobileDeviceWarning)&&"hide"!==n.cookie()["warning:verification_email"],t.ui.showChangePasswordWarning=!(t.ui.isIE9&&t.ui.showChangePasswordWarning)&&"hide"!==n.cookie()["warning:change_password"],t.ui.showNoMailWarning=!(t.ui.isIE9&&t.ui.showNoMailWarning)&&"hide"!==n.cookie()["warning:no_email_warning"]};return t.reset=u,u()}]},653131:function(e,t,r){var n=r(361204);e.exports=n.module("baseCtrl",["base"]).factory("bulletinApi",r(841789)).factory("rollcallRepository",r(301253)).factory("onlineVideoCompletenessRepository",r(6201)).factory("performanceRepository",r(330459)).factory("performanceApi",r(776405)).factory("scoreRepository",r(201305)).factory("groupApi",r(683257)).factory("courseManagementApi",r(442247)).controller("HeaderCtrl",r(786995)).controller("FooterCtrl",r(789785)).controller("PreTaskController",r(966641)).controller("UnreadOrgBulletinPopupController",r(383844)).controller("HeaderWarningController",r(223957)).controller("CourseHeaderCtrl",r(406177)).controller("PortfolioCtrl",r(269396)).controller("CourseMenuCtrl",r(581986)).controller("ManagementMenuCtrl",r(223031)).controller("FilePreviewerController",r(86434)).controller("PreviewModeController",r(199004)).controller("PdfEditorController",r(558033)).controller("FileHypStatController",r(389465)).controller("AudioPlayCtrl",r(608632)).controller("CodeEditorController",r(646321)).controller("EmbedVideoController",r(66129)).controller("FileSelectController",r(273085)).controller("CoverSelectController",r(329362)).controller("EntriesSelectController",r(211376)).controller("FileUploadController",r(97592)).controller("InviteConfirmController",r(364955)).controller("AttachmentDeleteController",r(454169)).controller("AttachmentWarningController",r(805802)).controller("AssociationCodeController",r(16578)).controller("ManualListController",r(272762)).controller("StudentStudyCompletenessController",r(112253)).controller("FormulaEditorController",r(970811)).controller("LatexTipsController",r(960257)).controller("SlidePreviewController",r(371810)).controller("FilePreviewNoteController",r(3196)).controller("StorageCtrl",r(933533)).controller("EditScorePercentageCtrl",r(548373)).controller("NoteController",r(79980)).controller("CalendarEventController",r(393862)).controller("CalendarTimetableController",r(350686)).controller("CalendarMeetingController",r(817382)).controller("VideoQuizPreviewController",r(647802)).controller("NotificationContentCtrl",r(166555)).controller("CourseInviteUsersCtrl",r(299365)).controller("UserJoinCourseCtrl",r(186021)).controller("SwitchAudioPopupController",r(664584)).controller("CalendarController",r(581943)).controller("DingtalkValidatePopupController",r(108300)).name},364955:function(e,t,r){var n=r(708468);e.exports=["$scope","$http","$rootScope","$document","toastr","$window",function(e,t,r,o,i,a){c=s=void 0;var s,c,u=function(){e.error=null,e.teachingUnitType=r.invitePayload.teaching_unit_type,c=r.invitePayload.teaching_unit_id,s=r.invitePayload.invite_id,e.loading=!0;return t.get("/api/invites/".concat(s,"/status")).success((function(t){return e.joined="joined"===t.status,e.loading=!1})).error((function(t,r){return e.error={},404===r?e.error.inviteCancelled=!0:e.error.courseDeleted=!0,e.loading=!1}))};return o.on("open.fndtn.reveal","#invite-confirm",(e=>u())),e.confirm=function(){var r="/course/".concat(c,"/content");return e.joined?location.href=r:t.post("/api/invites/".concat(s,"/invite-confirm")).success((()=>location.href=r)).error(n.noop)},e.toUserIndex=()=>a.location.href="/user/index",u()}]},960257:function(e){e.exports=["$rootScope","$scope",function(e,t){t.showLatex=!1,t.mouseEnter=function(){t.showLatex=!0},t.mouseLeave=function(){t.showLatex=!1}}]},223031:function(e,t,r){var n=r(904072);e.exports=["$scope",function(e){e.ui={inLessonMenu:!1,showLessonMenu:!1,inStatMenu:!1,showStatMenu:!1,inCourseMenu:!1,showCourseMenu:!1,inCurriculumMenu:!1,showCurriculumMenu:!1,inExamCenterMenu:!1,showExamCenterMenu:!1,inUserMenu:!1,showUserMenu:!1,inResourceMenu:!1,showResourceMenu:!1,inBulletinMenu:!1,showBulletinMenu:!1,inStorageMenu:!1,showStorageMenu:!1,inWarningMenu:!1,showWarningMenu:!1,inStatisticsReportMenu:!1,showStatisticsReportMenu:!1,inCourseStatisticsReportMenu:!1,showCourseStatisticsReportMenu:!1,showSubjectMenu:!1,inSubjectMenu:!1,showScoreMenu:!1,inScoreMenu:!1,showLiveCapturePluginMenu:!1,inLiveCapturePluginMenu:!1,showAuthzMenu:!1,inAuthzMenu:!1,showLiveClassMenu:!1,inLiveClassMenu:!1},e.toggleLiveCaptureMenu=function(){return e.ui.showLiveCapturePluginMenu?e.hideLiveCaptureMenu():e.ui.showLiveCapturePluginMenu=!0},e.hideLiveCaptureMenu=function(){if(!e.ui.inLiveCapturePluginMenu)return e.ui.showLiveCapturePluginMenu=!1},e.showLessonMenu=function(){return e.ui.showLessonMenu?e.hideLessonMenu():(n(".management-menu-lesson .dropdown").focus(),e.ui.showLessonMenu=!0)},e.hideLessonMenu=function(){if(!e.ui.inLessonMenu)return e.ui.showLessonMenu=!1},e.showStatMenu=function(){return e.ui.showStatMenu?e.hideStatMenu():(n(".management-menu-stat .dropdown").focus(),e.ui.showStatMenu=!0)},e.hideStatMenu=function(){if(!e.ui.inStatMenu)return e.ui.showStatMenu=!1},e.showStorageMenu=function(){return e.ui.showStorageMenu?e.hideStorageMenu():(n(".management-menu-storage .dropdown").focus(),e.ui.showStorageMenu=!0)},e.hideStorageMenu=function(){if(!e.ui.inStorageMenu)return e.ui.showStorageMenu=!1},e.toggleCourseMenu=function(){return e.ui.showCourseMenu?e.hideCourseMenu():e.ui.showCourseMenu=!0},e.hideCourseMenu=function(){if(!e.ui.inCourseMenu)return e.ui.showCourseMenu=!1},e.toggleCurriculumMenu=function(){return e.ui.showCurriculumMenu?e.hideCurriculumMenu():e.ui.showCurriculumMenu=!0},e.hideCurriculumMenu=function(){if(!e.ui.inCurriculumMenu)return e.ui.showCurriculumMenu=!1},e.toggleExamCenterMenu=function(){return e.ui.showExamCenterMenu?e.hideExamCenterMenu():e.ui.showExamCenterMenu=!0},e.hideExamCenterMenu=function(){if(!e.ui.inExamCenterMenu)return e.ui.showExamCenterMenu=!1},e.toggleUserMenu=function(){return e.ui.showUserMenu?e.hideUserMenu():e.ui.showUserMenu=!0},e.hideUserMenu=function(){if(!e.ui.inUserMenu)return e.ui.showUserMenu=!1},e.toggleResourceMenu=function(){return e.ui.showResourceMenu?e.hideResourceMenu():e.ui.showResourceMenu=!0},e.hideResourceMenu=function(){if(!e.ui.inResourceMenu)return e.ui.showResourceMenu=!1},e.toggleGadgetMenu=function(){return e.ui.showGadgetMenu?e.hideGadgetMenu():e.ui.showGadgetMenu=!0},e.hideGadgetMenu=function(){if(!e.ui.inGadgetMenu)return e.ui.showGadgetMenu=!1},e.toggleBulletinMenu=function(){return e.ui.showBulletinMenu?e.hideBulletinMenu():e.ui.showBulletinMenu=!0},e.hideBulletinMenu=function(){if(!e.ui.inBulletinMenu)return e.ui.showBulletinMenu=!1},e.toggleWarningMenu=function(){return e.ui.showWarningMenu?e.hideWarningMenu():e.ui.showWarningMenu=!0},e.hideWarningMenu=function(){if(!e.ui.inWarningMenu)return e.ui.showWarningMenu=!1},e.toggleStatisticsReportMenu=function(){return e.ui.showStatisticsReportMenu?e.hideStatisticsReportnu():e.ui.showStatisticsReportMenu=!0},e.hideStatisticsReportnu=function(){if(!e.ui.inStatisticsReportMenu)return e.ui.showStatisticsReportMenu=!1},e.toggleCourseStatisticsReportMenu=function(){return e.ui.showCourseStatisticsReportMenu?e.hideCourseStatisticsReportnu():e.ui.showCourseStatisticsReportMenu=!0},e.hideCourseStatisticsReportnu=function(){if(!e.ui.inCourseStatisticsReportMenu)return e.ui.showCourseStatisticsReportMenu=!1},e.toggleSubjectMenu=function(){return e.ui.showSubjectMenu?e.hideSubjectMenu():e.ui.showSubjectMenu=!0},e.hideSubjectMenu=function(){if(!e.ui.inSubjectMenu)return e.ui.showSubjectMenu=!1},e.toggleScoreMenu=function(){return e.ui.showScoreMenu?e.hideScoreMenu():e.ui.showScoreMenu=!0},e.hideScoreMenu=function(){if(!e.ui.inScoreMenu)return e.ui.showScoreMenu=!1},e.toggleAuthzMenu=function(){return e.ui.showAuthzMenu?e.hideAuthzMenu():e.ui.showAuthzMenu=!0},e.hideAuthzMenu=function(){if(!e.ui.inAuthzMenu)return e.ui.showAuthzMenu=!1},e.goAuthzPageByUrl=function(e){window.location.href=e},e.hideLiveClassMenu=function(){if(!e.ui.inLiveClassMenu)return e.ui.showLiveClassMenu=!1},e.showLiveClassMenu=function(){return e.ui.showLiveClassMenu?e.hideLiveClassMenu():(n(".management-live-class .dropdown").focus(),e.ui.showLiveClassMenu=!0)}}]},272762:function(e,t,r){var n=r(904072);r(682772),e.exports=["$scope","$rootScope","$sce",function(e,t,r){e.trustAsResourceUrl=e=>r.trustAsResourceUrl("/note-bene/pdf-viewer?file=".concat(e)),e.selectManual=function(r){return t.manualType=r,t.manualUrl=e.manualUrlDict[r],t.upload={type:"document"},e.$emit("clickManualListItem")},e.isHtmlManual=function(t){return!!e.manualUrlDict[t].toLowerCase().indexOf(".html")};return e.enterFullScreen=function(e){return t.ui.fullScreen=!0,(r=n(e=e||"#manual-viewer-popup .reader-wrapper").get(0)).requestFullscreen?r.requestFullscreen():r.msRequestFullscreen?r.msRequestFullscreen():r.mozRequestFullScreen?r.mozRequestFullScreen():r.webkitRequestFullscreen?r.webkitRequestFullscreen():void 0;var r},e.exitFullScreen=function(){return document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),t.ui.fullScreen=!1}}]},558033:function(e,t,r){var n=r(904072);r(66992),r(788674),r(333948),r(560285);var o=r(887757);function i(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function s(e){i(a,n,o,s,c,"next",e)}function c(e){i(a,n,o,s,c,"throw",e)}s(void 0)}))}}r(535666),e.exports=["$rootScope","$scope","$http","$sce","$translate","toastr",function(e,t,r,i,s,c){t.userName=null,t.fileUrl=null,t.fileName="",t.documentUrl="",t.fileType="",t.uploadId=null,t.saveFunction=e=>{},t.isConfirmPopupOpen=!1,t.loading=!1,t.isPdfChanged=!1,t.iframeOnload=()=>{t.loading=!1};var u=function(e){return(e=e||window.event)&&(e.returnValue=!0),!0};window.addEventListener("refreshPDFURL",function(){var e=a(o.mark((function e(r){var n;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=function(){var e=a(o.mark((function e(n){var i,a;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(r.detail.data).then((e=>e.blob()));case 2:i=e.sent,a=URL.createObjectURL(i),t.fileUrl=a,t.loading=!0,t.documentUrl="/pdf/editor?uploadId=".concat(t.uploadId,"&file=").concat(encodeURIComponent(a),"&fileName=").concat(r.detail.fileName,"&fileType=").concat(r.detail.fileType,"&imgURL=").concat(r.detail.imgURL,"&rotatedAngle=").concat(r.detail.rotatedAngle,"&attachmentUrl=").concat(encodeURIComponent(n)),t.fileName=r.detail.fileName,t.fileType=r.detail.fileType,t.$apply(),window.addEventListener("beforeunload",u);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.detail.marksMetadata&&r.detail.marksMetadata.length>0?t.saveFunction(r.detail.marksMetadata,!1,n):n(t.attachmentUrl);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.$on("pdfEditor",((r,n,o)=>{t.fileUrl=n.url,t.userName=n.name,t.documentUrl="/pdf/editor?uploadId=".concat(n.uploadId,"&file=").concat(encodeURIComponent(n.url),"&fileName=").concat(n.fileName,"&fileType=").concat(n.fileType,"&imgURL=").concat(n.imgURL,"&rotatedAngle=0&attachmentUrl=").concat(encodeURIComponent(n.attachmentUrl)),t.fileName=n.fileName,t.fileType=n.fileType,t.uploadId=n.uploadId,t.attachmentUrl=n.attachmentUrl,t.saveFunction=o,t.loading=!0,window.addEventListener("beforeunload",u),"homework"!==t.activityData.type||t.canEditByPdfEditorWithType(n.fileType)||e.$broadcast("previewFile",l(),t.activityData.activity)})),e.$on("pdfEditor:loading",((e,r)=>{t.loading=r}));t.savePdf=(r,n)=>{var o;if(t.loading=!0,null!=r&&r>100)return t.loading=!1,c.error(t.$t("homework.scoreError"));(t=>{e.$broadcast("syncSubmissionScore",t)})(r);var i=new CustomEvent("savePdf",{detail:{saveFunction:t.saveFunction,showSuccessToastr:n}}),a=null===(o=document.getElementById("pdfEditorIframe"))||void 0===o?void 0:o.contentDocument;a?a.dispatchEvent(i):t.saveFunction()},t.switchPdfChanged=e=>{t.isPdfChanged=e},t.openConfirmPopup=()=>{var e,r=new CustomEvent("closePdf",{detail:{switchPdfChanged:t.switchPdfChanged}}),n=null===(e=document.getElementById("pdfEditorIframe"))||void 0===e?void 0:e.contentDocument;n&&n.dispatchEvent(r),t.isPdfChanged?t.isConfirmPopupOpen=!0:t.exitPdfEditor()},t.$on("setActivityData",(function(e,r){t.activityData=r})),t.changeFile=r=>{t.exitPdfEditor(),e.$broadcast("changePdfEditor",r)},t.exitPdfEditor=()=>{t.isConfirmPopupOpen=!1,window.removeEventListener("beforeunload",u),n("#pdf-editor").foundation("reveal","close")},t.cancelExitPdfEditor=()=>{t.isConfirmPopupOpen=!1},t.canEditByPdfEditorWithType=e=>["document","image"].includes(e);var l=()=>{var e=t.activityData;return e.uploads[e.uploadIdToIndexes[t.uploadId]]};t.isDisableClick=e=>{var r=t.activityData,n=r.type,o=r.uploadsLen,i=r.uploadIdToIndexes;if("homework"!==n)return!1;var a=i[t.uploadId]+e;return a<0||a>=o}}]},269396:function(e){e.exports=["$rootScope","$scope",function(e,t){}]},966641:function(e,t,r){var n=r(708468),o=r(904072),i=r(730381);e.exports=["$scope","$http",function(e,t){var r=n.parseInt(o("#userId").data("id")),a="".concat(r,":last_check_pre_task");return function(){var r=window.localStorage.getItem(a);if(!r||i.utc(r).add(6,"hour")<i.utc())return t.get("/api/user/pre-task").success((function(t){if(window.localStorage.setItem(a,i.utc().format()),t.has_pre_task)return o("#pre-task-popup").foundation("reveal","open"),e.url=t.url||"http://eurasia.mycospxk.com/"})).error((function(){}))}()}]},199004:function(e,t,r){var n=r(139390);e.exports=["$scope","$http","toastr",function(e,t,r){var o=window.featureToggles||{};o.wps_preview?(wpsInit=function(){var t=document.getElementById("ppt-viewer");n.wpsPreviewInit(e.upload.documentUrl,t)},wpsInit()):o.yz_office_preview&&e.$watch("upload.id",(function(e){i(e)})),e.previewDataMap={};var i=function(n){t.get("/api/uploads/".concat(n,"/preview/yz")).then((function(t){e.previewDataMap[n]=t.data.preview_url})).catch((function(){r.error()}))}}]},371810:function(e){e.exports=["$rootScope","$scope","$location",(e,t,r)=>t.isHttpResource=function(e){return"http"!==r.$$protocol&&/^http:\/\//.test(e)}]},112253:function(e,t,r){var n=r(904072);r(788674);var o=r(887757);function i(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}r(535666),e.exports=["$scope","activityRepository","$q","modelHelper",function(e,t,r,a){var s=n("#courseId").val();return e.activityUrl=a.activityUrl,function(){var r,a=(r=o.mark((function r(){var i;return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e.courseStudy={completeness:0},r.next=3,t.getAllActivitiesForStudentCompleteness(s);case 3:i=r.sent,e.courseStudy.lastStudyActivity=i.last_activity,e.courseStudy.completeness=i.study_completeness,t.updateStudentCompleteness(s,n("#userId").data("id"));case 7:case"end":return r.stop()}}),r)})),function(){var e=this,t=arguments;return new Promise((function(n,o){var a=r.apply(e,t);function s(e){i(a,n,o,s,c,"next",e)}function c(e){i(a,n,o,s,c,"throw",e)}s(void 0)}))});return function(){return a.apply(this,arguments)}}()()}]},664584:function(e){e.exports=["$scope",function(e){e.currentAudio={},e.nextAudio={},e.$on("initSwitchAudioPopup",(function(t,r){e.currentAudioScope=r.currentAudioScope,e.nextAudioScope=r.nextAudioScope})),e.confirm=function(){e.$root.$broadcast("switchAudio",{currentAudioScope:e.currentAudioScope,nextAudioScope:e.nextAudioScope})}}]},383844:function(e,t,r){var n=r(904072),o=r(942783);e.exports=["$scope","$http","bulletinApi","$location",function(e,t,r,i){e.toggleBulletin=function(e){window.location.href="/bulletin-list/?type=org&bulletin_id=".concat(e.id)},e.goToBulletin=function(){window.location.href="/bulletin-list/?type=org"},e.cancel=function(){n("#unread-org-bulletin-popup").foundation("reveal","close")},e.pageSize=100,function(){e.ui={inPopup:!0},e.conditions={unread:!0,show_on_popup:!0};var t=o(e,i,"org-bulletins"),a=(t,n,o)=>r.getBulletins(t,n,e.conditions,o),s=t=>{e.bulletins=t.bulletins,e.bulletins.length&&n("#unread-org-bulletin-popup").foundation("reveal","open")};e.changePage=e=>t.changePage(e,a,s),e.changePage(1)}()}]},748784:function(e,t,r){r(682772),r(66992),r(115306),r(864765),r(333948),r(560285),e.exports=["$location",function(e){return{getBackUrl(){var e="",t=new URL(window.location.href.replace("#","")).searchParams;return t["back-url"]&&(e=t["back-url"]),e},goBack(){this.getBackUrl()?location.href=back_url:history.go(-1)},getHashPath(e){var t=e.href,r=t.substring(t.indexOf("#"));return r.indexOf("?")>-1&&(r=r.substring(0,r.indexOf("?"))),r||""},getCurrentFullPath(){return"/".concat(window.location.pathname.substring(1)).concat(this.getHashPath(new URL(window.location))).concat(new URL(window.location.href.replace("#","")).search)},buildURLWithBack(e){var t=new URL(e,window.location.origin),r=new URL(e.replace("#",""),window.location.origin);return t.pathname+this.getHashPath(t)+(r.search?"".concat(r.search,"&"):"?")+"back-url=".concat(encodeURIComponent(this.getCurrentFullPath()))}}}]},787174:function(e){e.exports=["$http","$q","toastr",(e,t,r)=>({getOpenClientURL(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=t.defer(),i="/api/blobstorage/open-client-url?parent_id=".concat(n,"&no-intercept=true");return e.get(i).success((e=>o.resolve(e.open_client_url))).error(r.decorateError()),o.promise}})]},598248:function(e,t,r){var n=r(708468);e.exports=["$http","$q","toastr",function(e,t,r){var o,i=t.defer(),a=!1,s=function(e){return n.merge(o,e),a=!0,i.resolve(e)};return o={load:()=>(a||e.get("/api/config?no-intercept=true").success(s).error(r.decorateError),i.promise)}}]},318293:function(e,t,r){r(747042),e.exports=["$q",function(e){class t{constructor(e){this.blob=e,this.reader=new FileReader}read(){return this.deferred||(this.deferred=e.defer(),this.reader.onload=e=>this.deferred.resolve(e.target.result),this.reader.readAsArrayBuffer(this.blob)),this.deferred.promise}}return function(e){for(var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4194304,n=Math.floor((e.size+r-1)/r),o=[],i=0,a=n,s=0<=a;s?i<a:i>a;s?i++:i--){var c=i*r,u=e.slice(c,c+r);o.push(new t(u))}return o}}]},271692:function(e){e.exports=["$timeout",e=>({highlight(t,r){var n=r&&r.fadeInDuration?r.fadeInDuration:1e3,o=r&&r.fadeOutDuration?r.fadeOutDuration:400,i=r&&r.duration?r.duration:1e3,a=r&&r.color?r.color:"#FFFF99";return t.animate({"background-color":a},{duration:n,complete:()=>e((()=>t.animate({"background-color":""},{duration:o})),i)})}})]},665458:function(e,t,r){var n=r(361204);e.exports=n.module("baseFactory",["base",r(155360)]).factory("toastr",r(959242)).factory("modelHelper",r(766832)).factory("highlight",r(271692)).factory("multiSelect",r(108081)).factory("commonApi",r(392853)).factory("config",r(598248)).factory("blobstorage",r(787174)).factory("simditor",r(969658)).factory("treeViewSearch",r(579920)).factory("scormUtils",r(371493)).factory("fileSlice",r(318293)).factory("revealModalParams",r(924463)).factory("momentService",r(734922)).factory("navSettingRepository",r(515996)).factory("statHelper",r(516109)).factory("videoQuizRepository",r(985592)).factory("ExamSubject",r(665383)).factory("interactionHelper",r(499289)).factory("filesApi",r(397416)).factory("calendarApi",r(875966)).factory("calendarRepository",r(443746)).factory("activityApi",r(169671)).factory("activityRepository",r(33614)).factory("examApi",r(62174)).factory("fileSelectModel",r(194410)).factory("backUrl",r(748784)).factory("Course",r(354476)).name},734922:function(e){e.exports=()=>({DATE_TIME_FORMAT:"YYYY.MM.DD HH:mm"})},108081:function(e,t,r){var n=r(904072),o=r(708468);r(132023);var i=r(624562),a=r(796824);e.exports=["$timeout",e=>({multiSelect(t,r){var s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],c=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],u=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return e((function(){var e=n(t),l=e.find("option");if(r&&o.each(l,(function(e){r.includes(e.value)&&n(e).prop("selected",!0)})),e.children("option").length>=8e3){try{e.multiselect("destroy")}catch(e){}return a(e,t,null,s,c,!1,u)}return e.data("echMultiselect")&&(c&&e.multiselectfilter("destroy"),e.multiselect("destroy")),i(e,t,s,c,u)}))}})]},515996:function(e){e.exports=["$http","$q",function(e,t){var r={};return{initNavSetting(n){if(r[n])return r[n].promise;r[n]=t.defer();return e.get("/api/courses/".concat(n,"/nav-setting")).success((e=>r[n].resolve(e))).error((()=>r[n].resolve())),r[n].promise}}}]},924463:function(e){e.exports=()=>({})},371493:function(e,t,r){var n=r(708468);r(454747),e.exports=[function(){var e=function(e,r,o,i,a,s){var c;if(c=i instanceof Array?n.find(i,{identifier:o.identifierref}):i){var u=t(e,c);o.scormUrl="/api/uploads/scorm/".concat(r,"?sco=").concat(u,"&preview=true")}if(c&&s){var l=t(e,c);o.scormUrl="/".concat(a,"/shared-resources/").concat(s,"/scorms?sco=").concat(l)}if(o.parameters&&o.scormUrl)return o.scormUrl+="&para=".concat(encodeURIComponent(o.parameters))},t=function(e,t){return t["xml:base"]?"".concat(t["xml:base"]).concat(t.href):"".concat(e).concat(t.href)};return{bindResourcesBaseLocation:function(e){var t="";return e["xmlns:base"]&&(t=e["xmlns:base"]),e.resources["xmlns:base"]&&(t+=e.resources["xmlns:base"]),t},bindItemResources:function t(r,o,i,a){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"api",c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return i instanceof Array?n.forEach(i,(function(n){if(n["imsss:sequencing"],n.identifierref&&e(r,o,n,a,s,c),n.item)return t(r,o,n.item,a)})):(e(r,o,i,a,s,c),i.item?t(r,o,i.item,a):void 0)},getFirstScoItem:function(e){return e instanceof Array?e[0]:e}}}]},969658:function(e,t,r){var n=r(904072),o=r(708468);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r(66992),r(788674),r(132023),r(115306),r(333948),r(83954),e.exports=function(){return{create(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Promise.all([r.e(36318),r.e(67724)]).then(r.bind(r,105662)).then((function(i){var s,c,u,l,d;return s=i.default,c=a(a({},s.i18n["zh-CN"]),{},{fill:"",fill_circle:"",entry:"",linkEntry:"",entryText:"",selectEntry:"",selectEntryPlaceholder:"",activity:"",superscript:"",subscript:"",ok:"",embed:"",clean:""}),u=a(a({},s.i18n["en-US"]),{},{fill:"Add Blank",fill_circle:"Add Blank",entry:"Entry",linkEntry:"Link Entry",entryText:"Entry Text",selectEntry:"Select Entry",selectEntryPlaceholder:"Please select an entry",activity:"Activity",superscript:"Superscript",subscript:"Subscript",ok:"Ok",embed:"Embed Video",clean:""}),d={"zh-CN":c,"zh-TW":l={blockquote:"",bold:"",code:"",color:"",coloredText:"",hr:"",image:"",externalImage:"",uploadImage:"",uploadFailed:"",uploadError:"",imageUrl:"",imageSize:"",imageAlt:"",restoreImageSize:"",uploading:"",indent:"",outdent:"",italic:"",link:"",text:"",linkText:"",linkUrl:"",linkTarget:"",openLinkInCurrentWindow:"",openLinkInNewWindow:"",removeLink:"",ol:"",ul:"",strikethrough:"",fontScale:"",fontScaleXLarge:"",fontScaleLarge:"",fontScaleNormal:"",fontScaleSmall:"",fontScaleXSmall:"",table:"",deleteRow:"",insertRowAbove:"",insertRowBelow:"",deleteColumn:"",insertColumnLeft:"",insertColumnRight:"",deleteTable:"",title:"",normalText:"",underline:"",alignment:"",alignCenter:"",alignLeft:"",alignRight:"",selectLanguage:"",audio:"",embed:"",noAudioResource:"",fill:"",fill_circle:"",entry:"",linkEntry:"",entryText:"",selectEntry:"",selectEntryPlaceholder:"",activity:"",superscript:"",subscript:"",ok:"",clean:"Clear formatting"},"zh-MO":l,"en-US":u,"en-GB":u,"th-TH":{blockquote:"",bold:"",code:"",color:"",coloredText:"",hr:"",image:"",externalImage:"",uploadImage:"",uploadFailed:"",uploadError:"",imageUrl:"",imageSize:"",imageAlt:"",restoreImageSize:"",uploading:"",indent:"",outdent:"",italic:"",link:"",linkText:"",linkUrl:"",linkTarget:"",openLinkInCurrentWindow:"",openLinkInNewWindow:"",removeLink:"",ol:"",ul:"",strikethrough:"",table:"",deleteRow:"",insertRowAbove:"",insertRowBelow:"",deleteColumn:"",insertColumnLeft:"",insertColumnRight:"",deleteTable:"",title:"",normalText:"",underline:"",alignment:"",alignCenter:"",alignLeft:"",alignRight:"",selectLanguage:"",fontScale:"",fontScaleXLarge:"",fontScaleLarge:"",fontScaleNormal:"",fontScaleSmall:"",fontScaleXSmall:""}},s.locale=function(e){var t=n("html").attr("lang");return t&&e[t]?t:"en-US"}(d),s.i18n=d,function(e,t){var i,a,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c="object"==typeof t?t:"".concat(t," textarea"),u=["clean","title","bold","italic","underline","strikethrough","fontScale","color","ol","ul","blockquote","code","table","link","lmsimage","hr","indent","outdent","superscript","subscript"],l={textarea:n(c),toolbar:u,toolbarFloat:!1,defaultImage:r(588722),imageButton:!1,tabIndent:!1},d=e=>1===e.length&&"code"===e[0],p=e=>0===e.length;(s=o.merge(l,s,((e,t)=>t))).toolbar.includes("clean")||p(s.toolbar)||d(s.toolbar)||s.toolbar.unshift("clean"),null!==(i=window.featureToggles)&&void 0!==i&&i.vocabulary||(s.toolbar=s.toolbar.filter((e=>"entry"!==e))),null!==(a=window.featureToggles)&&void 0!==a&&a.editorActivityRefer||(s.toolbar=s.toolbar.filter((e=>"activity"!==e)));var f,m=(f=void 0,(m=class extends e{static initClass(){f=function(e){return n(e).find("a").each((function(){if(!this.hasAttribute("target")){var t=n(this).prop("outerHTML");n(this).attr("target","_blank");var r=n(this).prop("outerHTML");return e=e.replace(t,r)}})),e}}sync(){var e=super.sync(...arguments);return f(e)}}).initClass(),m),h=new m(s);return h.url_prefix=n("html").attr("host"),n("[contenteditable]").addClass("needsclick"),n(c).prop("disabled")&&n("[contenteditable]").prop("contenteditable",!1),h}(i.default,e,t)}))}}}},516109:function(e){e.exports=function(){return{inPage(e){if(window.st)return window.st.inPage(e)},setActivityType(e){if(window.st)return window.st.setActivityType(e)},trackVisitOnDestroy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(window.st)return t&&window.st.inPage(t),e.$on("$destroy",(e=>window.st.trackVisit()))},inExamPage(e){if(window.st){var t={activity_id:e.id};return"syllabus"===e.referrer_type&&(t.syllabus_id=e.referrer_id),"module"===e.referrer_type&&(t.module_id=e.referrer_id),st.inPage(t),st.setActivityType("exam")}},track(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(window.st)return window.st.track(e,t,r,n)}}}},579920:function(e,t,r){var n=r(708468),o=r(361204);r(324603),r(339714),r(132023),r(115306),e.exports=function(){var e=function(e,t){var r=new RegExp(t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&"),"i");return 0===t.length||r.test(e.name)},t=function t(r,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"departments";return n.filter(r,(function(r){return r[i]=t(r[i],o),e(r,o)||!n.isEmpty(r[i])}))},r=function(e,t,r){var n=o.copy(t);return i(e,n),r.$broadcast("refreshTreeViewModel")},i=(e,t)=>n.each(e,(function(e){return e.selected=!!t.includes("".concat(e.id)),null!=e.departments&&e.departments.length>0&&t.includes("".concat(e.id))&&i(e.departments,t),!0}));return{searchDepartmentTree(e,o,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"departments",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,c=o[e].keyword,u=n.cloneDeep(s||o.originalDepartments);return o[a]=t(u,c),r(o[a],i,o)},searchOrgTree(e,o,i){var a=o[e].keyword,s=n.cloneDeep(o.originalOrgs);return o.orgs=t(s,a,"children"),r(o.orgs,i,o)},searchSubjectLibsTree(e,t){var r=t[e].keyword,o=n.cloneDeep(t.originalLibs);return n.filter(o,(e=>function(e,t){var r=new RegExp(t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&"),"i");return 0===t.length||r.test(e.title)}(e,r)))},searchDepartmentPermissionTree(e,r){var o=r[e].keyword,i=n.cloneDeep(r.originalDepartmentsTree);r.departments.depTree=t(i,o)},searchDepartmentTreeInScorePublishItem(e,o,i){var a=o[e].keyword,s=n.cloneDeep(o.ui.originalDepartments);return o.ui.departments=t(s,a),r(o.ui.departments,i,o)}}}},895523:function(e,t,r){var n=r(904072),o=r(708468);r(788674),e.exports={drawLineChart:(e,t,i)=>Promise.all([r.e(91403),r.e(91275),r.e(33309),r.e(42440),r.e(70596),r.e(45434),r.e(17408),r.e(3071)]).then(r.t.bind(r,170596,23)).then((r=>function(r){var a=n("#file-hyp-stat-chart"),s=r.init(a[0],"default"),c="#D8D8D8",u=[{type:"line",data:t.statSeries||[0],itemStyle:{normal:{color:"#00BBBD"}}}],l={show:!0,type:"line",lineStyle:{width:1,color:"#D8D8D8"}},d="\n\n\n   "+(null!=i?i.pageNumber:void 0),p=(null!=i?i.numOfNotes:void 0)+"\n",f={color:"#333333"},m={lineStyle:{color:c,width:1}},h={lineStyle:{color:c}},v={show:!0,lineStyle:{type:"dashed",color:"#E8E8E8"}},g={textStyle:{color:"#999999",fontWeight:100}},y=o.extend({},g,{margin:15}),w=o.extend({},g,{margin:12}),b={tooltip:{trigger:"axis",axisPointer:l,formatter:"{c}",padding:[5,19]},grid:{x:55,y:55,x2:55,y2:72,borderWidth:0},xAxis:[{name:d,nameTextStyle:f,data:e,boundaryGap:!1,splitLine:{show:!1},splitArea:{show:!1},axisLine:m,axisTick:h,axisLabel:y}],yAxis:[{name:p,nameTextStyle:f,type:"value",splitLine:v,axisLine:{lineStyle:{color:"rgba(0,0,0,0)"}},axisLabel:w}],series:u};return s.setOption(b),a.on("resizeChart",(()=>s.resize()))}(r))),clearChart:e=>e.setOption({series:[]},!0)}},749807:function(e,t,r){var n=r(904072),o=r(708468),i=function(e,t){var r=n(e),o=r.find(">.row"),i=o.innerHeight();if(i>=t)for(var a=r.find(".autocollapse-container"),s=o.find(".autocollapse-item").not(".autocollapse-container .autocollapse-item"),c=s.length-1;c>=0&&i>t;)n(s[c]).prependTo(a),c-=1,i=o.innerHeight()};n((function(){setTimeout((()=>{i(".header-autocollapse",60)}),300),n(window).on("resize",o.debounce((function(){i(".header-autocollapse",60)}),150))}))},932135:function(e,t,r){var n=r(708468);r(682772),r(804723),t.cacheBusterInterceptor=()=>({request:e=>(/^\/api\//.test(e.url)&&window.RequestScope&&(e.headers["Request-Scope"]=window.RequestScope),e)}),t.progressInterceptor=["$q","$rootScope","$injector","$window",function(e,t,r,o){var i=0,a=0,s=null,c=function(e){var t="GET"===e.method.toUpperCase()&&-1!==e.url.indexOf("/notifications"),r=n.contains(e.url,"no-intercept=true");return e.url.match("html$")||t||r},u=function(e){return!n.contains(e.url,"no-loading-animation=true")&&"GET"===e.method.toUpperCase()},l=function(){return s=s||r.get("ngProgress")},d=function(){return t.ui=t.ui||{},t.ui},p=()=>{d().contentLoadingComplete=!0,t.contentLoaded=!1};p();var f=function(e){if(0===(i-=1)&&l().complete(),u(e)&&0===(a-=1))return p()};return{request:e=>(c(e)||(i+=1,u(e)&&(a+=1),1===i&&(l().reset(),l().start()),1===a&&(d().contentLoadingComplete=!1,t.contentLoaded=!0)),e),requestError:t=>(c(t.config)||f(t.config),e.reject(t)),response:e=>(c(e.config)||f(e.config),e),responseError:t=>401===t.status?o.location.href="/login?next="+encodeURIComponent(o.location.pathname+o.location.hash):(c(t.config)||f(t.config),e.reject(t))}}]},589842:function(e,t,r){"use strict";r.r(t);r(115306);var n={lang:"",clipTaskTitle:"",taskProcessing:"",taskFail:"",residue:"",processFail:"",saveSuccess:"",saveError:"",mark:"",videoSpeed:"",user:"",addUser:"",basicInfo:"",enrollmentManagement:"",rollcallRecord:"",alertRecord:"",roleManagement:"",cliping:"",clipFailed:"",compositing:"",compositeFailed:"",Student:"",Instructor:"",Faculty:"",EducationalAdmin:"",Admin:"",courseSubject:"",addCourseSubject:"",editCourseSubject:"",course:"",addCourse:"",editCourse:""},o={lang:"",clipTaskTitle:"",taskProcessing:"",taskFail:"",residue:"",processFail:"",saveSuccess:"",saveError:"",mark:"",videoSpeed:"",user:"",addUser:"",basicInfo:"",enrollmentManagement:"",rollcallRecord:"",alertRecord:"",roleManagement:"",cliping:"",clipFailed:"",compositing:"",compositeFailed:"",Student:"",Instructor:"",Faculty:"",EducationalAdmin:"",Admin:"",courseSubject:"",addCourseSubject:"",editCourseSubject:"",course:"",addCourse:"",editCourse:""},i={lang:"",clipTaskTitle:"",taskProcessing:"",taskFail:"",residue:"",processFail:"",saveSuccess:"",saveError:"",mark:"",videoSpeed:"",user:"",addUser:"",basicInfo:"",enrollmentManagement:"",rollcallRecord:"",alertRecord:"",roleManagement:"",cliping:"",clipFailed:"",compositing:"",compositeFailed:"",Student:"",Instructor:"",Faculty:"",EducationalAdmin:"",Admin:"",courseSubject:"",addCourseSubject:"",editCourseSubject:"",course:"",addCourse:"",editCourse:""},a={lang:"gb",clipTaskTitle:"Edit",taskProcessing:"In progress",taskFail:"Fail",residue:"Residue",processFail:"Process Fail",saveSuccess:"Save Successfully",saveError:"Save Failed",mark:"Mark",videoSpeed:"Speed",user:"User",addUser:"Add User",basicInfo:"Basic Information",enrollmentManagement:"Enrollment Management",rollcallRecord:"Rollcall Record",alertRecord:"Alert Record",roleManagement:"Authority Management",cliping:"Cliping",clipFailed:"Clip Failed",compositing:"Compositing",compositeFailed:"Composite Failed",Student:"Student",Instructor:"Instructor",Faculty:"Faculty",EducationalAdmin:"EducationalAdmin",Admin:"SuperAdmin",courseSubject:"Subject",addCourseSubject:"Add Subject",editCourseSubject:"Edit Subject",course:"Course",addCourse:"Add Course",editCourse:"Edit Course"},s={lang:"us",clipTaskTitle:"Edit",taskProcessing:"In progress",taskFail:"Fail",residue:"Residue",processFail:"Process Fail",saveSuccess:"Save Successfully",saveError:"Save Failed",mark:"Mark",videoSpeed:"Speed",user:"User",addUser:"Add User",basicInfo:"Basic Information",enrollmentManagement:"Enrollment Management",rollcallRecord:"Rollcall Record",alertRecord:"Alert Record",roleManagement:"Authority Management",cliping:"Cliping",clipFailed:"Clip Failed",compositing:"Compositing",compositeFailed:"Composite Failed",Student:"Student",Instructor:"Instructor",Faculty:"Faculty",EducationalAdmin:"EducationalAdmin",Admin:"SuperAdmin",courseSubject:"Subject",addCourseSubject:"Add Subject",editCourseSubject:"Edit Subject",course:"Course",addCourse:"Add Course",editCourse:"Edit Course"},c={lang:"thai",clipTaskTitle:"",taskProcessing:"",taskFail:"",residue:"",processFail:"",saveSuccess:"",saveError:"",mark:"",videoSpeed:"",user:"",addUser:"",basicInfo:"",enrollmentManagement:"",rollcallRecord:"",alertRecord:"",roleManagement:"",cliping:"",clipFailed:"",compositing:"",compositeFailed:"",Student:"",Instructor:"",Faculty:"",EducationalAdmin:"",Admin:"",courseSubject:"Subject",addCourseSubject:"Add Subject",editCourseSubject:"Edit Subject",course:"Course",addCourse:"Add Course",editCourse:"Edit Course"},u=r(904072),l=r(361204);r(632067);var d=u("html").attr("lang");l.module("i18n",["pascalprecht.translate"]).config(["$translateProvider",function(e){e.translations("zh-cn",n),e.translations("zh-tw",o),e.translations("zh-mo",i),e.translations("en-gb",a),e.translations("en-us",s),e.translations("th-th",c)}]).run(["$translate",function(e){e.use(d.replace("_","-").toLowerCase())}]).name},716894:function(e,t,r){var n=r(361204);r(501801),r(780640),n.module("common",[r(940635),r(665458),r(653131)])},692624:function(e,t,r){var n=r(904072);n(document).on("click","input.truncate-text",(function(){return n(this).prop("readonly",""),n(this).focus()})).on("blur","input.truncate-text",(function(){return n(this).prop("readonly","readonly")}))},704609:function(e){window.MathJax={TeX:{extensions:["autoload-all.js","mhchem.js","[Contrib]/physics/physics.js"],noErrors:{disabled:!0}},messageStyle:"none",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],skipTags:["script","noscript","style","textarea","pre","code"],ignoreClass:"simditor|mathjax-ignore",preview:"none",processClass:"simditor-viewer|mathjax-process",processEscapes:!0},asciimath2jax:{delimiters:[]},AuthorInit:function(){MathJax.Ajax.config.path.Contrib="/static/js/mathjax/extensions/Tex",MathJax.Hub.Register.StartupHook("TeX autoload-all Ready",(function(){var e;return(e=MathJax.InputJax.TeX.Definitions.macros).color="Color",delete e.colorbox,delete e.fcolorbox})),MathJax.Hub.Register.StartupHook("TeX Jax Ready",(function(){MathJax.InputJax.TeX.Definitions.Add({mathchar0mi:{divisionsymbol:"00F7"}})}))}};e.exports=function(){var e;(e=document.createElement("script")).src="/static/js/mathjax/latest.js?config=TeX-MML-AM_SVG",document.head.appendChild(e)}},624562:function(e,t,r){var n=r(708468),o=r(904072),i=r(361204);r(115306),r(864765),e.exports=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=e.find("option").length,u=25*n.min([c,7]);t=t.replace("#","");var l=()=>o(".multi-select .ui-multiselect-checkboxes .ui-corner-all").each((function(){var e;i.isDefined(o(this).attr("title"))?(e=o(this).attr("title"),o(this).removeAttr("title")):e=o(this).text();var t=o(this).children("span");return t.attr("title",e),t.tipsy({ellipsis:!0,gravity:o.fn.tipsy.autoBounds(37,"sw"),opacity:1,html:!0})})),d=()=>{var e=o("#".concat(t," + :button.multi-select[title]")),r=e.width(),n=e.next(),i=0;n.find("span").each((function(){i=this.offsetWidth>i?this.offsetWidth:i})),i=Math.min(i,445),n.css("width","".concat(i+55,"px")),n.css("min-width","".concat(r,"px")),o(".ui-multiselect-menu .ui-multiselect-header .ui-multiselect-filter input").css("width","100%")},p=e.multiselect({header:!!a&&"",appendTo:e.parent(),multiple:r,noneSelectedText:e.data("title"),htmlText:["options"],selectedText:(e,t,r)=>1===e?o(r[0]).attr("title")||o(r[0]).next().text():e===t?o("#selected-text-all").text():o("#selected-text").text().replace("#",e),classes:"multi-select",buttonWidth:"auto",selectedList:1,height:u,open(){s?d():l()},beforeclose(){var e=o("#".concat(t," + :button.multi-select[title]")),r=e.attr("title"),n=o("#".concat(t," + :button.multi-select[title] .button-label"));return e.removeAttr("title"),n.attr("title",r),n.tipsy({ellipsis:!0,gravity:o.fn.tipsy.autoBounds(37,"sw"),opacity:1,html:!0})},click(){var t=e.scope(),r=t.disbaleSearch||"true"===e.attr("disableSearch");t.$emit("multiSelect.changed"),"function"!=typeof t.search||r||setTimeout((()=>t.$apply((()=>t.search()))),0)}});a&&p.multiselectfilter({label:"",placeholder:o("#filter-placeholder").text()})}},796824:function(e,t,r){var n=r(904072),o=r(361204);r(115306),r(864765),e.exports=function(e,t,r){var i,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],c=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=null!==(i=e.attr("data-title"))&&void 0!==i?i:e.attr("placeholder"),d=()=>{var e=0;return n(".ms-drop ul li span span").each((function(){e=this.offsetWidth>e?this.offsetWidth:e})),n(".ms-drop").css("width","".concat(e+45,"px")),e+45};e.multipleSelect({filter:s,minimumCountSelected:1,placeholder:l,single:!a,filterPlaceholder:n("#filter-placeholder").text(),selectAll:c,formatCountSelected:(e,t)=>n("#selected-text").text().replace("#",e),formatAllSelected:()=>n("#selected-text-all").text(),textTemplate:function(e){var t=e[0].title.length>0?e[0].title:e.html(),r=e[0].value;return'<span title="'.concat(t,'" value=').concat(r,">").concat(e.html(),"</span>")},formatNoMatchesFound:()=>"",onClick:function(){var t=o.element(e).controller("ngModel");t.$viewValue=e.multipleSelect("getSelects"),t.$commitViewValue();var r=e.scope();r.$emit("multiSelect.changed"),"function"!=typeof r.search||r.disbaleSearch||r.$applyAsync((()=>r.search()))},onOpen:function(){u&&d()}})}},864604:function(e){e.exports=()=>({restrict:"A",link:(e,r)=>r.off("change keyup keydown paste",t).on("change keyup keydown paste",t)});var t=function(){return this.style.height="auto",this.style.height=this.scrollHeight+"px"}},267038:function(e,t,r){var n=r(437232).default;e.exports=function(){return{restrict:"E",scope:{src:"=src"},template:'<svg viewBox="'.concat(n.viewBox,'" ng-if="!src" class="avatar-svg">\n      <use xlink:href="#').concat(n.id,'" />\n    </svg>\n    <img ng-src="[[ src ]]" ng-if="src">')}}},985396:function(e,t,r){var n=r(708468),o=r(904072);e.exports=["$timeout",e=>({restrict:"A",scope:{actualHeight:"="},link:(t,r,i)=>(t.actualHeight=0,e((()=>n.each(r.children(),(e=>t.actualHeight+=o(e).height())))))})]},80320:function(e,t,r){var n=r(904072),o=r(708468);r(682772),e.exports=["$rootScope",e=>({restrict:"A",link(t,r,i){var a=function(){return(parseFloat(i.maxLines)||2)*function(){var e,t=r.css("line-height");if(-1===t.indexOf("px")){var n=parseFloat(r.css("font-size"));e=parseFloat(t)*n}else e=parseFloat(t);return e}()+(parseFloat(r.css("padding-top"))||0)+(parseFloat(r.css("padding-bottom"))||0)+(parseFloat(r.css("border-top"))||0)+(parseFloat(r.css("border-bottom"))||0)},s=t.dotdotdotToggleCollapseI18n||e.dotdotdotToggleCollapseI18n,c=t.dotdotdotToggleExpandI18n||e.dotdotdotToggleExpandI18n,u=n(o.template('<a class="dotdotdot-toggle dotdotdot-toggle-expand" href="javascript:void(0)"><%= text %></a>')({text:c})),l=n(o.template('<a class="dotdotdot-toggle dotdotdot-toggle-collapse" href="javascript:void(0)"><%= text %></a>')({text:s})),d=function(){if(!i.noExpand)return u.detach(),l.detach(),r.trigger("destroy"),r[0].scrollHeight>a()?(r.append(u),r.dotdotdot({ellipsis:"",height:a(),wrap:"letter",after:"a.dotdotdot-toggle"})):void 0;r.dotdotdot({height:a(),wrap:"letter"})};return u.click((e=>{e.stopPropagation(),r.trigger("destroy"),u.detach(),r.append(l)})),l.click((e=>{e.stopPropagation(),d()})),t.$watch(i.ngBind||i.ngBindHtml,d)}})]},704873:function(e,t,r){var n=r(904072);t.revealModal=["$parse","revealModalParams",(e,t)=>({restrict:"A",link(r,o,i){o.on("click",(function(o){var a,s;if("LARK"===(null===(a=r.$parent)||void 0===a||null===(s=a.upload)||void 0===s?void 0:s.source))return o.stopPropagation(),o.preventDefault();if(i.disabled)return o.stopPropagation(),o.preventDefault();var c=e(i.params)(r);return t[i.revealModal]=c,n("#"+i.revealModal).foundation("reveal","open"),r.$apply()}))}})],t.resetable=()=>({restrict:"A",link(e,t,r){var n="opened"===r.resetOn?"opened":"closed";return t.on("".concat(n,".fndtn.reveal"),(function(){if(e.reset)return e.reset()}))}});var o=function(e){var t=n("body>.reveal-modal.open:last-of-type");if(t.attr("close-on")&&"esc"===t.attr("close-on")&&27===e.keyCode)return t.foundation("reveal","close")};t.reveal=["$document","$timeout",(e,t)=>({restrict:"A",scope:!0,link(r,i,a){r.hasOwnProperty("popupState")||(r.popupState={}),e.on("opened.fndtn.reveal","#".concat(a.id),(function(e){e.currentTarget===e.target&&(r.popupState.popupOpened=!0,t((()=>r.$apply())))})),e.on("closed.fndtn.reveal","#".concat(a.id),(function(e){e.currentTarget===e.target&&(r.popupState.popupOpened=!1,t((()=>r.$apply())))})),i.foundation({reveal:{close_on_esc:!1}}),n("body").off("keyup",o).on("keyup",o)}})],t.closePopup=()=>({restrict:"A",link:(e,t,r)=>t.on("click",(function(){return n("#"+r.closePopup).foundation("reveal","close"),!1}))}),t.closePlayerPopup=()=>({restrict:"A",link:(e,t,r)=>t.on("click",(function(){return n("#"+r.closePlayerPopup).foundation("reveal","close"),n(".lesson-player video").each((function(e,t){return t.pause(),t.getElementsByTagName("source")[0].src="",t.load()}))}))})},746794:function(e){e.exports=["$timeout",e=>({restrict:"A",scope:{sliderErrors:"=?",sliderValidation:"&",sliderVerification:"&"},link(t,r,n){r.foundation(),r.foundation("slider","set_value",0);var o="#".concat(n.sliderControl),i=r.find(o);e((function(){var e=r.find("div[data-slider]");return e.on("change.fndtn.slider",(function(){var t=e.attr("data-slider");return i.val(t),i.trigger("change")}))}));var a=i.controller("ngModel");return t.$watch((()=>a.$modelValue),(function(e){if(t.sliderValidation({sliderModelValue:e})&&(t.sliderErrors&&(t.sliderErrors.sliderModelError=t.sliderVerification({sliderModelValue:e})),!isNaN(e)))return r.foundation("slider","set_value",e)}))}})]},892958:function(e,t,r){var n=r(704609),o=!1;e.exports=function(){return{restrict:"A",link(e,t,r){t.addClass("mathjax-process"),o||(n(),o=!0)}}}},726356:function(e,t,r){var n=r(904072),o=r(708468);r(132023);var i=r(624562);e.exports=["$parse",e=>({restrict:"A",link(t,r,a){var s=t.$eval(a.ngModel),c=r.find("option");0===c.length&&a.hasOwnProperty("selectOptionsContainerId")&&(c=n("#".concat(a.selectOptionsContainerId)).find("option"),r.append(c)),s&&o.each(c,(function(e){if(s.includes(e.value)||e.value===s)return n(e).prop("selected",!0)}));var u=a.id,l=!a.multipleDisabled,d=!a.noFilter,p=!!a.responsive;if(i(r,u,l,d,p),a.multiSelectOpen){var f=e(a.multiSelectOpen);return r.bind("multiselectopen",((e,r)=>t.$apply((()=>f(t,{$event:e,$ui:r})))))}}})]},926082:function(e,t,r){var n=r(904072);r(115306),r(864765),e.exports=["$timeout",e=>({restrict:"A",require:"ngModel",scope:{ngModel:"="},link(t,r,o,i){var a,s=!o.noFilter,c=null!==(a=o.selectAll)&&void 0!==a&&a;r.multipleSelect({filter:s,minimumCountSelected:1,filterPlaceholder:n("#filter-placeholder").text(),selectAll:c,data:[],formatCountSelected:(e,t)=>n("#selected-text").text().replace("#",e),formatAllSelected:()=>n("#selected-text-all").text(),formatNoMatchesFound:()=>"",onClick:function(){i.$viewValue=r.multipleSelect("getSelects"),i.$commitViewValue();var t=r.scope();t.ngModel=r.multipleSelect("getSelects"),t.$emit("multiSelect.changed"),"function"!=typeof t.search||t.disbaleSearch||e((()=>t.$apply((()=>t.search()))),0)}})}})]},716858:function(e,t,r){var n=r(361204),o=r(904072),i=function(){return document.querySelectorAll("[data-reveal].open").length};t.p=["$document","$timeout","$window",(e,t,r)=>({restrict:"A",link(a,s,c){var u={reposition:!0};return n.extend(u,a.$eval(c.onModalStateChange)),e.on("open.fndtn.reveal","[data-reveal]",(function(e){var t=o(e.target);return o(".popup-content",t).css("margin-top","")})),e.on("opened.fndtn.reveal","[data-reveal]",(function(e){var n=o(e.target);return t((function(){var e=o(".popup-content",n);if(!(n.attr("no-scroll")||n.hasClass("confirmation-popup")||(u.reposition&&function(e){var t="file-previewer"===e.attr("id");return!t||t&&e.scope().canGuestPreview}(n)&&function(e,t){if(e.height()>t.innerHeight)return e.css("margin-top",85);var r=parseInt((t.innerHeight-e.height())/2);e.css("margin-top",r)}(e,r),i>1)))return o("body").css("overflowY","hidden")}))})),e.on("close.fndtn.reveal","[data-reveal]",(function(e){if(!(o(e.target).attr("no-scroll")||i()>1))return o("body").css("overflowY","")}))}})]},450171:function(e,t,r){var n=r(904072);t.w4=()=>({restrict:"A",link:(e,t,r)=>t.attr("placeholder",e.$eval(r.ngPlaceholder))}),t.jC=()=>({restrict:"A",link:(e,t,r)=>(t.attr("placeholder",r.wgPlaceholder),n(t).placeholder(r.wgPlaceholder))}),t.he=()=>({restrict:"A",link:(e,t,r)=>(t.bind("focus",(()=>{t.attr("placeholder",r.focusPlaceholder)})),t.bind("blur",(()=>{t.attr("placeholder","")})),t)})},845032:function(e,t,r){var n=r(353779).Z;n(r(129038)),n(r(425303)),e.exports=function(){return{restrict:"E",scope:{name:"@name"},template:'<svg class="svg-icon">\n      <use xlink:href="" data-ng-href="[[\'#\' + name]]" />\n    </svg>'}}},529149:function(e,t,r){var n=r(958297);e.exports=["$timeout","$interval",(e,t)=>({restrict:"A",scope:{swfLoad:"&"},link(e,r,o){var i=function(e,r){var n,o=null;return n=t((function(){if(void 0!==e.ref.PercentLoaded&&e.ref.PercentLoaded())return 100===e.ref.PercentLoaded()||e.ref.PercentLoaded()===o?(t.cancel(n),n=null,r({evt:e})):o=e.ref.PercentLoaded()}),400)};return n.embedSWF(o.swfUrl,o.id,o.swfWidth||817,o.swfHeight||470,"9.0.0","/static/swf/expressInstall.swf",!1,{allowScriptAccess:"never",allowNetworking:"internal"},!1,(function(t){if(e.swfLoad&&"function"==typeof e.swfLoad)return t.success&&t.ref?i(t,e.swfLoad):e.swfLoad({evt:t})}))}})]},956212:function(e,t,r){var n=r(904072);e.exports=()=>({restrict:"A",link(e,t,r,o){var i="true"===r.inside?t.children(".dropdown-list"):t.next(".dropdown-list"),a=0,s=!1;t.click((function(e){return e.stopPropagation(),i.toggleClass("hide")})),t.on("mouseenter",(function(){return i.removeClass("hide"),t.removeClass("hovered")})),t.on("mouseleave",(function(){return t.removeClass("hovered"),a=setTimeout((function(){if(!s)return i.addClass("hide")}),100)})),i.click((function(e){return e.stopPropagation(),i.addClass("hide")}));var c=0;return i.on("mouseenter",(function(){return t.addClass("hovered"),clearTimeout(a),clearTimeout(c),s=!0})),i.on("mouseleave",(function(){return t.removeClass("hovered"),s=!1,c=setTimeout((function(){if(!s)return i.addClass("hide")}),50)})),n("body").click((()=>i.addClass("hide")))}})},908760:function(e){e.exports=()=>({restrict:"A",link(e,t,r,n){var o="true"===r.inside?t.children(".dropdown-list"):t.next(".dropdown-list"),i=0,a=!1;t.click((function(e){return e.stopPropagation(),o.toggleClass("hide")})),t.on("mouseenter",(function(){return o.removeClass("hide"),t.removeClass("hovered")})),t.on("mouseleave",(function(){return t.removeClass("hovered"),i=setTimeout((function(){if(!a)return o.addClass("hide")}),20)}));var s=0;o.on("mouseenter",(function(){return t.addClass("hovered"),clearTimeout(i),clearTimeout(s),a=!0})),o.on("mouseleave",(function(){return t.removeClass("hovered"),a=!1,s=setTimeout((function(){if(!a)return o.addClass("hide")}),10)}))}})},752104:function(e){e.exports=()=>function(e){(!e||e<0)&&(e=0);var t=Math.floor(e/3600),r=Math.floor((e-3600*t)/60);return e=e-3600*t-60*r,t<10&&(t="0"+t),r<10&&(r="0"+r),(e=parseInt(e,10))<10&&(e="0"+e),"00"!==t?t+":"+r+":"+e:r+":"+e}},353779:function(e,t,r){"use strict";r(66992),r(804723),r(454747),r(333948);t.Z=function(e){var t={};return e.keys().forEach((function(r){var n=e(r);return t[r.match(/[\w-]+/)[0]]=n.default||n})),t}},85780:function(e){e.exports={Mode:{classmode:"classmode",normal:"normal"},Channel:{wide_screen:"wide_screen",app:"app",web:"web",h5:"h5"},Action:{start:"start",cancel:"cancel",join:"join",end:"end",create:"create",give_score:"give_score",open:"open",save_to_lib:"save_to_lib",zip:"zip"},RaceAnswerAction:{begin:"begin",confirm:"confirm",go_to_select_student:"go_to_select_student",give_score:"give_score"},SelectStudentAction:{random_select:"random_select",give_score:"give_score"},FeedbackAction:{begin:"begin",update:"update",add_item:"add_item"},ForumAction:{create_topic:"create_topic",view_topic:"view_topic",reply:"reply",like:"like",give_score:"give_score",export:"export",view_stats:"view_stats"},CourseWareAction:{download:"download",open:"open",close:"close",view:"view",answer:"answer"},HomeworkAction:{submit:"submit",remind:"remind",recommend:"recommend",marked_submitted:"marked_submitted",marked_unsubmitted:"marked_unsubmitted",notify_make_up:"notify_make_up",set_same_score:"set_same_score",update_final_score:"update_final_score",mark:"mark"},ExamAction:{submit:"submit",view_stats:"view_stats",retake:"retake"},InteractionAction:{add_subject:"add_subject"},ScoreAction:{add_score_item:"add_score_item",view:"view",score_setting:"score_setting",update_final_score:"update_final_score",publish_score:"publish_score"},TeachingActionModule:{score:"score",stats:"stats",group_set:"group_set"},StatsAction:{view:"view",export:"export"},GroupSetAction:{create_group_set:"create_group_set",create_group:"create_group"},RollcallAction:{update_student_rollcall_status:"update_student_rollcall_status"},QuestionnaireAction:{submit:"submit"}}},780640:function(e,t,r){var n=r(904072),o=r(708468),i=r(904072);r(132023),r(115306);var a=r(85780),s="True"===n("#dashboardTracking").val(),c=n("#orgId").val(),u=n("#userId").attr("value"),l=n("#courseId").val(),d="True"===n("#enrollmentIsInstructor").val(),p="True"===n("#enrollmentIsInstructorAssistant").val(),f=n("#enrollmentRole").val();f||(f=d?"instructor":p?"instructor-assistant":"student");var m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(window.globalData||window.statisticsSettings){var t=window.globalData?window.globalData:window.statisticsSettings;t.user&&(e.org_name=t.user.orgName,"None"!==t.user.orgCode&&(e.org_code=t.user.orgCode),e.user_no=t.user.userNo,e.user_name=t.user.name),t.course&&(e.course_code=t.course.courseCode,e.course_name=t.course.name,e.org_id!==e.course_org_id&&(e.org_id=t.course.orgId,e.org_name=t.course.orgName,"None"!==t.course.orgCode&&(e.org_code=t.course.orgCode))),t.dept&&(t.dept.id&&(e.dep_id=t.dept.id),e.dep_name=t.dept.name,e.dep_code=t.dept.code),t.isOpenUniversity&&e.enrollment_role&&e.enrollment_role.includes("instructor")&&(e.enrollment_role="instructor")}},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={org_id:c,user_id:u,course_id:l,enrollment_role:f,is_teacher:d,activity_id:null,activity_type:null,activity_name:null,module:null,action:a.Action.start,ts:(new Date).getTime(),user_agent:navigator.userAgent,mode:a.Mode.classmode,channel:a.Channel.wide_screen,target_info:{}},r=n("#masterCourseId").val()||0;return t.course_id&&0!==parseInt(t.course_id)&&parseInt(t.course_id)!==parseInt(r)&&(t.master_course_id=parseInt(r)),(t=o.merge(t,e)).activity_type&&(t.activity_type=t.activity_type.replace(/-/,"_")),m(t),t},v={enums:a,track:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(s){var t=h(e);if(t.course_id&&(t.activity_id||t.module)){var r="teaching-action";t.activity_type&&(r="learning-activity","research_activity"===t.activity_type&&(r="research-activity",t.activity_type=t.research_type));var n=statisticsSettings.server+"/api/"+r;return i.ajax({method:"POST",url:n,dataType:"json",processData:!1,data:JSON.stringify(t),contentType:"application/json; charset=utf-8"})}}},trackVisit:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return window.st.inPage(t),window.st.setActivityType(e),window.st.trackVisit()},trackZhiyunVisit:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};window.st.trackZhiyunVisit(e,t)},reset:function(){return window.st.reset()},trackData:h,addExtraData:m};e.exports=v,window.statistics=v},19e4:function(e,t,r){var n=r(708468);t.formatValidated=()=>({restrict:"A",require:"?ngModel",link(e,t,r,o){o.$parsers.push((function(e){var t=n.unescape(e);return t!=e&&(o.$setViewValue(t),o.$render()),t})),o.$formatters.push((function(e){return e?n.unescape(e):""}))}})},881063:function(e,t,r){var n=r(708468);r(682772),e.exports={getUrls(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o={},i=n.find(e.videos,{resolution:"QVGA"}),a=n.find(e.videos,{resolution:"VGA"}),s=n.find(e.videos,{resolution:"HD"}),c=n.find(e.videos,{resolution:"ORIGINAL"});if(r?(i&&(o.QVGA="/".concat(t,"/shared-resources/").concat(r,"/preview?preview=true&resolution=qvga")),a&&(o.VGA="/".concat(t,"/shared-resources/").concat(r,"/preview?preview=true&resolution=vga")),s&&(o.HD="/".concat(t,"/shared-resources/").concat(r,"/preview?preview=true&resolution=hd")),c&&(o.ORIGINAL="/".concat(t,"/shared-resources/").concat(r,"/preview?preview=true&resolution=original"))):(i&&(o.QVGA="/".concat(t,"/uploads/video/").concat(i.id,"?preview=true")),a&&(o.VGA="/".concat(t,"/uploads/video/").concat(a.id,"?preview=true")),s&&(o.HD="/".concat(t,"/uploads/video/").concat(s.id,"?preview=true")),c&&(o.ORIGINAL="/".concat(t,"/uploads/video/").concat(c.id,"?preview=true"))),e.third_part_referrer_id&&e.source&&-1!=e.key.indexOf("http")&&(o.ORIGINAL=e.key),0!==Object.keys(o).length)return o}}},139390:function(e,t,r){r(788674);var n=r(887757);function o(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function s(e){o(a,n,i,s,c,"next",e)}function c(e){o(a,n,i,s,c,"throw",e)}s(void 0)}))}}r(535666);var a=function(){var e=i(n.mark((function e(t){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.CommandBars("PlayComponentToolbar");case 2:return e.sent.Visible=!1,e.next=6,t.CommandBars("FloatMenuCheckImage");case 6:e.sent.Visible=!1;case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=function(e){e.ActivePresentation.SlideShowSettings.Run(),e.ActivePresentation.SlideShowWindow.IsFullScreen=!1},c=function(e){e.iframe.focus()},u=function(e){e.Sub.SlideShowEnd=()=>{a(e),s(e)}},l=function(){var e=i(n.mark((function e(t,o){var i,l,d;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(91531).then(r.bind(r,391531));case 2:return i=e.sent,l=i.config({url:t,mount:o}),e.next=6,l.ready();case 6:this.wpsApp=l.Application,(d=l.iframe).style.height="100%",d.style.width="100%",c(l),a(this.wpsApp),s(this.wpsApp),u(this.wpsApp);case 14:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),d=function(){var e=i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.wpsApp.ActivePresentation.SlideShowWindow.View.GotoNextClick();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.wpsApp.ActivePresentation.SlideShowWindow.View.GotoPreClick();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}();e.exports={autoFocus:c,enterPlayModule:s,sdkConfig:a,wpsPreviewInit:l,nextPage:d,prevPage:p,autoEnterFullScreen:u}},299365:function(e,t,r){var n=r(904072),o=r(361204),i=r(708468);r(66992),r(324603),r(339714),r(115306),r(323123),r(454747),r(333948);var a=r(180736);e.exports=["$rootScope","$scope","$http","$timeout","$window","toastr","treeViewSearch",function(e,t,r,s,c,u,l){var d=n("#courseId").val(),p=a(t),f=function(){return t.data={emails:"",org_emails:"",role:"student",org_invite_type:"search",org_id:"",department_id:""},t.user={hide:!0,team_teaching:[]},t.inviteResponse={emails_not_exist:[],emails:"",org_emails:"",invite_type:""},t.orgInviteResponse={emails_not_exist:[],emails:""},t.orgAddError={missingOrg:!1,missingDepartment:!1,missingUser:!1},t.allowInviteStudent?t.data.role="student":t.allowInviteAssistant?t.data.role="instructor_assistant":t.data.role="instructor"};f(),t.ui={resetable:!1,accessCodeCopied:!1,accessUrlCopied:!1},t.access_code="",t.access_url="";var m=function(e){return p.hide(),t.accessCode=e.access_code,t.accessUrl=h(t.accessCode)};t.resetAccessCodeAndUrl=function(){return p.show(),r.put("/api/course/".concat(d,"/access_code")).success(m).error((()=>p.hide()))},t.fallbackToManuallyCopy=e=>window.prompt(t.copyFallbackText,e),t.copiedCode=()=>s((()=>u.success(t.copiedSuccessfullyText))),t.copiedUrl=()=>s((()=>u.success(t.copiedSuccessfullyText)));var h=e=>"".concat(c.location.protocol,"//").concat(c.location.host,"/course/join/").concat(e);e.$watch("invitingCourseUsers",(function(e){if(e&&""===t.access_code){return r.get("/api/course/".concat(d,"/access_code")).success((function(e){return t.ui.resetable=e.resetable,e.access_code?m(e):e.resetable?t.resetAccessCodeAndUrl():void 0})).error((function(){}))}})),t.getJoinResult=e=>e.join(",");var v=function(t){return p.hide(),u.success(t.message),n("#course-invite-users-popup").foundation("reveal","close"),f(),e.$broadcast("invitationSend")},g=function(e,n,o){return o||(o=""),o=o.replace(/\s+/g,""),p.show(),r.post("/api/course/".concat(d,"/invites"),{emails:o.split(","),invite_type:e}).success(v).error((function(e){return p.hide(),t[n]=e.errors}))};t.sendInvite=e=>g(e,"inviteResponse",t.data.emails),t.sendOrgInvite=()=>g("team_teaching","orgInviteResponse",t.data.org_emails),t.clear=()=>f(),t.initTeamTeachingOrgs=function(){return p.show(),r.get("/api/toggle-opened-orgs?toggle=org_team_teaching").success((function(e){return p.hide(),t.orgs=e.orgs})).error((function(){return p.hide(),t.orgs=[]}))},t.course_invite_department_single_select_tree={keyword:""},t.searchTreeView=function(e){return"course_invite_department_single_select_tree"===e&&l.searchDepartmentTree(e,t,[])},t.initOrgDepartments=function(e){if(e){return p.show(),r.get("/api/orgs/".concat(e,"/departments")).success((function(e){return p.hide(),t.originalDepartments=e.departments,t.departments=o.copy(e.departments)})).error((function(){return p.hide(),t.departments=[],t.originalDepartments=[]}))}};var y=function(e){if(e&&t.user.keywords){var r=new RegExp("(".concat(t.user.keywords,")"),"gim");return e.replace(r,'<span class="search-keyword">$1</span>')}return e||""},w=function(e){if(p.hide(),(null!=e.users?e.users.length:void 0)>=0)return t.user.results=e.users,i.forEach(t.user.results,(function(e){return e.highlightedName=y(e.name),e.highlightedUserNo=y(e.user_no)})),t.user.hide=!1};t.searchUser=function(){if(!t.user.keywords||(t.orgAddError={missingOrg:!t.data.org_id,missingDepartment:""===t.data.department_id},t.orgAddError.missingOrg||t.orgAddError.missingDepartment))return t.user.hide=!0;p.show();var e={keywords:t.user.keywords,exclude_student_role:!0,org_id:t.data.org_id?t.data.org_id:void 0,department_id:t.data.org_id&&t.data.department_id?t.data.department_id:void 0};return r.get("/api/user/search",{params:e}).success(w).error((function(){return p.hide(),t.user.hide=!0}))},t.updateSearchUser=function(){if(!t.user.hide)return t.searchUser()},t.searchUserReset=function(){return t.user.hide=!0,t.user.keywords=""},t.addTeamTeaching=function(e){return t.user.team_teaching.push(e),t.user.hide=!0,null!=t.errors?delete t.errors.team_teaching:void 0},t.isAdded=e=>i.find(t.user.team_teaching,{id:e.id}),t.rmTeamTeaching=e=>i.remove(t.user.team_teaching,e);return t.addOrgTeamTeachings=function(){if(t.orgAddError={missingOrg:!t.data.org_id,missingDepartment:""===t.data.department_id,missingUser:0===t.user.team_teaching.length},i.some(i.values(t.orgAddError)))return null;var o={user_ids:i.map(t.user.team_teaching,(e=>e.id))};return p.show(),r.post("/api/courses/".concat(d,"/team-teaching"),o).success((function(t){return p.hide(),u.success(t.message),n("#course-invite-users-popup").foundation("reveal","close"),f(),e.$broadcast("enrollmentsAdded")})).error((function(e){return p.hide(),u.error(e.message)}))}}]},186021:function(e,t,r){var n=r(904072);r(324603),r(339714),r(804723);var o=r(180736);e.exports=["$scope","$http","$window",function(e,t,r){var i,a=o(e),s=new RegExp("^[0-9A-Z]{7,}$");e.error=null,e.accessCode="",n(document).on("opened.fndtn.reveal","#user-join-course-popup",(()=>n("#accessCode").focus())),e.join=function(){if(c()){return a.show(),t.get("/api/course/access-code/".concat(e.accessCode,"/validate")).success((function(){return a.hide(),e.error=null,e.onRedirecting=!0,r.location.href=i(e.accessCode)})).error((function(t){return a.hide(),e.error=e.validationError||t.message}))}},e.onAccessCodeChange=()=>e.error=null,e.reset=()=>e.$apply((function(){return e.error=null,e.accessCode=""}));var c=function(){var t=e.accessCode.match(s);return e.error=t?null:e.validationError,t};return i=e=>"".concat(r.location.protocol,"//").concat(r.location.host,"/course/join/").concat(e)}]},62174:function(e,t,r){var n=r(708468);e.exports=["$http","toastr",function(e,t){return{initExamsWithPage(r,o,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.noop,s="/api/courses/".concat(r,"/exam-list");return e.get(s,{params:o}).success(t.decorateSuccess(i)).error(t.decorateError(a))},saveExam(r,o,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.noop,s="/api/courses/".concat(r,"/exams");return e.post(s,o).success(t.decorateSuccess(i)).error(t.decorateError(a))},editExam(r,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.noop,a="/api/exams/".concat(r.id);return e.put(a,r).success(t.decorateSuccess(o)).error(t.decorateError(i))},deleteExam(r,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.noop;return e.delete("/api/exams/".concat(r)).success(t.decorateSuccess(o)).error(t.decorateError(i))},deleteExams(r,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.noop,a=n.map(r,"id");return e.delete("/api/exams/batch_delete",{data:{exam_ids:a}}).success(t.decorateSuccess(o)).error(t.decorateError(i))},checkExamQualification(t,r,o){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.noop;return e.get("/api/exam/".concat(t,"/check-exam-qualification?no-intercept=true"),{params:{check_status:r}}).success(o).error(i)},addExamineeAction(t,r,n,o){var i={exam:t,examinee:r,submission_id:n,type:o};return e.post("/api/exams/".concat(t,"/examinees/").concat(r,"/actions"),i)}}}]},499289:function(e,t,r){var n=r(708468),o=r(361204),i=r(904072);r(141817),r(702707),r(132023),r(804723);var a=r(881063);e.exports=["ExamSubject","$http","toastr",function(e,t,r){var s=function(e){var t=e.url;return{name:e.name,size:e.size,deleted:!1,description:e.description,submit_closed_time:e.submit_closed_time,status:"ready",source:e.source,type:e.type,video_urls:{QVGA:t+"/360p.mp4",VGA:t+"/480p.mp4",HD:t+"/720p.mp4"}}},c=function(t,r,i,a,s){t.timestamp=h(),t.subjectTypes=u(),"SHTVU"===t.upload.source?(t.ui.isLongerThanHour=!1,t.ui.duration=null):(t.ui.isLongerThanHour=p(t.upload)>=3600,t.ui.duration=p(t.upload)),t.allow_forward_seeking=s,r.subjects_timestamp=r.subjects_timestamp||{},t.subjectsTimestamp=r.subjects_timestamp,t.updateTimestampList&&t.updateTimestampList(),t.repoSubjects=i,t.subjects=n.map(o.copy(i),(t=>e.createSubjectBySavedSubject(t,a))),t.subjectsForCurrentTime=[],t.ui.isVideoPaused=!0,t.ui.intToChar=b,t.ui.calcOptionWidth=_,t.ui.getCorrectOptions=v,t.getSubjectIndex=(e,t)=>t+1,t.closeForReplay=function(){var e=g(t)-.4;e<0&&(e=0),y(t,e),t.subjectsForCurrentTime=[],t.errors={}}},u=function(){return{mapping:[{value:1,name:"single_selection"},{value:2,name:"multiple_selection"},{value:3,name:"true_or_false"}],getName(e){return n.find(this.mapping,{value:parseFloat(e)}).name},getValue(e){if(e)return n.find(this.mapping,{name:e}).value}}},l=function(e){if(e&&e.length>=1){var n=e[0];return n.videos&&n.videos.length>0?n.video_urls=a.getUrls(n):n.third_part_referrer_id&&t.get("/api/uploads/".concat(n.id,"?preview=true")).success((function(e){return n.video_urls=e.video_urls,n.duration=e.duration})).error(r.decorateError((function(){}))),n}return null},d=function(e){var t=e.match(/^(\d{2})([0-5]\d)([0-5]\d)$/);return t?3600*parseInt(t[1])+60*parseInt(t[2])+parseInt(t[3]):null},p=function(e){return!e||e.deleted?0:e.third_part_referrer_id||e.source&&!["mbz_import","imscc_import"].includes(e.source)?e.duration||0:e.videos[0].duration},f=function(e,t,r,n){i(".vjs-control-bar .vjs-progress-control .timestamp-point").remove();var o=i(".vjs-control-bar .vjs-progress-control"),a=p(e);return(()=>{var e=[];for(var s in t){var c=d(s);if(c>=0&&c<=a){var u=Math.round(c/a*1e4)/100,l=i("<div class='timestamp-point' style='left:calc(".concat(u,"% - 8px);'><i class='icon icon-time-point'></i></div>"));n&&(l=i(n(u))),o.append(l),r?e.push(l.click(r(c))):e.push(void 0)}else e.push(void 0)}return e})()},m=function(e){var t=n.parseInt(e)||0;return t>9?"".concat(t):"0".concat(t)},h=function(){return{hour:0,minute:0,second:0,asKey(){return"".concat(m(this.hour)).concat(m(this.minute)).concat(m(this.second))},parseTime(e){this.second=Math.floor(e%3600%60),this.minute=Math.floor(e%3600/60),this.hour=Math.floor(e/3600)}}},v=function(e){var t=n.filter(e.options,(e=>e.isCorrect||e.is_answer));return n.map(t,(e=>E.intToChar(e.sort))).sort().join(" ")},g=function(e){return e.useNewPlayer?e.player.currentTime:e.player.currentTime()},y=function(e,t){return e.useNewPlayer?e.player.currentTime=t:e.player.currentTime(t)},w=function(e,t,r,o,i){var a=null,s=null;e.player=t;var c=function(){var t=g(e);e.timestamp.parseTime(t);var r=e.timestamp.asKey();e.subjectsTimestamp[r]&&(r!==s||t<.4)&&(s=r,e.player.pause())},u=()=>r((function(){var t,r=g(e);if(e.timestamp.parseTime(r),s=e.timestamp.asKey(),r>.1)return t=e.subjectsTimestamp[s]||[],e.subjectsForCurrentTime=n.map(t,(t=>n.find(e.subjects,{id:t}))),i()}));e.updateCurrentTimestamp=u;var l=function(){a&&(o.cancel(a),a=null),e.ui.isVideoPaused=!0,u()};t.requestFullscreen=function(){};t.on("play",(function(){e.ui.isVideoPaused=!1,u(),a||(a=o(c,250))})),t.on("ended",l),t.on("pause",l)},b=e=>String.fromCharCode(65+e%26),_=function(e,t){return"vertical"!==t&&e&&0!==e.length?"".concat(Math.max(25,100/e.length),"%"):"auto"},S=-1,x=0,C=1,k=2,M=(e,t,r)=>{var o,i,a;return"multiple_selection"===r.type?o=function(e,t,r){var o=e.settings.point_rule,i=n.intersection(t,r).length,a=n.difference(t,r).length,s=e.point,c=0;"correct_count"===o?0===a&&(c=i===r.length?s:s/r.length*i):o&&"all_correct"!==o?"more_than_correct"===o&&(c=i>=e.settings.point_rule_minimum_count&&0===a?s:0):c=n.isEqual(t,r)?s:0;return 0===t.length?S:0===c?x:c>0&&c<s?k:C}(r,e,t):(a=t,o=0===(i=e).length?S:n.isEqual(i,a)?C:x),o},T=e=>n(e.subjectsForCurrentTime).filter((e=>!e.hasValidAnswer)).map((function(e){var t,r=n(e.options).filter({is_answer:!0}).map("id").value();return t="multiple_selection"===e.type?n(e.options).filter({checked:!0}).map("id").value():e.answeredOption?[Number(e.answeredOption)]:[],e.answerState=M(t,r,e),n.map(e.options,(e=>e.isChosen=t.includes(e.id)))})),E={initForInteraction:function(e,t,r,n){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(e.ui=e.ui||{},e.activity=t,t.interaction_activity_attributes&&t.interaction_activity_attributes.video_quiz)return e.videoQuiz=t.interaction_activity_attributes.video_quiz,e.videoQuizId=e.videoQuiz.id,e.ui.isOrgTransferArrears=t.is_transfer_arrears,e.ui.videoDescription=t.data.description,t.data.other_resource?e.upload=s(t.data.other_resource):e.upload=l(t.interaction_activity_attributes.video_quiz.uploads),c(e,e.videoQuiz,r,n,o)},initForVideoQuiz:function(e,t,r,n){return e.ui=e.ui||{},e.videoQuiz=t,e.upload=l(t.uploads),e.upload.video_src_type=t.video_src_type,e.ui.isOrgTransferArrears=t.is_transfer_arrears,e.ui.videoDescription=e.upload.name,c(e,t,r,n,!0)},initForPreview:function(e,t,r,n,o){t.ui=t.ui||{},t.ui.shouldShowAnswerAtTheCurrentTime=!1,e.inPreview=!0;var i=r.defer();t.answeredTimePoints=[];var a=function(){var e;return t.ui.shouldShowAnswerAtTheCurrentTime=(e=t.timestamp.asKey(),t.answeredTimePoints.includes(e))},s=e=>"<div class='timestamp-point' style='left:calc(".concat(e,"% - 4px);'><i class='icon icon-time-point'></i></div>");t.playerInitiated=function(e){return w(t,e,n,o,a),i.resolve(e)},t.submit=function(){return t.answeredTimePoints.push(t.timestamp.asKey()),t.ui.shouldShowAnswerAtTheCurrentTime=!0,T(t)},t.continue=()=>t.player.play();var c=e=>function(r){y(t,e),r.stopPropagation(),t.player.pause()};return i.promise.then((()=>f(t.upload,t.subjectsTimestamp,c,s)))},updateControlProgressPoints:f,timestampAsDuration:d,getSubjectAnswerState:M,getCorrectOptions:v,Timestamp:h,initiatePlayer:w,intToChar:b,calcOptionWidth:_,showAnswerExplanationWithInstructor:T,checkCanContinueBySubject:e=>{var t,r=e.activity.interaction_activity_attributes.answer_limit;return t=e.subjectsForCurrentTime.length,n(e.subjectsForCurrentTime).filter({answerState:1}).value().length==t&&"answer_correctly_to_continue"==r||"unlimited"==r}};return E}]},841789:function(e){e.exports=["$http","toastr",function(e,t){return{getBulletins(r,n,o,i,a){var s={bulletin_id:arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,page:r,page_size:n,conditions:o};return e.get("/api/org-bulletin/bulletins",{params:s}).success(i).error(t.decorateError(a))},getUnreadBulletins:(r,n)=>e.get("/api/org-bulletin/bulletins?fields=id",{params:{conditions:{unread:!0}}}).success(r).error(t.decorateError(n)),getDepartments(r,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i="fields=id,name,stopped&no-intercept=true&for-management=true&permission_obj=".concat(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"","&permission_act=").concat(o);return e.get("/api/departments?".concat(i)).success(r).error(t.decorateError(n))},getClassifications:(r,n)=>e.get("/api/org-bulletin/classifications").success(r).error(t.decorateError(n)),addBulletin:(r,n,o)=>e.post("/api/org-bulletin/bulletins",r).success(t.decorateSuccess(n)).error(t.decorateError(o)),deleteBulletin:(r,n,o)=>e.delete("/api/org-bulletin/bulletins/".concat(r)).success(t.decorateSuccess(n)).error(t.decorateError(o)),editBulletin:(r,n,o)=>e.put("/api/org-bulletin/bulletins/".concat(r.id),r).success(t.decorateSuccess(n)).error(t.decorateError(o)),markBulletinAsRead:(r,n,o)=>e.post("/api/org-bulletin/bulletins/".concat(r,"/read")).success(t.decorateSuccess(n)).error(t.decorateError(o))}}]},9075:function(e,t,r){var n=r(904072),o=r(708468),i=r(361204);r(788674),r(117727),e.exports=["service","toastr","$scope",function(e,t,r){var a=this;return a.successMsg="",a.currentJob=null,a.jobs=[],a.haveRunningJob=!0,a.selectedUsers=[],a.isTransferable=c,a.confirm=function(){c()&&a.confirmPopup.foundation("reveal","open")},a.createJob=function(){var r={users:o.map(a.selectedUsers,(e=>({user_no:e.user_no,name:e.name})))};e.createJob(r).then((e=>{a.selectedUsers=[],a.confirmPopup.foundation("reveal","close"),a.jobs.unshift(e),a.haveJobRunning=!0})).catch((()=>{t.warning()}))},a.view=function(t){a.currentJob=i.copy(t),a.jobDetailPopup.foundation("reveal","open"),r.loading=!0,e.getProcesses(a.currentJob).then((e=>{a.currentJob.processes=e})).finally((()=>{r.loading=!1}))},a.confirmPopup=n("#confirm-transfer-resources-popup"),a.jobDetailPopup=n("#job-detail-popup"),e.startPolling(s,(()=>{t.warning()})),a;function s(e){a.jobs=e;var r=a.haveJobRunning;a.haveJobRunning=!o.every(e,{status:"finished"}),!1===a.haveJobRunning&&!0===r&&t.success(a.successMsg)}function c(){return!a.haveJobRunning&&a.selectedUsers.length>0}}]},442247:function(e,t,r){var n=r(708468);e.exports=["$http","toastr","commonApi",function(e,t,r){return{course:r.course,departments:r.departments,grades:r.grades,classes:r.classes,instructors:r.instructors,users:r.users,changeEnrollmentRole:r.changeEnrollmentRole,deleteEnrollment:r.deleteEnrollment,editBulletin:r.editBulletin,classifications:r.resourceClassifications,updateOutline:(r,n,o)=>e.put("/api/course/".concat(r.id,"/outline"),r).success(t.decorateSuccess(n)).error(t.decorateError(o)),notifyOutlineEditing:(r,n,o)=>e.post("/api/outline/notify",{course_ids:r}).success(t.decorateSuccess(n)).error(t.decorateError(o)),syncFromUrp:(r,n,o)=>e.post("/api/courses/sync_from_urp",{course_ids:r}).success(t.decorateSuccess(n)).error(t.decorateError(o)),searchCourses:(r,o,i,a,s)=>(n.isEmpty(i.fields)&&(i.fields="id,name,academic_year,compulsory,course_code,semester,subject_code,department(id,name),course_attributes(student_count,audience_type,education_type,teaching_class_name),public_scope,status,grade(id,name),klass(id,name),instructors(id,name),course_outline,imported_from,course_type,allow_clone"),e.post("/api/courses?page=".concat(r,"&page_size=").concat(o,"&include_children_tenant"),i).success(a).error(t.decorateError(s))),searchResources:(r,n,o,i,a)=>e.get("/api/shared-resources/management",{params:{page:r,page_size:n,conditions:o}}).success(i).error(t.decorateError(a)),getVideoResourceGroups:(r,n,o,i,a)=>e.get("/api/shared-resources/stat/video-resources",{params:{page:r,page_size:n,conditions:o}}).success(i).error(t.decorateError(a)),exportResources:(r,n,o)=>e.get("/api/shared-resources/stat",{params:{conditions:r},responseType:"arraybuffer"}).success(n).error(t.decorateError(o)),exportVideoResources:(r,n,o)=>e.get("/api/shared-resources/stat/video-resources/export",{params:{conditions:r},responseType:"arraybuffer"}).success(n).error(t.decorateError(o)),exportCourses(r,n,o){return e({url:"/api/stat/courses/export/to/".concat(arguments.length>3&&void 0!==arguments[3]?arguments[3]:"xlsx"),method:"POST",responseType:"arraybuffer",data:r}).success(n).error(t.decorateError(o))},exportRollcallStat:(r,n,o)=>e.get("/api/stat/courses/rollcall/export",{params:{conditions:r},responseType:"arraybuffer"}).success(n).error(t.decorateError(o)),exportRollcallStatByClass:(r,n,o)=>e.get("/api/stat/courses/rollcall/export-by-class",{params:{conditions:r},responseType:"arraybuffer"}).success(n).error(t.decorateError(o)),exportHomeworkCorrect:(r,n,o)=>e.get("/api/stat/courses/homework-correct/export",{params:{conditions:r},responseType:"arraybuffer"}).success(n).error(t.decorateError(o)),addCourse:(r,n,o)=>e.post("/api/course",r).success(t.decorateSuccess(n)).error(t.decorateError(o)),updateCourse:(r,n,o)=>e.put("/api/courses/".concat(r.id),r).success(t.decorateSuccess(n)).error(t.decorateError(o)),deleteCourse:(r,n,o)=>e.delete("/api/course/".concat(r)).success(t.decorateSuccess(n)).error(t.decorateError(o)),updateCoursePublishStatus:(r,n,o,i)=>e.put("/api/courses/".concat(r,"/publish"),{published:n}).success(t.decorateSuccess(o)).error(t.decorateError(i)),getCourseCanUnPublished:(t,r,n)=>e.get("/api/courses/".concat(t,"/can-unpublished")).success(r).error(n),restoreCourse:(r,n,o)=>e.put("/api/courses/".concat(r,"/restore")).success(t.decorateSuccess(n)).error(t.decorateError(o)),batchUpdateCourseSettings:(r,n,o)=>e.put("/api/courses/settings",r).success(t.decorateSuccess(n)).error(t.decorateError(o)),addEnrollments:(r,n,o,i)=>e.post("/api/courses/".concat(r,"/enrollments"),n).success(o).error(t.decorateError(i)),getMembers:(r,n,o)=>e.get("/api/courses/".concat(r,"/members")).success(n).error(t.decorateError(o)),getCertifications:(r,n)=>e.get("/api/certifications").success(r).error(t.decorateError(n)),academicYears:r.academicYears,semesters:r.semesters,getBulletins:r.getBulletins,addBulletin:r.addBulletin,deleteBulletin:r.deleteBulletin,mySemesters:r.mySemesters,mySemestersAll:r.mySemestersAll,getCcLicenseGroups:r.getCcLicenseGroups,changeEnrollmentsRole:(r,n,o,i)=>e.put("/api/course/enrollments",{enrollment_ids:r,role:n}).success(o).error(t.decorateError(i)),deleteEnrollments:(r,n,o)=>e({url:"/api/course/enrollments",data:{enrollment_ids:r},method:"DELETE"}).success(n).error(t.decorateError(o)),getStatInfoForCourseInstructors:(t,r,n)=>e.get("/api/stat/courses/".concat(t,"/instructors")).success(r).error(n),getStatInfoForCourseStudents:(r,n,o)=>e.get("/api/stat/courses/".concat(r,"/students")).success(n).error(t.decorateError(o)),getDepartmentCourses:(r,n,o)=>e.get("/api/departments/".concat(r,"/courses")).success(t.decorateSuccess(n)).error(t.decorateError(o)),importCourses:(t,r,n)=>e.post("/api/data-import/courses",t).success(r).error(n),importEditCourses:(t,r,n)=>e.post("/api/data-import/edit-courses",t).success(r).error(n),importCoursesEnrollments:(t,r,n)=>e.post("/api/data-import/enrollments",t).success(r).error(n),importEnrollments:(t,r,n)=>e.post("/api/data-import/enrollments/".concat(t.courseId),t).success(r).error(n),importEnrollmentGraduates:(t,r,n)=>e.post("/api/data-import/enrollment-graduate",t).success(r).error(n),markBulletinAsRead:r.markBulletinAsRead,createPartnerAssociation:(r,n,o,i)=>e.post("/api/courses/".concat(r,"/associated-partner-info"),n).success(t.decorateSuccess(o)).error(t.decorateSuccess(i)),getPartnerAssociation:(t,r,n)=>e.get("/api/courses/".concat(t,"/associated-partner-info")).success(r).error(n),updatePartnerAssociation:(r,n,o,i)=>e.put("/api/courses/".concat(r,"/associated-partner-info"),n).success(t.decorateSuccess(o)).error(t.decorateSuccess(i)),getPartnerTypes:(t,r,n)=>e.get("/api/orgs/".concat(t,"/associated-partner-types")).success(r).error(n),recalculateCertificationScoreOfCourses:(r,n,o)=>e.put("/api/user/course-certification/scores",{course_ids:r}).success(t.decorateSuccess(n)).error(t.decorateError(o)),getCoursesCount(r,n,o){e.get("/api/courses/count",{params:{conditions:r}}).success(n).error(t.decorateError(o))},syncItriEnrollments:(t,r,n)=>e.put("/api/courses/".concat(t,"/sync-itri-enrollments")).success(r).error(n)}}]},354476:function(e,t,r){var n=r(708468),o=r(993776);function i(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw i}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r(185827),r(702707),r(140561),r(454747);var s=function(e,t){if(e.module_id=null,e.syllabus_id=null,((e,t)=>{(()=>{var r,o=[],a=i(t.modules);try{for(a.s();!(r=a.n()).done;){var s,c=r.value,u=i(c.directActivities);try{for(u.s();!(s=u.n()).done;){var l=s.value;l.prerequisites&&l.prerequisites.length>0&&n.remove(l.prerequisites,(t=>t.activity_id===e.id&&t.activity_type===e.type))}}catch(e){u.e(e)}finally{u.f()}o.push(c.syllabuses.map((t=>(()=>{var r,o=[],a=i(t.activities);try{for(a.s();!(r=a.n()).done;){var s=r.value;s.prerequisites&&s.prerequisites.length>0?o.push(n.remove(s.prerequisites,(t=>t.activity_id===e.id&&t.activity_type===e.type))):o.push(void 0)}}catch(e){a.e(e)}finally{a.f()}return o})())))}}catch(e){a.e(e)}finally{a.f()}})()})(e,t),"exam"===e.type)return e.referrer_id=t.id,e.referrer_type="course"};e.exports=function(){var e,t,r,a=(e=void 0,t=void 0,r=void 0,(a=class{static initClass(){e=e=>n.forEach(e,(e=>t(e))),t=function(e){if(e.activities)return e.activities=n.sortBy(e.activities,["sort","id"])},r=function(e,t){var r=[];return n.every(t.modules,(function(o){return r=n.remove(o.syllabuses,{id:e}),n.forEach(r,(e=>n.forEach(e.activities,(function(e){return n.remove(o.activities,e),n.remove(t.activities,e)})))),n.isEmpty(r)})),r}}constructor(e){this.course=e,this.id=this.course.id,this.name=this.course.name,function(e,t){t&&t.hasOwnProperty("settings")?(e.allow_create_module=t.settings.allow_create_module,e.allow_create_syllabus=t.settings.allow_create_syllabus,e.allow_resort_module=t.settings.allow_resort_module,e.allow_resort_syllabus=t.settings.allow_resort_syllabus):(e.allow_create_module=!0,e.allow_create_syllabus=!0,e.allow_resort_module=!0,e.allow_resort_syllabus=!0)}(this.course,this.course.templateSetting);var t=this.course.allow_resort_module,r=this.course.allow_resort_syllabus,o=this.course.templateSetting&&"skeleton"in this.course.templateSetting?this.course.templateSetting.skeleton:{};n.map(this.course.modules,(function(e){e.directActivities=[],e.allow_resort=t;var i=e.id in o?o[e.id]:{};e.from_template=e.id in o,e.allow_delete=!("allow_delete"in i)||i.allow_delete,e.allow_update=!("allow_update"in i)||i.allow_update;var a="syllabus"in i?i.syllabus:{};return n.map(e.syllabuses,(e=>{e.activities=[],e.allow_resort=r;var t=e.id in a?a[e.id]:{};e.from_template=e.id in a,e.allow_delete=!("allow_delete"in t)||t.allow_delete,e.allow_update=!("allow_update"in t)||t.allow_update})),e.activities=e.activities||[],n.map(e.activities,(function(t){if(t.syllabus_id){var r=n.find(e.syllabuses,{id:t.syllabus_id});return r?r.activities.push(t):void 0}e.directActivities.push(t)}))}))}getActivities(){var e=[];return n.each(this.course.modules,(function(t){return t.directActivities&&(e=e.concat(t.directActivities)),n.each(t.syllabuses,(function(t){if(t.activities)return e=e.concat(t.activities)}))})),e}getActivitiesByType(e){var t=this.getActivities(),r={};return n.each(t,(function(t){return t.type===e&&(r[t.id]=t),!0})),r}getSelectedActivitiesByType(e){var t=this.getActivitiesByType(e);return n.each(t,(function(e,r){return e.chosen||delete t[r],!0})),t}getHomeworkActivities(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";return n.reduce(this.course.modules,(function(t,r){return n.map(r.activities,(function(r){if(("all"===e||r.chosen)&&"homework"===r.type)return t[r.id]=r})),t}),{})}getClassroomActivities(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";return n.reduce(this.course.modules,((t,r)=>n.map(r.activities,(function(r){if(("all"===e||r.chosen)&&"classroom"===r.type)return t[r.id]=r}))),result,{})}loadingModule(e,t){var r=this.getModule(e);r&&(r.loading=t)}getSyllabus(e){var t,r=i(this.course.modules);try{for(r.s();!(t=r.n()).done;){var n,o=i(t.value.syllabuses);try{for(o.s();!(n=o.n()).done;){var a=n.value;if(a.id===e)return a}}catch(e){o.e(e)}finally{o.f()}}}catch(e){r.e(e)}finally{r.f()}}collectChosenActivities(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"chosen";return n.reduce(this.course.modules,((t,r)=>{return t.concat((o=r.activities,i=n.select(o,e),n.map(i,(e=>({activity_id:e.id,activity_type:e.type})))));var o,i}),[])}collectChosenModules(){var e=n.filter(this.course.modules,{chosen:!0});return n.map(e,(function(e){var t={module_id:e.id,syllabuses:[]};return n.forEach(e.syllabuses,(function(e){return e.chosen&&t.syllabuses.push({syllabus_id:e.id}),!0})),t}))}collectPreviewedActivities(){return n.reduce(this.course.modules,((e,t)=>{return e.concat((r=t.activities,o=n.filter(r,(e=>null!=e.data&&!0===e.data.is_previewed)),n.map(o,(e=>({activity_id:e.id,activity_type:e.type})))));var r,o}),[])}getSyllabuses(){return n.reduce(this.course.modules,((e,t)=>e.concat(t.syllabuses)),[])}getModule(e){return n.find(this.course.modules,{id:e})}sumScorePercentages(e){return n.reduce(e,((e,t)=>e.plus(t.score_percentage?new o(t.score_percentage):0)),new o(0))}addSyllabus(e){e.allow_resort=!0,e.allow_update=!0,e.allow_delete=!0,e.from_template=!1,e.activities=[];var t=this.getModule(e.module_id),r=t.syllabuses.length;return t.syllabuses.splice(r,0,e)}updateSyllabus(e,t){return r(e.id,this.course),this.insertNewSyllabus(e,t),this.sortSyllabus()}insertNewSyllabus(e,t){var r=this.getModule(parseInt(e.module_id));if(e.activities=t,r&&r.syllabuses.push(e),e.activities)return(()=>{var t,n=[],o=i(e.activities);try{for(o.s();!(t=o.n()).done;){var a=t.value;r&&(r.activities||(r.activities=[]),r.activities.push(a)),n.push(this.course.activities.push(a))}}catch(e){o.e(e)}finally{o.f()}return n})()}sortSyllabus(){return n.forEach(this.course.modules,(function(t){return t.syllabuses=n.sortBy(t.syllabuses,["sort","date"]),e(t.syllabuses)}))}deleteModule(e){var t=n.remove(this.course.modules,{id:e.id});return n.each(t,(e=>n.each(e.activities,(e=>s(e,this.course)))))}deleteSyllabus(e){var t=r(e.id,this.course);return n.each(t,(e=>n.each(e.activities,(e=>s(e,this.course)))))}regroupSyllabus(e){var t=n.reduce(this.course.modules,(function(e,t){return t.syllabuses.length=0,e[t.id]=t,e}),{});return n.forEach(e,(e=>t[e.module_id].syllabuses.push(e))),this.sortModules(),this.sortSyllabus()}sortModules(){this.course.modules=n.sortBy(this.course.modules,["sort","id"]);var e=0;return this.course.modules=n.forEach(this.course.modules,(t=>(t.first=0===e,t.last=e===this.course.modules.length-1,t.sort=e++)))}addModule(e){return e.allow_resort=!0,e.allow_update=!0,e.allow_delete=!0,e.from_template=!1,this.course.modules.push(e),this.sortModules()}hasSyllabus(){return n.any(this.course.modules,(e=>e.syllabuses.length>0))}hasModule(){return!n.isEmpty(this.course.modules)}hasPermission(e){return!this.course.hasOwnProperty(e)||this.course[e]}hasOnlyOneEmptyModule(){return 1===this.course.modules.length&&(e=>n.isEmpty(e.syllabuses)&&n.isEmpty(e.activities))(this.course.modules[0])}hasPermission(e){return!this.course.templateSetting.hasOwnProperty("settings")||this.course.templateSetting.settings[e]}defaultModuleId(){return this.course.modules.length>0?this.course.modules[0].id:null}filterByActivityType(e){return n.each(this.course.modules,(function(t){t.show=n.any(t.directActivities,{type:e}),n.map(t.syllabuses,(t=>t.show=n.any(t.activities,{type:e}))),t.show||(t.show=n.any(t.syllabuses,(e=>e.show)))}))}filterByGroupHomework(){return n.each(this.course.modules,(function(e){e.show=n.any(e.directActivities,(e=>"homework"===e.type&&e.submit_by_group)),n.map(e.syllabuses,(e=>e.show=n.any(e.activities,(e=>"homework"===e.type&&e.submit_by_group)))),e.show||(e.show=n.any(e.syllabuses,(e=>e.show)))}))}hasSyllabusWithActivityType(){return n.any(this.course.modules,(e=>e.show))}isOutlineEmpty(){var e="";return n.forEach(this.course.course_outline,(function(t,r){if(!["id","end_date","status"].includes(r)&&t)return e+=t})),""===e}}).initClass(),a);return a}},79980:function(e,t,r){var n=r(904072),o=r(708468),i=r(361204),a=r(293789);r(454747);var s=r(289895),c=r(180736);e.exports=["$rootScope","$scope","$http","toastr","$timeout","$interval",function(e,t,r,u,l,d){t.ui={showForm:!1};var p=s(),f=c(t),m=function(){return t.note={content:"",target_type:t.target_type,anchor:null,course_id:t.course_id,activity_id:t.activity_id,target_id:t.target_id},delete t.errors},h=()=>l((function(){return n(".note-form .note-content").focus(),100}));t.showAddNoteForm=function(){return t.note.anchor=0,"video"===t.note.target_type?t.note.anchor=Math.floor(t.player.theCurrentTime()):"document"===t.note.target_type&&(t.note.anchor=n("#file-previewer-with-note #pdf-viewer")[0].contentWindow.PDFViewerApplication.pdfViewer.currentPageNumber),t.ui.showForm=!0,h()},t.hideAddNoteForm=function(){return m(),t.ui.showForm=!1},t.formatAnchor=function(e){if(!e)return"";var t=e.anchor;return"video"===e.target_type?(p.parseTime(t),p.asKey()):t},t.seekToAnchor=function(e){var r=e.anchor;return"video"===e.target_type?t.player.theCurrentTime(r):"document"===e.target_type?n("#file-previewer-with-note #pdf-viewer")[0].contentWindow.PDFViewerApplication.pdfViewer.currentPageNumber=r:void 0},t.save=function(){var n;f.show();var i=function(e,r){return 400===r&&(t.errors=e.errors),f.hide()};return t.note.id?(n=function(r){r.order=r.updated_at?r.updated_at:r.created_at;var n=o.findIndex(t.notes,(e=>e.id===t.note.id));return t.notes[n]=r,t.hideAddNoteForm(),f.hide(),e.hasEdited=!0},r.put("/api/notes/".concat(t.note.id),t.note).success(n).error(u.decorateError(i))):(n=function(r){return r.order=r.updated_at?r.updated_at:r.created_at,t.notes.push(r),t.hideAddNoteForm(),f.hide(),e.hasEdited=!0},r.post("/api/notes",t.note).success(n).error(u.decorateError(i)))},t.editNote=function(e){return t.note=i.copy(e),t.ui.showForm=!0,h()},t.deleteNote=function(n){return r.delete("/api/notes/".concat(n)).success((function(){return o.remove(t.notes,(e=>e.id===n)),t.hideAddNoteForm(),e.hasEdited=!0})).error(u.decorateError((function(){})))};t.uploadCanAddNote=function(e){if(e)return["image","video"].includes(e.type)||"document"===e.type&&!e.isTextFile};if(t.$on("previewFile",(function(e,r,o,i){if(t.fileAddNote){if(!t.uploadCanAddNote(r))return"function"==typeof t.hideNoteBox?t.hideNoteBox():void 0;if(t.initData(o,r),i)return l((function(){var e;if("document"===i.target_type){var r=n("#file-previewer-with-note #pdf-viewer")[0];return e=d((function(){if(a.guard(a.guard(a.guard(null!=r?r.contentWindow:void 0,(e=>e.PDFViewerApplication)),(e=>e.pdfViewer)),(e=>e.getPageView(i.anchor-1))))return t.seekToAnchor(i),d.cancel(e)}),100)}if("video"===i.target_type)return e=d((function(){if(4===("function"==typeof(r=t.player).readyState?r.readyState():r.readyState))return t.seekToAnchor(i),t.player.play(),d.cancel(e);var r}),100)}),1e3)}})),t.initData=function(e,n){return e||(e=t.activity),t.course_id=e.course_id,t.activity_id=e.id,e&&!n?(t.target_id=e.uploads[0].id,t.target_type=e.uploads[0].type):(t.target_id=n.id,t.target_type=n.type),r.get("/api/notes?course_id=".concat(t.course_id,"&activity_id=").concat(t.activity_id,"&target_id=").concat(t.target_id)).success((e=>t.notes=o.forEach(e.notes,(e=>e.order=e.updated_at?e.updated_at:e.created_at)))).error(u.decorateError((function(){}))),m()},t.upload)return t.initData(t.activity,t.upload)}]},289895:function(e,t,r){var n=r(708468);e.exports=function(){var e=function(e){var t=n.parseInt(e)||0;return t>9?"".concat(t):"0".concat(t)};return{hour:0,minute:0,second:0,asKey(){return 0===this.hour?"".concat(e(this.minute),":").concat(e(this.second)):"".concat(e(this.hour),":").concat(e(this.minute),":").concat(e(this.second))},parseTime(e){this.second=Math.floor(e%3600%60),this.minute=Math.floor(e%3600/60),this.hour=Math.floor(e/3600)}}}},166555:function(e,t,r){var n=r(904072),o=r(708468);r(682772),r(132023),r(115306),e.exports=["$scope","$rootScope","$timeout","$window",(e,t,r,i)=>(e.notificationText=(t,r)=>{var n=e.notificationTypesAndText[t];if(!n)return"";var o=n[r];return o||""},e.getActivityIcon=e=>(e||"").replace(/_/g,"-"),e.openActivity=t=>{e.canOpenActivity(t)&&(i.location.href=t.url)},e.canOpenActivity=t=>!t.is_locked||(e.lockedActivity=t,n("#prerequisites-confirmation-popup").foundation("reveal","open"),!1),e.linkToActivity=t=>{if(!e.canOpenActivity(t))return!1;var r=t.course_id,n=t.activity_type,o=t.activity_id;switch(n){case"material":case"online_video":case"page":case"scorm":case"welink":case"tencent_meeting":case"classin":case"zoom":case"web_link":case"lesson":case"slide":case"homework":case"forum":case"chinamcloud_live":case"virtual_experiment":case"microsoft_teams_meeting":return i.location.href="/course/".concat(r,"/learning-activity#/").concat(o);case"exam":return i.location.href="/course/".concat(r,"/learning-activity#/exam/").concat(o);case"questionnaire":return i.location.href="/course/".concat(r,"/learning-activity/full-screen#/questionnaire/").concat(o);case"classroom":return i.location.href="/course/".concat(r,"/learning-activity#/classroom/").concat(o);case"lecture_live":return i.location.href="/course/".concat(r,"/live-activities#/").concat(o,"/detail");default:return""}},e.linkToBulletin=e=>"org"===e.type?"/bulletin-list/?type=org&bulletin_id=".concat(e.bulletin_id):"/bulletin-list/?type=course",e.linkToHomeworkActivity=e=>"/course/".concat(e.course_id,"/learning-activity#/").concat(e.homework_id),e.linkToAuditActivity=e=>"/course/".concat(e.course_id,"/learning-activity#/").concat(e.activity_id),e.linkToQuestionnaireActivity=e=>"/course/".concat(e.course_id,"/learning-activity#/questionnaire/").concat(e.questionnaire_id),e.linkToTopic=e=>e.group_id?"/course/".concat(e.course_id,"/group-set#/topics/").concat(e.topic_id,"?groupId=").concat(e.group_id):"/course/".concat(e.course_id,"/forum?show_sidebar=false#/topics/").concat(e.topic_id),e.linkToExamSubmissionInfo=e=>"/course/".concat(e.course_id,"/learning-activity#exam/").concat(e.activity_id,"/score-list"),e.linkToExam=t=>{e.canOpenActivity(t)&&(i.location.href="/course/".concat(t.course_id,"/learning-activity#/exam/").concat(t.exam_id))},e.linkToForumActivity=e=>"/course/".concat(e.course_id,"/learning-activity#/").concat(e.activity_id),e.linkToTeachingUnit=e=>"/course/".concat(e.course_id,"/content"),e.linkToBookLive=e=>e.course_id?"/course/".concat(e.course_id,"/live-activities#/").concat(e.live_id,"/detail"):e.book_live_url,e.linkToResearchMeeting=e=>"/course/".concat(e.course_id,"/teaching-team#/meeting/").concat(e.meeting_id),e.linkToResearchForum=e=>"/course/".concat(e.course_id,"/teaching-team#/forum/").concat(e.forum_id),e.linkToLearningProgressAlert=e=>"/management/learning-statistics/learning-progress#/".concat(e.course_id,"/alert-list"),e.linkToLearningWarning=e=>"/course/".concat(e.course_id,"/warning"),e.view=t=>(n("#instrucor-warning-info-popup").foundation("reveal","open"),e.warningInfo=t),e.teachingUnitName=t=>t.teaching_unit_type&&"teaching_class"===t.teaching_unit_type?e.teachingUnitNames.teaching_class:e.teachingUnitNames.course,e.teachingUnitRoleName=t=>e.teachingUnitRoleNames[t.teaching_unit_role],e.linkToTrackedUserResource=e=>"/shared-resource/user/".concat(e.tracked_user_id,"/track-user-resource"),e.linkToFollowerInfo=e=>"/shared-resource/user/".concat(e.follower_id,"/track-user-resource"),e.linkToResourceGroup=e=>"/user/resource-groups#/".concat(e.group_id,"/members"),e.link=t=>["shared_resource_audit_agree","shared_resource_audit_reject","shared_resource_reported","shared_resource_off_the_shelf","campus_subject_lib_audit_agree","campus_subject_lib_audit_reject","campus_subject_lib_off_the_shelf"].indexOf(t.type)>-1?"":["course_outline_edit","course_outline_closing_edit","course_completeness_alert","course_obe_unassociated_alert"].includes(t.type)?"/course/".concat(t.payload.course_id,"/outline"):o.includes(["submission_submitted","homework_ended","homework_expiring","homework_opened_for_submission","homework_opening_for_submission","homework_is_recommended","homework_is_recommended_group","has_recommend_homework","has_recommend_homework_group","recommend_homework_removed","inter_score_ended","inter_score_expiring","inter_score_homework_submission","homework_score_updated","course_homework_remind","course_homework_make_up","course_homework_resubmit","course_homework_review_remind"],t.type)?e.linkToHomeworkActivity(t.payload):"homework_submitted"===t.type?"".concat(e.linkToHomeworkActivity(t.payload),"?&view=scores"):o.includes(["activity_opening","activity_expiring","activity_opened","exam_submission"],t.type)?e.linkToActivity(t.payload):"course_opening"===t.type||"course_started"===t.type?"/course/".concat(t.payload.course_id,"/content"):o.includes(["bulletin_created","bulletin_updated"],t.type)?e.linkToBulletin(t.payload):o.includes(["reply_created","topic_replies","topic_secondary_replies","topic_like","topic_create"],t.type)?e.linkToTopic(t.payload):"user_join_course"===t.type||"user_exit_course"===t.type?"/course/".concat(t.payload.course_id,"/enrollments"):o.includes(["score_publish_closing","score_setting_changed","score_publish_reject"],t.type)?"/course/".concat(t.payload.course_id,"/score"):o.includes(["recent_plan_expire","plan_expired","recent_storage_run_out","storage_run_out","recent_transfer_run_out","transfer_run_out"],t.type)?"/management/plan":"instructor_submit_course_public_audit"===t.type?"/management/course/audit":"course_public_audit_response"===t.type?"/course/".concat(t.payload.course_id,"/content"):"org_plan_request"===t.type?"/wg-admin/request":"org_plan_response"===t.type?"/management/plan":["course_estimate_reply","course_estimate"].includes(t.type)?"/course/".concat(t.payload.course_id):"exam_submission_info"===t.type?e.linkToExamSubmissionInfo(t.payload):o.includes(["exam_opened","exam_expiring","exam_ended","exam_submit_started","exam_score_updated","exam_make_up"],t.type)?e.linkToExam(t.payload):o.includes(["discussion_create","discussion_score_updated"],t.type)?e.linkToForumActivity(t.payload):"new_resource_share_to_follower"===t.type?e.linkToTrackedUserResource(t.payload):"tracked_user_is_tracked"===t.type?e.linkToFollowerInfo(t.payload):"user_join_resource_group"===t.type?e.linkToResourceGroup(t.payload):"/user/index",e.confirmInvite=e=>(t.invitePayload=e,r((()=>n("#invite-confirm").foundation("reveal","open")))),e.weeklyDayTranslateForEnglish={"":"Mon","":"Tue","":"Wed","":"Thu","":"Fri","":"Sat","":"Sun"})]},148510:function(e,t,r){"use strict";r.r(t);var n=r(361204),o=r.n(n),i=r(370538),a=r(370618),s=r(473441),c=r(231078);a.S1({ignoreErrors:["top.GLOBALS","UnhandledRejection","ChunkLoadError","ResizeObserver loop limit exceeded","window.loadApps is not a function"],denyUrls:[/^chrome:\/\//i,/^chrome-extension:\/\//i,/^file:\/\//i],release:"1.58-dev",dsn:window.CONFIGS&&window.CONFIGS.sentryClientKey,tracesSampleRate:.2,integrations:[new s.j({angular:o()}),new c.w({Vue:i.default,attachProps:!0})]})},25536:function(e){e.exports=["$q",function(e){return class{constructor(e){this.blob=e,this.reader=new FileReader}read(){return this.deferred||(this.deferred=e.defer(),this.reader.onload=e=>this.deferred.resolve(e.target.result),this.reader.readAsArrayBuffer(this.blob)),this.deferred.promise}}}]},155360:function(e,t,r){var n=r(361204);r(230293),r(647301),e.exports=n.module("uploadModule",["ngFileUpload"]).factory("jobQueue",r(694771)).factory("uploadBlob",r(25536)).factory("uploadClass",r(150858)).factory("storageUploader",r(185514)).factory("uploadService",r(657886)).name},694771:function(e,t,r){var n=r(708468);e.exports=["$timeout",function(e){return new class{constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;this.concurrentJobNumber=e,this.queue=[],this.id=1}execute(){return(()=>{for(var e=[],t=0,r=n.min([this.queue.length,this.concurrentJobNumber]),o=0<=r;o?t<r:t>r;o?t++:t--){var i=this.queue[t];if("ready"===i.status){i.status="processing";var a=i.run();e.push(a.then((()=>(this.successCallback(i),this.jobDoneCallback(i))),(()=>(this.errorCallback(i),this.jobDoneCallback(i)))))}else e.push(void 0)}return e})()}push(e){return e.jobId=this.id,e.status="ready",this.queue.push(e),this.id+=1,this.execute()}removeFromQueue(e){return n.remove(this.queue,(t=>t.jobId===e))}jobDoneCallback(t){return e((()=>(this.removeFromQueue(t.jobId),this.execute())))}removeJob(e){var t=n.find(this.queue,(t=>t.jobId===e.jobId));return"processing"===e.status?t.delete():this.removeFromQueue(e.jobId)}isDone(){return 0===this.queue.length}bindCallback(e,t){return this.successCallback=e,this.errorCallback=t}}}]},150858:function(e,t,r){var n=r(361204),o=r(708468);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r(682772),r(66992),r(747042),r(788674),r(117727),r(333948),e.exports=["$rootScope","$http","$q","$timeout","Upload","uploadBlob",function(e,t,r,s,c,u){var l=t=>function(r){t.progress=parseInt(100*r.loaded/r.total);var n=(Date.now()-t.startTime)/1e3;return t.speed=n?r.loaded/n:0,s((()=>e.$apply()))};return class{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4194304;this.name=e.name,this.size=e.size,this.file=e,this.finished=!1,this.failed=!1,this.failedWithAMessage=!1,this.progress=0,this.isThirdPartResource=!1,this.blockSize=t,this.uploadedBlockCtxs=[],this.uptoken=null,this.isChunkMode=!0,this.allow_download=!0,this.metadata={}}updateUploadWithServerData(e){if(this.id=e.id,this.created_at=e.created_at,this.uploadUrl=e.upload_url,this.status=e.status,this.type=e.type,e.name&&(this.name=e.name),this.storageType=e.storage_type,this.transcoder=e.transcoder,e.is_cc_video&&(this.isCCVideo=e.is_cc_video),e.cc_info)return this.CCInfo=e.cc_info}abort(){return this.aborted=!0,this.abortRequest()}abortRequest(){if(this.isChunkMode){if(this.blockRequest)return this.blockRequest.abort.resolve()}else if(this.uploadRequest)return this.uploadRequest.abort()}resume(){return this.aborted=!1,this.uploadToServer()}delete(){return this.abort(),this.deleteUploadProgressLog()}run(){return this.uploadToServer()}getStorageKey(){return"".concat(this.name,"_").concat(this.type,"_").concat(this.size,"_").concat(this.file.lastModified)}getBlocks(){for(var e=[],t=0,r=Math.floor((this.file.size+this.blockSize-1)/this.blockSize),n=r>=0;n?t<r:t>r;n?t++:t--){var o=t*this.blockSize,i=this.file.slice(o,o+this.blockSize);e.push(new u(i))}return e}getBlob(e){return this.file.slice(e,e+this.blockSize)}getMetadata(){var e=r.defer();return"video"===this.type?(e=>{if(e.$ngfMediaMeta){var t=r.defer();return s((function(){t.resolve(e.$ngfMediaMeta)})),t.promise}if(e.$ngfMediaMetaPromise)return e.$ngfMediaMetaPromise;var o=r.defer();return s((function(){0===e.type.indexOf("audio")||0===e.type.indexOf("video")?c.dataUrl(e).then((t=>{var r=n.element(0===e.type.indexOf("audio")?"<audio>":"<video>").attr("src",t).css("visibility","none").css("position","fixed");function i(){e.$ngfDuration=r[0].duration,0===e.type.indexOf("video")&&(e.$ngfWidth=r[0].videoWidth,e.$ngfHeight=r[0].videoHeight),e.$ngfMediaMeta={duration:e.$ngfDuration,width:e.$ngfWidth||0,height:e.$ngfHeight||0},r.remove(),o.resolve(e.$ngfMediaMeta)}r.on("loadedmetadata",i),r.on("error",(function(){r.remove(),o.reject("load error")})),function e(){s((function(){r[0].parentNode&&(r[0].duration?i():e())}),1e3)}(),n.element(document.body).append(r)}),(function(){o.reject("load error")})):o.reject("not media")})),e.$ngfMediaMetaPromise=o.promise,e.$ngfMediaMetaPromise.finally((function(){delete e.$ngfMediaMetaPromise})),e.$ngfMediaMetaPromise})(this.file).then((t=>{this.metadata=t,e.resolve()}),(()=>{e.resolve()})):e.resolve(),e.promise}uploadToServer(){this.deferredUploadJob||(this.deferredUploadJob=r.defer()),this.startTime||(this.startTime=Date.now());var e=e=>(this.doSuccessfulUpload(e),this.deferredUploadJob.resolve(this)),n=()=>(this.doFailedUpload(),this.deferredUploadJob.reject(this)),a=r((e=>{e()}));return a=this.isCCVideo?this.uploadToBokeCC():"QINIU"===this.storageType?this.updateToken().then((()=>{var t=r.defer();if(window.FileAPI&&window.FileAPI.upload)this.uploadToQiniuServerFromIE9().then(e,n);else{this.blobs=this.getBlocks();var o=this.loadUploadProgressLog();o&&(Date.now()-o.timestamp>864e5?this.deleteUploadProgressLog():this.uploadedBlockCtxs=o.uploadedBlockCtxs),this.uploadToQiniuServerFromHtml5().then((()=>this.isChunkMode?this.makeFile().then((e=>(this.deleteUploadProgressLog(),t.resolve(e))),(e=>t.reject(e))):t.resolve()),(e=>t.reject(e)))}return t.promise})):this.uploadToLocalServer().then((e=>r((r=>{"S3"==this.storageType&&"WRPC"==this.transcoder&&t.post("/internal-api/upload/callback/".concat(this.id),{file_key:this.id}),r(e)})))),Promise.all([a,this.getMetadata()]).then((e=>{var t=i(e,2),r=t[0];t[1];return r})).then((e=>r((r=>{"video"===this.type&&this.metadata&&this.metadata.duration&&t.post("/api/uploads/".concat(this.id,"/videos"),{resolution:"ORIGINAL",duration:this.metadata.duration,width:this.metadata.width,height:this.metadata.height}).catch(o.noop),r(e)})))).then(e).catch(n),this.deferredUploadJob.promise}uploadToLocalServer(){return this.isChunkMode=!1,window.FileAPI&&window.FileAPI.upload?this.uploadToLocalServerFromIE9():this.uploadToLocalServerFromHtml5()}makeFile(){var e,r={"Content-Type":"text/plain;charset=UTF-8",Authorization:"UpToken ".concat(this.uptoken)},n="",o=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=a(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw i}}}}(this.uploadedBlockCtxs);try{for(o.s();!(e=o.n()).done;){var i=e.value;n="".concat(n+i,",")}}catch(e){o.e(e)}finally{o.f()}return n=n.slice(0,n.length-1),t.post("".concat(this.uploadUrl,"/mkfile/").concat(this.size),n,{headers:r})}uploadFromIE9(e){var t=r.defer(),n={url:this.uploadUrl,files:{file:[this.file]},progress:l(this),complete:function(e){return e?t.reject(e):t.resolve()}};return e||(n.headers={Authorization:"UpToken ".concat(this.uptoken)},n.data={token:this.uptoken}),this.uploadRequest=FileAPI.upload(n),t.promise}uploadToQiniuServerFromIE9(){this.isChunkMode=!1;return this.uploadFromIE9(!1)}uploadToQiniuServerFromHtml5(e){var t=e=>(this.uploadedBlockCtxs.push(e.data.ctx),this.saveUploadProgressLog(),this.uploadedBlockCtxs.length<this.blobs.length?this.uploadToQiniuServerFromHtml5(this.uploadedBlockCtxs.length):this.deferredBlobsJob.resolve(e)),o=e=>401===e.status?this.refreshToken().then((()=>this.uploadToQiniuServerFromHtml5(this.uploadedBlockCtxs.length)),(function(e){return this.deferredBlobsJob.reject(e)})):0===e.status?this.deferredBlobsJob.reject({aborted:!0}):this.deferredBlobsJob.reject(e),i=n.isDefined(e)?e:this.getFinishedIndex();return this.deferredBlobsJob||(this.deferredBlobsJob=r.defer()),this.blobs[i].read().then((e=>this.uploadBlockData(e).then(t,o))),this.deferredBlobsJob.promise}uploadToBokeCC(){var e=()=>(n.resolve(),this.notifyUploaded()),t=e=>n.reject(e),n=r.defer();return window.FileAPI&&window.FileAPI.upload?alert("Please update your browser to IE10+"):this.uploadCCMeta().then((()=>this.uploadToBokeCCFromH5().then(e,t))),n.promise}uploadCCMeta(){return t.get("".concat(this.CCInfo.metaurl,"?ccvid=").concat(this.CCInfo.videoid,"&uid=").concat(this.CCInfo.userid,"&filename=").concat(encodeURI(this.name),"&filesize=").concat(this.size,"&servicetype=").concat(this.CCInfo.servicetype))}notifyUploaded(){return t.put("/api/uploads/".concat(this.id,"/uploaded"))}uploadToBokeCCFromH5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.deferredBlobsJob||(this.deferredBlobsJob=r.defer()),this.uploadFileChunk2CC(e).then((e=>0===e.result?this.uploadToBokeCCFromH5(e.received):this.deferredBlobsJob.resolve(e)),(e=>-2===(null!=e?e.result:void 0)?this.uploadToBokeCCFromH5(e.received):this.deferredBlobsJob.reject(e))),this.deferredBlobsJob.promise}uploadFileChunk2CC(e){var t=r.defer(),n=this.getBlob(e),i=Date.now(),a=e=>(t.resolve(e),delete this.blockRequest),s=e=>(delete this.blockRequest,t.reject(e));if(this.aborted)t.reject({aborted:this.aborted});else{this.setBlockRequest();var c=new FormData;c.append("file",n);var u=new XMLHttpRequest;u.open("POST","".concat(this.CCInfo.chunkurl,"?ccvid=").concat(this.CCInfo.videoid)),u.setRequestHeader("Content-Range","bytes ".concat(e,"-").concat(e-1+n.size,"/").concat(this.size)),u.upload.addEventListener("progress",(t=>{var r=(Date.now()-i)/1e3;return this.speed=r?t.loaded/r:0,this.progress=o.parseInt(100*(e+t.loaded)/this.size)}),!1),u.send(c),u.onload=function(){if(200===u.status){var e=JSON.parse(u.response);return(null!=e?e.result:void 0)>=0?a(e):s(e)}return s(u)}}return t.promise}uploadToLocalServerFromIE9(){return this.uploadFromIE9(!0)}uploadToLocalServerFromHtml5(){var e=r.defer();return"S3"===this.storageType&&"WRPC"==this.transcoder?this.uploadRequest=c.http({url:this.uploadUrl,data:this.file,method:"PUT",headers:{"Content-Type":this.file.type}}):this.uploadRequest=c.upload({url:this.uploadUrl,data:{file:this.file},method:"PUT"}),this.uploadRequest.then((t=>e.resolve(t)),(t=>e.reject(t)),l(this)),e.promise}setBlockRequest(){return this.blockRequest={abort:r.defer()}}getFinishedIndex(){return this.uploadedBlockCtxs.length}saveUploadProgressLog(){var e={uploadedBlockCtxs:this.uploadedBlockCtxs,timestamp:Date.now()};return window.sessionStorage.setItem(this.getStorageKey(),JSON.stringify(e))}loadUploadProgressLog(){var e=this.getStorageKey();if(e)return JSON.parse(window.sessionStorage.getItem(e))}deleteUploadProgressLog(){return window.sessionStorage.removeItem(this.getStorageKey())}uploadBlockData(e){var t=r.defer(),n=Date.now();return this.aborted?t.reject({aborted:this.aborted}):(this.setBlockRequest(),c.http({url:"".concat(this.uploadUrl,"/mkblk/").concat(e.byteLength),data:e,headers:{Authorization:"UpToken ".concat(this.uptoken),"Content-Type":"application/octet-stream"},timeout:this.blockRequest.abort.promise}).then((e=>(t.resolve(e),delete this.blockRequest)),(e=>(delete this.blockRequest,t.reject(e))),(e=>{var t=e.loaded;return this.updateProgress(t),this.updateSpeed(n,t)}))),t.promise}updateProgress(e){var t=100*(this.getUploadedSize()+e);return this.progress=o.parseInt(t/this.size)}doSuccessfulUpload(t){return t&&t.data&&t.data.file_key&&(this.key=t.data.file_key),this.finished=!0,delete this.progress,delete this.speed,s((()=>e.$apply()))}doFailedUpload(){return this.failed=!0,delete this.progress,delete this.speed,s((()=>e.$apply()))}updateSpeed(e,t){var r=(Date.now()-e)/1e3;return this.speed=r?t/r:0}getUploadedSize(){return this.blockSize*this.uploadedBlockCtxs.length}updateToken(){var e=r.defer();return this.uptoken?e.resolve(this.uptoken):t.get("/api/uptoken?id=".concat(this.id)).success((t=>(this.uptoken=t.uptoken,e.resolve(t)))).error((t=>e.reject(t))),e.promise}refreshToken(){return this.uptoken=null,this.updateToken()}}}]},657886:function(e,t,r){var n=r(708468);r(324603),r(339714),e.exports=["$rootScope","$http","$q","uploadClass","jobQueue",function(e,t,r,o,i){e.uploads=[];return new class{constructor(e){this.jobQueue=e,this.config={}}uploadFiles(t){var r=[];return n.each(t,(t=>{var n=new o(t);return r.push(n),this.updateServerData(n).then((t=>(e.uploads.push(t),this.jobQueue.push(t))),(e=>(n.createFailed=!0,this.errorCallback(e))))})),r}updateConfig(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];this.config.parentId=o,this.config.parentType=e,this.config.isScorm=t,this.config.embedMaterialType=n,this.config.isWmpkg=r,this.config.source=i,this.config.isMarkedAttachment=a}bindCallback(e,t){return this.errorCallback=t,this.jobQueue.bindCallback(e,t)}updateServerData(e){var n=e.file,o={name:n.name,size:n.size,parent_type:this.config.parentType,parent_id:this.config.parentId,is_scorm:this.config.isScorm,is_wmpkg:this.config.isWmpkg,source:this.config.source,is_marked_attachment:this.config.isMarkedAttachment,embed_material_type:this.config.embedMaterialType},i=r.defer();return t.post("/api/uploads",o).success((function(t){return e.updateUploadWithServerData(t),i.resolve(e)})).error((e=>i.reject(e))),i.promise}checkFileFormat(e,t){return n.every(e,(e=>n.some(t,(t=>new RegExp(".".concat(t),"i").test(e.name)))))}checkFileSize(e,t){return n.every(e,(e=>e.size>0&&e.size<=t))}checkFiles(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return 0===r.length?this.checkFileSize(e,t):this.checkFileSize(e,t)&&this.checkFileFormat(e,r)}filterByFileSizeZero(e){return n.filter(e,(e=>0===e.size))}filterByFileSize(e,t){return n.filter(e,(e=>e.size>0&&e.size<=t))}filterByFileFormat(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return 0===t.length?e:n.filter(e,(e=>n.some(t,(t=>new RegExp(".".concat(t),"i").test(e.name)))))}deleteUploadingUpload(t){return this.jobQueue.removeJob(t),n.remove(e.uploads,(e=>e.id===t.id))}deleteUpload(e,r){return e.id?t.delete("/api/uploads/".concat(e.id)).success(r):r()}isUploading(){return!this.jobQueue.isDone()}humanizeBytes(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Math.round,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:" ",o=!0,i=["Bytes","KB","MB","GB","TB"];if(/floor/.test(r)&&(r=Math.floor),0===e)return"0 ".concat(i[0]);if(e<0){if(!t)return"0 ".concat(i[0]);o=!1,e=-e}var a=parseInt(Math.floor(Math.log(e)/Math.log(1024))),s=((a=a>3?3:a)>2?r(10*e/Math.pow(1024,a),2)/10:r(1*e/Math.pow(1024,a),2))+n+i[a];return o||(s="-".concat(s)),s}getUserCourseResourceFolder(e){return t.get("/api/user/course/".concat(e,"/resources/folder")).then((e=>e.data))}}(i)}]},581943:function(e,t,r){var n=r(904072),o=r(730381),i=r(708468),a=r(361204);r(141817),r(140561),r(115306),r(323123),r(454747);var s=r(887757);function c(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){c(i,n,o,a,s,"next",e)}function s(e){c(i,n,o,a,s,"throw",e)}a(void 0)}))}}r(535666);var l=r(554174).deleteActivity,d=r(180736);e.exports=["$scope","$rootScope","calendarApi","statHelper","toastr","$compile","$window",function(e,t,r,c,p,f,m){var h=d(e);n(document).on("closed.fndtn.reveal","[data-reveal]",(function(){if(e.showCalendar)return n("body").css("overflow","hidden")})),e.ui=e.ui||{},e.ui.inited=!1,e.eventSources=[[],[],[],[],[]],e.changeView=function(t){if(S(),e.ui.calendar.removeEventSources(),t&&(e.ui.currentView=t),"timetable"===e.ui.currentView)return T();if("event"===e.ui.currentView)return y();if("meeting"===e.ui.currentView)return w();if("instructionMeeting"===e.ui.currentView)b();else{if("cloudClassroom"!==e.ui.currentView)return e.isTimetableToggleOpen&&T(),b(),_(),w(),y();_()}},e.downloadBlob=function(e,t){if(!t.deleted)return c.track("calendar_event","download",{calendar_event_id:e.id,upload_id:t.id})},e.formatTime=e=>"".concat(o.utc(e).format("YYYY-MM-DD"),"T").concat(o.utc(e).format("HH:mm:ss"),"Z"),e.eventDrop=t=>e.$broadcast("bindEventDrop",t),e.addEventToCalendar=function(t){if(["event","all"].includes(e.ui.currentView))return e.eventSources[1].push(v(t))},e.updateEventInCalendar=function(t){var r=i.findIndex(e.eventSources[1],(e=>e.id===t.id));return e.eventSources[1][r]=v(t)},e.deleteEventFromCalendar=function(t){var r=i.findIndex(e.eventSources[1],(e=>e.id===t.id));return e.eventSources[1].splice(r,1)};var v=function(e){return{id:e.id,title:e.title,allDay:e.all_day,start:e.start_time,end:e.end_time,backgroundColor:e.color,data:e,editable:e.editable,uploads:e.uploads,type:"event"}},g=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#5879B4",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"meeting";t.description=t.data.description,t.join_url=t.data.join_url,t.live_addr=t.data.live_config.live_addr,t.color=r,t.replay_address=t.data.replay_address,t.host_user_id=t.host_user.id,t.scope_org_ids=t.participant_ids?t.participant_ids.split(","):[],t.is_started=o.utc()>o(t.start_time),t.is_ended=o.utc()>o(t.end_time);var i=!("agree"===t.audit_status&&t.is_started);"instructionMeeting"===n&&(i=!1);var a={id:t.id,title:t.title,start:e.formatTime(t.start_time),end:e.formatTime(t.end_time),backgroundColor:r,description:t.description,data:t,editable:i,type:n,course:t.teaching_unit,course_id:t.course_id,room:t.room};return a},y=function(){return r.getEvents((function(t){if(["event","all"].includes(e.ui.currentView))return e.eventSources[1]=[],i.each(t.events,(t=>e.eventSources[1].push(v(t))))}),(function(){}))},w=function(){return r.getCalendarMeeting((function(t){if(["meeting","all"].includes(e.ui.currentView))return e.eventSources[2]=[],i.each(t.calendar_meeting,(t=>e.eventSources[2].push(g(t))))}),(function(){}))};window.addEventListener("live-meeting-popup:close",(()=>{w()}));var b=function(){var t=u(s.mark((function t(){var n,o;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.getInstructionMeeting();case 2:n=t.sent,o=n.meetings,e.eventSources[3]=[],o.forEach((t=>{e.eventSources[3].push(g(t,"#7AB27C","instructionMeeting"))}));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),_=function(){var t=u(s.mark((function t(){var n,o;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.getCloudClassroomActivity(e.start,e.end);case 2:n=t.sent,o=n.cloud_classrooms,e.eventSources[4]=[],o.forEach((t=>{e.eventSources[4].push(g(t,"#99DE9B","cloudClassroom"))}));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();e.openMeeting=function(e){S(),"meeting"===e.type&&m.open(e.data.join_url,"_blank")},e.viewPlayBack=function(e){S(),"meeting"===e.type&&m.open(e.data.live_addr,"_blank")},e.viewLiveReplay=function(e){S(),"meeting"===e.type&&m.open(e.data.replay_address[0],"_blank")},e.editCalendar=function(t){return S(),"timetable"===t.type?e.$broadcast("bindTimetableForEdit",t):"meeting"===t.type?e.$broadcast("bindMeetingForEdit",t):e.$broadcast("bindEventForEdit",t)},e.editCloudClassroom=()=>{S()};e.deleteCalendar=function(t){return S(),"timetable"===t.type?k(t):"meeting"===t.type?C(t):"instructionMeeting"!==t.type?"cloudClassroom"===t.type?(t=>{e.confirm=u(s.mark((function r(){var o,i,a,c;return s.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=function(){p.success(),n("#calendar-confirmation-popup").foundation("reveal","close")},r.prev=1,r.next=4,l(t.id);case 4:o(),(i=e.eventSources[4].findIndex((e=>e.id===t.id)))>-1&&e.eventSources[4].splice(i,1),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(1),p.error(null===(a=r.t0.response)||void 0===a||null===(c=a.data)||void 0===c?void 0:c.message);case 12:case"end":return r.stop()}}),r,null,[[1,9]])}))),e.ui=e.ui||{},e.ui.titleBind=n("#deleteMeetingTitle").val(),e.ui.messageBind=n("#deleteMeetingText").val(),n("#calendar-confirmation-popup").foundation("reveal","open")})(t):x(t):void 0};var S=()=>(WebuiPopovers.hideAll(),n(".webui-popover.webui-popover-calendar.webui-no-padding.in").hide());e.closeCalendarDetailPopover=()=>S();var x=function(t){return e.confirm=function(){return r.deleteEvent(t,(function(){return p.success(),n("#calendar-confirmation-popup").foundation("reveal","close"),e.deleteEventFromCalendar(t)}))},n("#event-detail-popup").foundation("reveal","close"),e.ui=e.ui||{},e.ui.titleBind=n("#deleteEventTitle").val(),e.ui.messageBind=n("#deleteEventConfirmText").val(),n("#calendar-confirmation-popup").foundation("reveal","open"),null},C=function(t){e.confirm=function(){r.delCalendarMeeting(t.id,(function(){p.success(),n("#calendar-confirmation-popup").foundation("reveal","close")}));var o=e.eventSources[2].findIndex((e=>e.id===t.id));o>-1&&e.eventSources[2].splice(o,1)},e.ui=e.ui||{},e.ui.titleBind=n("#deleteMeetingTitle").val(),e.ui.messageBind=n("#deleteMeetingText").val(),n("#calendar-confirmation-popup").foundation("reveal","open")},k=function(t){return e.confirm=function(){var o={target_time:e.formatTime(t.start),update_scope:e.ui.update_scope};return h.show(),r.deleteTimetable(t.id,o,(function(t){return e.changeView(),p.success(t.message),h.hide(),n("#calendar-confirmation-popup").foundation("reveal","close")}),(function(){}))},n("#timetable-detail-popup").foundation("reveal","close"),e.ui=e.ui||{},e.ui.update_scope="current",e.ui.titleBind=n("#deleteTimetableTitle").val(),delete e.ui.messageBind,n("#calendar-confirmation-popup").foundation("reveal","open"),null},M=function(t,r,n){return{id:t.id,title:t.course_title,start:e.formatTime(r),end:e.formatTime(n),data:t,editable:t.editable,uploads:[],backgroundColor:t.color,type:"timetable"}},T=function(){return r.getTimetables((function(t){if(["timetable","all"].includes(e.ui.currentView))return e.eventSources[0]=[],i.each(t.timetables,(t=>function(t){var r,n=o.utc(t.start_time),a=o.utc(t.end_time);if(["week","custom"].includes(t.repeat_type)){r=o.utc(t.repeat_end_date);var s=t.repeat_frequency,c=t.repeat_weekly_days.split(",");return i.each(c,(function(o){var i=parseInt(o)-(n.day()||7);i=i<0?i+7*s:i;var c=n.clone().add(i,"days"),u=a.clone().add(i,"days");return(()=>{for(var o=[];c.isSame(n)||c.isBetween(n,r)||c.date()===r.date();)e.eventSources[0].push(M(t,c,u)),c.add(7*s,"days"),o.push(u.add(7*s,"days"));return o})()}))}return"day"===t.repeat_type?(r=o.utc(t.repeat_end_date),(()=>{for(var o=[];n.date()===r.date()||n.isBefore(r);)e.eventSources[0].push(M(t,n,a)),n.add(1,"days"),o.push(a.add(1,"days"));return o})()):e.eventSources[0].push(M(t,n,a))}(t)))}),(function(){}))},E=function(t){return e.currentCalendar=t,e.uploads=e.currentCalendar.uploads,e.activity=e.currentCalendar.data,e.currentCalendar.timeRange=function(t){var r=o(t.start),n=o(t.end),i="".concat(r.format("LL"),"").concat(e.weekDayMap[r.day()],"");if(t.allDay)return i;if(!n.isSame(r,"day")){var a="".concat(n.format("LL"),"").concat(e.weekDayMap[n.day()],"");return"".concat(i," ").concat(r.format("HH:mm")," -\n ").concat(a," ").concat(n.format("HH:mm"))}return"".concat(i," ").concat(r.format("HH:mm")," - ").concat(n.format("HH:mm"))}(t)},P=function(t){return S(),"timetable"===t||void 0===t&&"timetable"===e.ui.currentView?e.$broadcast("bindTimetableForNew"):"meeting"===t?document.getElementById("live-meeting-popup").getVueInstance().showCalendarMeetingPopup():e.$broadcast("bindEventForNew")};e.createNew=e=>P(e);var A=function(){switch(t.lang){case"zh-CN":return"zh-cn";case"zh-TW":case"zh-MO":return"zh-tw";default:return"en"}},F=e=>n("#moreText").val().replace("{0}",e);e.calendarOptions={locale:A(),timezone:"local",customButtons:{change:{richContent:f(a.element('<div class="types-filter">\n    <a href="javascript:void(0)" toggle-dropdown>\n        <span>[[ calendarViewMap[ui.currentView] ]]</span>\n        <i class="font font-down-arrow"></i>\n    </a>\n    <div class="dropdown-list hide">\n        <ul>\n            <li ng-if="isTimetableToggleOpen">\n                <a ng-click="changeView(\'timetable\')">\n                    <span ng-bind="calendarViewMap.timetable"></span>\n                </a>\n            </li>\n            <li>\n                <a ng-click="changeView(\'event\')">\n                    <span ng-bind="calendarViewMap.event"></span>\n                </a>\n            </li>\n            <li ng-if="isCloudClassroomToggleOpen">\n                <a ng-click="changeView(\'meeting\')">\n                    <span ng-bind="calendarViewMap.meeting"></span>\n                </a>\n            </li>\n            <li ng-if="isInstructionTeamToggleOpen">\n                <a ng-click="changeView(\'instructionMeeting\')">\n                    <span ng-bind="calendarViewMap.instructionMeeting"></span>\n                </a>\n            </li>\n            <li ng-if="isCloudClassroomToggleOpen">\n                <a ng-click="changeView(\'cloudClassroom\')">\n                    <span ng-bind="calendarViewMap.cloudClassroom"></span>\n                </a>\n            </li>\n            <li>\n                <a ng-click="changeView(\'all\')">\n                    <span ng-bind="calendarViewMap.all"></span>\n                </a>\n            </li>\n        </ul>\n    </div>\n</div>'))(e)},create:{richContent:f(a.element('<a class="button button-green create-button" href="javascript:void(0)" toggle-dropdown>\n    <i class="icon icon-add-white"></i><span class="create-text" ng-bind="i18nMessage.createText"></span>\n</a>\n<div class="dropdown-list hide calendar-add-dropdown-list">\n    <ul>\n        <li ng-if="isTimetableToggleOpen">\n            <a ng-click="createNew(\'timetable\')"><span ng-bind="calendarViewMap.timetable"></span></a>\n        </li>\n        <li>\n            <a ng-click="createNew(\'event\')"><span ng-bind="calendarViewMap.event"></span></a>\n        </li>\n        <li ng-if="!isStudent && isMasterOrg && isOpenUniversity">\n            <a ng-click="createNew(\'meeting\')"><span ng-bind="calendarViewMap.meeting"></span></a>\n        </li>\n    </ul>\n</div>'))(e),richText:'<i class="icon icon-add-white"></i>'.concat(n("#addText").val()),click:P}},header:{left:"change create",center:"prev title next",right:"today"},views:{month:{titleFormat:"YYYY.MM"}},firstDay:1,viewRender(t){var r;return e.start=t.start.format("YYYY-MM-DD HH:mm:ss"),e.end=t.end.format("YYYY-MM-DD HH:mm:ss"),e.ui.inited||(e.ui.inited=!0,e.ui.calendar=t.calendar,e.isTimetableToggleOpen?e.ui.currentView="timetable":e.ui.currentView=null!==(r=window.globalData)&&void 0!==r&&r.isOpenUniversity?"all":"event"),e.changeView()},eventLimit:!0,eventLimitText:F,eventTimeFormat:"HH:mm",eventClick(t){return(null!=e.currentCalendar?e.currentCalendar.start:void 0)===t.start&&n(this).attr("data-target")?n(this).webuiPopover("show"):(E(t),n(this).webuiPopover("destroy").webuiPopover({url:"#calendar-detail-popup",width:400,padding:!1,style:"calendar",arrow:!1,trigger:"manual"}).webuiPopover("show"))}}}]},393862:function(e,t,r){var n=r(361204),o=r(708468),i=r(904072),a=r(730381);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r(491038),r(339714),r(923157),r(454747);var l=r(180736),d=r(693604);e.exports=["$scope","calendarApi","$q","multiSelect",function(e,t,r,u){var p=l(e);e.errors={},e.ui={},e.uploads=[];var f=function(){return e.target_data={department_ids:[],role_ids:[],course_id:null,course_targets:[]},e.ui.showDepartmentTreeView=!1},m=function(){if(!e.ui.alerts&&e.ui.hasAlert)return t.getAlerts((t=>e.ui.alerts=t.alerts))},h=function(){var o;if(!o){o=r.defer();t.getDepartments((e=>o.resolve(e.departments)),(()=>o.resolve([])))}return o.promise.then((function(t){return e.ui.departments=n.copy(t),v(),e.ui.showDepartmentTreeView=!0}))},v=function(){if(e.target_data.department_ids.length>0){var t=function t(r){return o.contains(e.target_data.department_ids,r.id.toString())&&(r.selected=!0),r.departments.map((e=>t(e)))};return(()=>{var r,n=[],o=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=c(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}(e.ui.departments);try{for(o.s();!(r=o.n()).done;){var i=r.value;n.push(t(i))}}catch(e){o.e(e)}finally{o.f()}return n})()}},g=()=>u.multiSelect("#role-select",e.target_data.role_ids,!0,!1),y=function(){e.errors={};if(!e.ui.courses){var r=i("#userId").data("id");return t.getUserCourses(r,(function(t){return e.ui.courses=t.courses,o.each(e.ui.courses,(function(e){return e.course_code&&d.startsWith(e.course_code,"_uuid")?e.display_text=e.name:e.display_text="".concat(e.name," (").concat(e.course_code,")")}))}))}},w=function(n){if(n){var i=r.defer(),a=r.defer();return t.getGroups(n,(e=>i.resolve(e.groups))),t.getStudents(n,(e=>a.resolve(e.students))),r.all([i.promise,a.promise]).then((function(){var t=Array.from(arguments.length<=0?void 0:arguments[0]),r=s(t,2),n=r[0],i=r[1],a=[];return o.forEach(n,(e=>a.push({id:"g".concat(e.id),name:e.name}))),o.forEach(i,(e=>a.push({id:"s".concat(e.id),name:e.name}))),e.ui.courseTargets=a,u.multiSelect("#course-target-select",e.target_data.course_targets)}))}},b=function(){return e.event={title:"",all_day:!1,start_time:null,end_time:null,location:"",description:"",target_type:"self",target_data:{},alert_id:null,send_email_alert:!1,color:"blue",uploads:[]},e.uploads=[],function(){var t;(t=e.selectedDate?a.utc(e.selectedDate).local().hour(a().hour()).utc():a.utc()).add(1,"hour").startOf("hour");var r=t.clone().add(1,"hour");e.event.start_time=t.format(),e.event.end_time=r.format()}(),f(),e.ui.hasAlert=0,i("#event-popup").foundation("reveal","open")};return e.$on("bindEventForNew",(()=>b())),e.$on("bindEventForEdit",((t,r)=>function(t){switch(e.event=n.copy(t.data),e.uploads=n.copy(t.uploads),e.event.all_day&&(e.event.end_time=a.utc(e.event.end_time).add(-1,"day").format()),f(),e.event.target_type){case"department":e.target_data.department_ids=o.map(e.event.target_data.department_ids,(e=>e.toString())),h(),e.target_data.role_ids=o.map(e.event.target_data.role_ids,(e=>e.toString())),g();break;case"course":y(),e.target_data.course_id=e.event.target_data.course_id;var r=[];o.forEach(e.event.target_data.group_ids,(e=>r.push("g".concat(e)))),o.forEach(e.event.target_data.user_ids,(e=>r.push("s".concat(e)))),e.target_data.course_targets=r,w(e.target_data.course_id)}return e.ui.hasAlert=e.event.alert_id?1:0,m(),i("#event-popup").foundation("reveal","open")}(r))),e.$on("bindEventDrop",(function(r,o){var i=n.copy(o);i.start_time=a.utc(o.start_time).format(),i.end_time=a.utc(o.end_time).format();return t.updateEvent(i,(t=>e.updateEventInCalendar(t)),(function(t){return e.errors=t.errors,e.updateEventInCalendar(o)}))})),e.changeAllDay=function(){var t=a.utc(e.event.start_time),r=a.utc(e.event.end_time);if(e.event.all_day)t.local().startOf("day").utc(),r.local().startOf("day").utc();else{var n=a().hour();t.local().hour(n).add(1,"hour").startOf("hour").utc(),r.local().hour(n).add(2,"hour").startOf("hour").utc()}return e.event.start_time=t.format(),e.event.end_time=r.format()},e.showTargetType=()=>i(".target-type select option").length>1,e.changeTargetType=function(){switch(f(),e.event.target_type){case"department":return h(),g();case"course":return y()}},e.changeCourse=()=>w(e.target_data.course_id),e.changeHasAlert=function(){return e.event.alert_id=e.ui.hasAlert?100:null,m()},e.save=function(){var r;p.show();var s=function(t){return e.errors=t.errors,p.hide()},c=n.copy(e.event);switch(e.uploads&&(c.uploads=e.uploads.map((e=>e.id))),c.all_day&&(c.end_time=a.utc(c.end_time).add(1,"day").format()),c.target_type){case"department":if(0===e.target_data.department_ids.length)return void s({errors:{event_target_data_department_multi_select_tree:[e.i18nMessage.dataRequired]}});c.target_data={department_ids:o.map(e.target_data.department_ids,(e=>+e)),role_ids:o.map(e.target_data.role_ids,(e=>+e))};break;case"course":if(!e.target_data.course_id)return void s({errors:{target_data_course_id:[e.i18nMessage.dataRequired]}});var u=[],l=[];o.forEach(e.target_data.course_targets,(function(e){return d.startsWith(e,"s")?u.push(+e.substr(1)):d.startsWith(e,"g")?l.push(+e.substr(1)):void 0})),c.target_data={course_id:+e.target_data.course_id,user_ids:u,group_ids:l};break;default:c.target_data={}}return c.id?(r=function(t){return e.updateEventInCalendar(t),p.hide(),i("#event-popup").foundation("reveal","close")},t.updateEvent(c,r,s)):(r=function(t){return e.addEventToCalendar(t),p.hide(),i("#event-popup").foundation("reveal","close")},t.createEvent(c,r,s))},e.addFiles=t=>e.uploads=t.concat(e.uploads),e.deleteFile=t=>o.remove(e.uploads,t)}]},817382:function(e,t,r){var n=r(730381),o=r(904072),i=r(361204);r(294986),r(747042),r(132023),r(454747);var a=r(180736);e.exports=["$scope","calendarApi","$q","multiSelect","toastr",function(e,t,r,s,c){var u=a(e);e.errors={},e.ui={},e.orgs=[];var l=function(){var r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=t=>{if(e.orgs=t.orgs,r)return s.multiSelect("#orgs-select");var n="";e.orgs.forEach((t=>{e.meeting.scope_org_ids.includes(t.id+"")&&(n=n.concat(t.name).concat("; "))})),e.scope_orgs=n.slice(0,n.lastIndexOf(";"))};return t.getOrgs(n)},d=function(){var t,r=o("#userId").data("id"),i=o("#currentUserPhone").val();return e.can_edit=!0,e.meeting={title:"",start_time:null,end_time:null,data:{description:""},scope_org_ids:[],host_user:e.userCurrentName+"("+window.globalData.user.userNo+")("+i+")",host_user_id:r},l(),(t=n.utc()).add(10,"minute").startOf("minute"),e.meeting.start_time=t.format(),o("#calendar-meeting-popup").foundation("reveal","open")};e.$on("bindMeetingForNew",(()=>d())),e.$on("bindMeetingForEdit",((t,r)=>function(t){return e.can_edit="reject"===t.data.audit_status,e.meeting=i.copy(t.data),e.meeting.start_time=e.formatTime(t.data.start_time),e.meeting.end_time=e.formatTime(t.data.end_time),e.meeting.host_user=t.data.host_user.name+"("+t.data.host_user.user_no+")("+t.data.host_user.mobile_phone+")",e.can_edit&&(e.meeting.scope_org_ids=[]),l(e.can_edit),o("#calendar-meeting-popup").foundation("reveal","open")}(r))),e.save=function(){var r;u.show();var n=function(t){return e.errors=t.errors,t.message&&c.error(t.message),u.hide()},a=i.copy(e.meeting);return 0===a.scope_org_ids.length&&e.orgs.forEach((e=>a.scope_org_ids.push(e.id))),a.scope_org_ids=a.scope_org_ids.join(","),a.id?(r=function(t){return c.success(t.message),u.hide(),e.changeView("meeting"),o("#calendar-meeting-popup").foundation("reveal","close")},t.updateCalendarMeeting(a,r,n)):(r=function(t){return c.success(t.message),u.hide(),e.changeView("meeting"),o("#calendar-meeting-popup").foundation("reveal","close")},t.createCalendarMeeting(a,r,n))}}]},443746:function(e){e.exports=["calendarApi","$q",function(e,t){var r={},n=null,o=null;return{initUserCourses(n){if(r[n])return r[n].promise;return r[n]=t.defer(),e.getUserCourses(n,(e=>r[n].resolve(e.courses)),(()=>r[n].resolve([]))),r[n].promise},initTimetables(){if(n)return n.promise;return n=t.defer(),e.getTimetables((e=>n.resolve(e.timetables)),(()=>n.resolve([]))),n.promise},initEvents(){if(o)return o.promise;return o=t.defer(),e.getEvents((e=>o.resolve(e.events)),(()=>o.resolve([]))),o.promise},clearTimetableCache:()=>n=null,clearEventCache:()=>o=null}}]},350686:function(e,t,r){var n=r(904072),o=r(708468),i=r(730381),a=r(361204);r(682772),r(702707),r(140561),r(323123),r(923157);var s=r(180736),c=r(693604),u=r(905686);e.exports=["$scope","calendarApi","calendarRepository","toastr","$document",function(e,t,r,l,d){var p=s(e),f=n("#userId").data("id");e.weeklyDays=o.map(e.weekDayIso,((e,t)=>({name:e,val:t}))),e.defaultColors=["#800000","#FFD000","#000000","#7BA8D4","#002654","#A8497A"],e.errors={},e.showWeeklyDaysError=!1;var m=function(t){return e.courses=t,o.each(e.courses,(function(e){return e.course_code&&c.startsWith(e.course_code,"_uuid")?e.display_text=e.name:e.display_text="".concat(e.name," (").concat(e.course_code,")")}))};e.$on("bindTimetableForNew",(function(){var t=i.utc();t.add(1,"hour").startOf("hour");var o=t.clone().add(2,"hour");return e.timetable={course_id:0,course_title:"",instructors_names:"",start_time:t.format(),end_time:o.format(),repeat_type:"no_repeat",repeat_frequency:1,repeat_weekly_days:[],repeat_end_date:null,location:"",description:"",color:e.defaultColors[0]},r.initUserCourses(f).then((function(e){return m(e),n("#timetable-popup").foundation("reveal","open")}))})),e.$on("bindTimetableForEdit",(function(t,i){return e.timetable=a.copy(i.data),e.timetable.start_time=e.formatTime(i.start),e.timetable.end_time=e.formatTime(i.end),e.timetable.repeat_weekly_days=e.timetable.repeat_weekly_days?e.timetable.repeat_weekly_days.split(","):[],e.oldTimetable=a.copy(e.timetable),e.timetable.update_scope="current",e.timetable.origin_repeat_type=e.timetable.repeat_type,e.timetable.update_target_time=e.formatTime(i.start),e.timetable.send_ntf=!1,r.initUserCourses(f).then((function(t){e.courses||m(t);var r=o.find(e.courses,{id:parseInt(e.timetable.course_id)});return e.timetable.course_end_date=null!=r?r.end_date:void 0,n("#timetable-popup").foundation("reveal","open"),e.$watch("timetable",(function(t,r){if(t&&r){var n=r.start_time!==t.start_time,o=r.end_time!==t.end_time,i=t.update_scope!==r.update_scope,a=t.repeat_type!==r.repeat_type,s=t.repeat_frequency!==r.repeat_frequency,c=t.repeat_weekly_days.sort().join("")!==r.repeat_weekly_days.sort().join("");return n||o||i||a||s||c?e.timetable.ntf_content=u.generateNtfContent(e.oldTimetable,t):void 0}}),!0)}))})),d.on("close.fndtn.reveal","#timetable-popup",(()=>delete e.timetable)),e.changeCourse=function(){if(null!=e.errors&&delete e.errors.course_id,e.timetable.course_id){var t=o.find(e.courses,{id:parseInt(e.timetable.course_id)});return e.timetable.course_title=null!=t?t.display_text:void 0,e.timetable.course_end_date=null!=t?t.end_date:void 0,e.timetable.instructors_names=null!=t?t.instructors_names:void 0}},e.toggleSelectDay=function(t){var r=o.indexOf(e.timetable.repeat_weekly_days,t);return-1!==r?e.timetable.repeat_weekly_days.splice(r,1):e.timetable.repeat_weekly_days.push(t)},e.selectColor=t=>e.timetable.color=t;return e.save=function(){var r,o=function(t){return e.errors=t.errors,e.showWeeklyDaysError=Boolean(null!=e.errors?e.errors.repeat_weekly_days:void 0),p.hide()};p.show();var i=function(t){var r=a.copy(t);return r.send_ntf||delete r.ntf_content,"current"===e.timetable.update_scope&&(r.repeat_type="no_repeat"),"no_repeat"===r.repeat_type?(delete r.repeat_frequency,delete r.repeat_weekly_days,delete r.repeat_end_date):"day"===r.repeat_type?(delete r.repeat_frequency,delete r.repeat_weekly_days):"week"===r.repeat_type?(r.repeat_weekly_days=r.repeat_weekly_days.join(","),r.repeat_frequency=1):"custom"===r.repeat_type&&(r.repeat_weekly_days=r.repeat_weekly_days.join(",")),r}(e.timetable);return i.id?(r=function(t){return e.changeView(),l.success(t.message),p.hide(),n("#timetable-popup").foundation("reveal","close")},t.updateTimetable(i,r,o)):(r=function(t){return e.changeView(),l.success(t.message),p.hide(),n("#timetable-popup").foundation("reveal","close")},t.createTimetable(i,r,o))}}]},905686:function(e,t,r){var n=r(730381),o=r(708468);r(702707),r(323123);var i=function(e,t){var r,o=e.repeat_type,i=n(e.start_time).format("HH:mm"),a=n(e.end_time).format("HH:mm");if("current"===t||"no_repeat"===o){var c=n(e.start_time),u=c.month()+1,l=c.date();return"".concat(u,"").concat(l,"").concat(i,"-").concat(a)}if("day"===o)return"".concat(i,"-").concat(a);if("week"===o)return r=s(e.repeat_weekly_days),"".concat(r).concat(i,"-").concat(a);if("custom"===o){var d=e.repeat_frequency;return r=s(e.repeat_weekly_days),"".concat(d,"").concat(r).concat(i,"-").concat(a)}},a={1:"",2:"",3:"",4:"",5:"",6:"",7:""},s=function(e){return e="string"==typeof e?e.split(","):e,o.map(e.sort(),(e=>""+a[e])).join("")};e.exports={generateNtfContent(e,t){var r=e.course_title,o=function(e){if("current_and_after"!==e.update_scope)return"";var t=n(e.update_target_time),r=t.month()+1,o=t.date();return"".concat(r,"").concat(o,"")}(t),a=i(e,t.update_scope),s=i(t,t.update_scope);return"".concat(r,"").concat(o,"").concat(a,"").concat(s,"")}}},875966:function(e,t,r){var n=r(708468);e.exports=["$http","toastr",function(e,t){return{getEvents(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.noop;return e.get("/api/calendar-events?no-intercept=true").success(r).error(t.decorateError(o))},createEvent(r,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.noop;return e.post("/api/calendar-events",r).success(o).error(t.decorateError(i))},updateEvent(r,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.noop;return e.put("/api/calendar-events/".concat(r.id),r).success(o).error(t.decorateError(i))},getOrgs:t=>e.get("/api/org").success(t),deleteEvent(r,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.noop;return e.delete("/api/calendar-events/".concat(r.id)).success(o).error(t.decorateError(i))},getAlerts(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.noop;return e.get("/api/calendar-alerts?no-intercept=true").success(r).error(t.decorateError(o))},getDepartments(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.noop;return e.get("/api/departments?no-intercept=true").success(r).error(t.decorateError(o))},getUserCourses(r,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.noop,a="/api/calendar-events/users/".concat(r,"/courses?no-intercept=true");return e.get(a).success(o).error(t.decorateError(i))},getGroups:(r,n)=>e.get("/api/courses/".concat(r,"/groups?no-intercept=true")).success(n).error(t.decorateError()),getStudents:(r,n)=>e.get("/api/course/".concat(r,"/students?no-intercept=true")).success(n).error(t.decorateError()),getTimetables(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.noop;return e.get("/api/calendar-timetables?no-intercept=true").success(r).error(t.decorateError(o))},createTimetable(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.noop;return e.post("/api/calendar-timetables",t).success(r).error(o)},updateTimetable(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.noop;return e.put("/api/calendar-timetables/".concat(t.id),t).success(r).error(o)},deleteTimetable(t,r,o){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.noop;return e.put("/api/calendar-timetables/".concat(t,"/delete"),r).success(o).error(i)},createCalendarMeeting(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.noop;return e.post("/api/calendar-meeting",t).success(r).error(o)},getCalendarMeeting(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.noop;return e.get("/api/calendar-meeting").success(r).error(t.decorateError(o))},delCalendarMeeting(r,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.noop;return e.delete("/api/calendar-meeting/".concat(r)).success(o).error(t.decorateError(i))},updateCalendarMeeting(r,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.noop;return e.put("/api/calendar-meeting/".concat(r.id),r).success(o).error(t.decorateError(i))},getCalendarMeetingForManagement(t,r,o,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n.noop;return e.post("/api/management/calendar-meeting?page=".concat(t,"&page_size=").concat(r),o).success(i).error(a)},getCalendarMeetingForManagementExcel(r,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.noop;return e({url:"/api/management/calendar-meeting/excel",method:"POST",responseType:"arraybuffer",data:r}).success(o).error(t.decorateError(i))},getCloudClassroomActivity:(t,r)=>e.get("/api/activity/cloud-classroom?start=".concat(t,"&end=").concat(r)).then((e=>e.data)),getInstructionMeeting:()=>e.get("/api/instruction-team/meeting").then((e=>e.data))}}]},933533:function(e,t,r){var n=r(904072),o=r(693604);e.exports=["$rootScope","$scope","$timeout","toastr","filesApi",function(e,t,r,i,a){var s;t.humanizeBytes=o.humanizeBytes,r((function(){return s()})),e.$on("refreshStorageBar",(()=>s()));return s=function(){return a.getStorageUsed((function(e){var o=e.storage_used,i=t.maxSize;return t.ui={usedPercent(){return e=o,t=i,(r=Math.round(e/t*100))>100?"100%":"".concat(r,"%");var e,t,r},unusedPercent(){return e=o,t=i,(r=Math.round((t-e)/t*100))<0?"0%":"".concat(r,"%");var e,t,r},backgroundColor:()=>o/i<.8?"#2BD3D7":"#F14173",usedRadius:()=>function(e,t){if(Math.round(e/t*100)>=100)return"3px"}(o,i),unusedRadius:()=>function(e,t){if(Math.round(e/t*100)<=0)return"3px"}(o,i)},r((function(){return function(e,r){return n(".storage-used-number").text(t.humanizeBytes(e,!1,"floor")),n(".storage-unused-number").text(t.humanizeBytes(r-e,!1,"floor"))}(o,i)}))}))}}]},397416:function(e,t,r){var n=r(708468);e.exports=["$http","toastr",function(e,t){return{getStorageUsed:r=>e.get("/api/user/storage-used").success(r).error(t.decorateError()),createLink:t=>e.post("/api/user/links",t),editLink:(t,r)=>e.put("/api/user/links/".concat(t),r),getUploadReferenceDetail(t,r,o,i,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:n.noop;return e.get("/api/uploads/".concat(t,"/references"),{params:{page:r,page_size:o,conditions:i}}).success(a).error(s)},getResourceReferenceDetail(t,r,o,i,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:n.noop;return e.get("/api/resources/".concat(t,"/activities"),{params:{page:r,page_size:o,conditions:i}}).success(a).error(s)}}}]},647802:function(e,t,r){function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r(491038),e.exports=["$rootScope","$scope","videoQuizRepository","$q","$timeout","interactionHelper","$interval",function(e,t,r,o,i,a,s){t.canContinue=()=>!0;var c,u;return c=r.initSubjects(t.videoQuizId),u=r.initVideoQuiz(t.videoQuizId),o.all([u,c]).then((function(){var r=Array.from(arguments.length<=0?void 0:arguments[0]),c=n(r,2),u=c[0],l=c[1];return a.initForVideoQuiz(t,u,l),a.initForPreview(e,t,o,i,s)}))}]},985592:function(e){e.exports=["$http","$q",function(e,t){var r={},n={};return{initVideoQuiz(n){if(r[n])return r[n].promise;r[n]=t.defer();return e.get("/api/video-quizzes/".concat(n)).success((e=>r[n].resolve(e))).error((()=>r[n].resolve())),r[n].promise},initSubjects(r){if(n[r])return n[r].promise;n[r]=t.defer();return e.get("/api/video-quizzes/".concat(r,"/subjects")).success((e=>n[r].resolve(e.subjects))).error((()=>n[r].resolve([]))),n[r].promise}}}]},501801:function(e,t,r){"use strict";r.r(t)},979262:function(e,t,r){var n;e=r.nmd(e),function(){"use strict";var o={function:!0,object:!0},i=o[typeof window]&&window||this,a=o[typeof t]&&t,s=o.object&&e&&!e.nodeType&&e,c=a&&s&&"object"==typeof r.g&&r.g;!c||c.global!==c&&c.window!==c&&c.self!==c||(i=c);var u=Math.pow(2,53)-1,l=/\bOpera/,d=Object.prototype,p=d.hasOwnProperty,f=d.toString;function m(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function h(e){return e=b(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:m(e)}function v(e,t){for(var r in e)p.call(e,r)&&t(e[r],r,e)}function g(e){return null==e?m(e):f.call(e).slice(8,-1)}function y(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function w(e,t){var r=null;return function(e,t){var r=-1,n=e?e.length:0;if("number"==typeof n&&n>-1&&n<=u)for(;++r<n;)t(e[r],r,e);else v(e,t)}(e,(function(n,o){r=t(r,n,o,e)})),r}function b(e){return String(e).replace(/^ +| +$/g,"")}var _=function e(t){var r=i,n=t&&"object"==typeof t&&"String"!=g(t);n&&(r=t,t=null);var o=r.navigator||{},a=o.userAgent||"";t||(t=a);var s,c,u,d,p,m=n?!!o.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(f.toString()),_="Object",S=n?_:"ScriptBridgingProxyObject",x=n?_:"Environment",C=n&&r.java?"JavaPackage":g(r.java),k=n?_:"RuntimeObject",M=/\bJava/.test(C)&&r.java,T=M&&g(r.environment)==x,E=M?"a":"",P=M?"b":"",A=r.document||{},F=r.operamini||r.opera,I=l.test(I=n&&F?F["[[Class]]"]:g(F))?I:F=null,$=t,R=[],U=null,B=t==a,O=B&&F&&"function"==typeof F.version&&F.version(),L=w([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],(function(e,r){return e||RegExp("\\b"+(r.pattern||y(r))+"\\b","i").exec(t)&&(r.label||r)})),j=function(e){return w(e,(function(e,r){return e||RegExp("\\b"+(r.pattern||y(r))+"\\b","i").exec(t)&&(r.label||r)}))}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),z=N([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),D=function(e){return w(e,(function(e,r,n){return e||(r[z]||r[/^[a-z]+(?: +[a-z]+\b)*/i.exec(z)]||RegExp("\\b"+y(n)+"(?:\\b|\\w*\\d)","i").exec(t))&&n}))}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),V=function(e){return w(e,(function(e,r){var n=r.pattern||y(r);return!e&&(e=RegExp("\\b"+n+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=function(e,t,r){var n={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&r&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(n=n[/[\d.]+$/.exec(e)])&&(e="Windows "+n),e=String(e),t&&r&&(e=e.replace(RegExp(t,"i"),r)),h(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(e,n,r.label||r)),e}))}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function N(e){return w(e,(function(e,r){var n=r.pattern||y(r);return!e&&(e=RegExp("\\b"+n+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+n+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+n+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(r.label&&!RegExp(n,"i").test(r.label)?r.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),r=r.label||r,e=h(e[0].replace(RegExp(n,"i"),r).replace(RegExp("; *(?:"+r+"[_-])?","i")," ").replace(RegExp("("+r+")[-_.]?(\\w)","i"),"$1 $2"))),e}))}function W(e){return w(e,(function(e,r){return e||(RegExp(r+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null}))}if(L&&(L=[L]),/\bAndroid\b/.test(V)&&!z&&(s=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(t))&&(z=b(s[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),D&&!z?z=N([D]):D&&z&&(z=z.replace(RegExp("^("+y(D)+")[-_.\\s]","i"),D+" ").replace(RegExp("^("+y(D)+")[-_.]?(\\w)","i"),D+" $2")),(s=/\bGoogle TV\b/.exec(z))&&(z=s[0]),/\bSimulator\b/i.test(t)&&(z=(z?z+" ":"")+"Simulator"),"Opera Mini"==j&&/\bOPiOS\b/.test(t)&&R.push("running in Turbo/Uncompressed mode"),"IE"==j&&/\blike iPhone OS\b/.test(t)?(D=(s=e(t.replace(/like iPhone OS/,""))).manufacturer,z=s.product):/^iP/.test(z)?(j||(j="Safari"),V="iOS"+((s=/ OS ([\d_]+)/i.exec(t))?" "+s[1].replace(/_/g,"."):"")):"Konqueror"==j&&/^Linux\b/i.test(V)?V="Kubuntu":D&&"Google"!=D&&(/Chrome/.test(j)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(z))||/\bAndroid\b/.test(V)&&/^Chrome/.test(j)&&/\bVersion\//i.test(t)?(j="Android Browser",V=/\bAndroid\b/.test(V)?V:"Android"):"Silk"==j?(/\bMobi/i.test(t)||(V="Android",R.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&R.unshift("accelerated")):"UC Browser"==j&&/\bUCWEB\b/.test(t)?R.push("speed mode"):"PaleMoon"==j&&(s=/\bFirefox\/([\d.]+)\b/.exec(t))?R.push("identifying as Firefox "+s[1]):"Firefox"==j&&(s=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(V||(V="Firefox OS"),z||(z=s[1])):!j||(s=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(j))?(j&&!z&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(s+"/")+8))&&(j=null),(s=z||D||V)&&(z||D||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(V))&&(j=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(V)?V:s)+" Browser")):"Electron"==j&&(s=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&R.push("Chromium "+s),O||(O=W(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",y(j),"(?:Firefox|Minefield|NetFront)"])),(s=("iCab"==L&&parseFloat(O)>3?"WebKit":/\bOpera\b/.test(j)&&(/\bOPR\b/.test(t)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(L)&&"WebKit"||!L&&/\bMSIE\b/i.test(t)&&("Mac OS"==V?"Tasman":"Trident")||"WebKit"==L&&/\bPlayStation\b(?! Vita\b)/i.test(j)&&"NetFront")&&(L=[s]),"IE"==j&&(s=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(j+=" Mobile",V="Windows Phone "+(/\+$/.test(s)?s:s+".x"),R.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(j="IE Mobile",V="Windows Phone 8.x",R.unshift("desktop mode"),O||(O=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=j&&"Trident"==L&&(s=/\brv:([\d.]+)/.exec(t))&&(j&&R.push("identifying as "+j+(O?" "+O:"")),j="IE",O=s[1]),B){if(d="global",p=null!=(u=r)?typeof u[d]:"number",/^(?:boolean|number|string|undefined)$/.test(p)||"object"==p&&!u[d])g(s=r.runtime)==S?(j="Adobe AIR",V=s.flash.system.Capabilities.os):g(s=r.phantom)==k?(j="PhantomJS",O=(s=s.version||null)&&s.major+"."+s.minor+"."+s.patch):"number"==typeof A.documentMode&&(s=/\bTrident\/(\d+)/i.exec(t))?(O=[O,A.documentMode],(s=+s[1]+4)!=O[1]&&(R.push("IE "+O[1]+" mode"),L&&(L[1]=""),O[1]=s),O="IE"==j?String(O[1].toFixed(1)):O[0]):"number"==typeof A.documentMode&&/^(?:Chrome|Firefox)\b/.test(j)&&(R.push("masking as "+j+" "+O),j="IE",O="11.0",L=["Trident"],V="Windows");else if(M&&($=(s=M.lang.System).getProperty("os.arch"),V=V||s.getProperty("os.name")+" "+s.getProperty("os.version")),T){try{O=r.require("ringo/engine").version.join("."),j="RingoJS"}catch(e){(s=r.system)&&s.global.system==r.system&&(j="Narwhal",V||(V=s[0].os||null))}j||(j="Rhino")}else"object"==typeof r.process&&!r.process.browser&&(s=r.process)&&("object"==typeof s.versions&&("string"==typeof s.versions.electron?(R.push("Node "+s.versions.node),j="Electron",O=s.versions.electron):"string"==typeof s.versions.nw&&(R.push("Chromium "+O,"Node "+s.versions.node),j="NW.js",O=s.versions.nw)),j||(j="Node.js",$=s.arch,V=s.platform,O=(O=/[\d.]+/.exec(s.version))?O[0]:null));V=V&&h(V)}if(O&&(s=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(O)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(B&&o.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(U=/b/i.test(s)?"beta":"alpha",O=O.replace(RegExp(s+"\\+?$"),"")+("beta"==U?P:E)+(/\d+\+?/.exec(s)||"")),"Fennec"==j||"Firefox"==j&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(V))j="Firefox Mobile";else if("Maxthon"==j&&O)O=O.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(z))"Xbox 360"==z&&(V=null),"Xbox 360"==z&&/\bIEMobile\b/.test(t)&&R.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(j)&&(!j||z||/Browser|Mobi/.test(j))||"Windows CE"!=V&&!/Mobi/i.test(t))if("IE"==j&&B)try{null===r.external&&R.unshift("platform preview")}catch(e){R.unshift("embedded")}else(/\bBlackBerry\b/.test(z)||/\bBB10\b/.test(t))&&(s=(RegExp(z.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||O)?(V=((s=[s,/BB10/.test(t)])[1]?(z=null,D="BlackBerry"):"Device Software")+" "+s[0],O=null):this!=v&&"Wii"!=z&&(B&&F||/Opera/.test(j)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==j&&/\bOS X (?:\d+\.){2,}/.test(V)||"IE"==j&&(V&&!/^Win/.test(V)&&O>5.5||/\bWindows XP\b/.test(V)&&O>8||8==O&&!/\bTrident\b/.test(t)))&&!l.test(s=e.call(v,t.replace(l,"")+";"))&&s.name&&(s="ing as "+s.name+((s=s.version)?" "+s:""),l.test(j)?(/\bIE\b/.test(s)&&"Mac OS"==V&&(V=null),s="identify"+s):(s="mask"+s,j=I?h(I.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(s)&&(V=null),B||(O=null)),L=["Presto"],R.push(s));else j+=" Mobile";(s=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(s=[parseFloat(s.replace(/\.(\d)$/,".0$1")),s],"Safari"==j&&"+"==s[1].slice(-1)?(j="WebKit Nightly",U="alpha",O=s[1].slice(0,-1)):O!=s[1]&&O!=(s[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(O=null),s[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(t)||0)[1],537.36==s[0]&&537.36==s[2]&&parseFloat(s[1])>=28&&"WebKit"==L&&(L=["Blink"]),B&&(m||s[1])?(L&&(L[1]="like Chrome"),s=s[1]||((s=s[0])<530?1:s<532?2:s<532.05?3:s<533?4:s<534.03?5:s<534.07?6:s<534.1?7:s<534.13?8:s<534.16?9:s<534.24?10:s<534.3?11:s<535.01?12:s<535.02?"13+":s<535.07?15:s<535.11?16:s<535.19?17:s<536.05?18:s<536.1?19:s<537.01?20:s<537.11?"21+":s<537.13?23:s<537.18?24:s<537.24?25:s<537.36?26:"Blink"!=L?"27":"28")):(L&&(L[1]="like Safari"),s=(s=s[0])<400?1:s<500?2:s<526?3:s<533?4:s<534?"4+":s<535?5:s<537?6:s<538?7:s<601?8:s<602?9:s<604?10:s<606?11:s<608?12:"12"),L&&(L[1]+=" "+(s+="number"==typeof s?".x":/[.+]/.test(s)?"":"+")),"Safari"==j&&(!O||parseInt(O)>45)?O=s:"Chrome"==j&&/\bHeadlessChrome/i.test(t)&&R.unshift("headless")),"Opera"==j&&(s=/\bzbov|zvav$/.exec(V))?(j+=" ",R.unshift("desktop mode"),"zvav"==s?(j+="Mini",O=null):j+="Mobile",V=V.replace(RegExp(" *"+s+"$"),"")):"Safari"==j&&/\bChrome\b/.exec(L&&L[1])?(R.unshift("desktop mode"),j="Chrome Mobile",O=null,/\bOS X\b/.test(V)?(D="Apple",V="iOS 4.3+"):V=null):/\bSRWare Iron\b/.test(j)&&!O&&(O=W("Chrome")),O&&0==O.indexOf(s=/[\d.]+$/.exec(V))&&t.indexOf("/"+s+"-")>-1&&(V=b(V.replace(s,""))),V&&-1!=V.indexOf(j)&&!RegExp(j+" OS").test(V)&&(V=V.replace(RegExp(" *"+y(j)+" *"),"")),L&&!/\b(?:Avant|Nook)\b/.test(j)&&(/Browser|Lunascape|Maxthon/.test(j)||"Safari"!=j&&/^iOS/.test(V)&&/\bSafari\b/.test(L[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(j)&&L[1])&&(s=L[L.length-1])&&R.push(s),R.length&&(R=["("+R.join("; ")+")"]),D&&z&&z.indexOf(D)<0&&R.push("on "+D),z&&R.push((/^on /.test(R[R.length-1])?"":"on ")+z),V&&(s=/ ([\d.+]+)$/.exec(V),c=s&&"/"==V.charAt(V.length-s[0].length-1),V={architecture:32,family:s&&!c?V.replace(s[0],""):V,version:s?s[1]:null,toString:function(){var e=this.version;return this.family+(e&&!c?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(s=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec($))&&!/\bi686\b/i.test($)?(V&&(V.architecture=64,V.family=V.family.replace(RegExp(" *"+s),"")),j&&(/\bWOW64\b/i.test(t)||B&&/\w(?:86|32)$/.test(o.cpuClass||o.platform)&&!/\bWin64; x64\b/i.test(t))&&R.unshift("32-bit")):V&&/^OS X/.test(V.family)&&"Chrome"==j&&parseFloat(O)>=39&&(V.architecture=64),t||(t=null);var H={};return H.description=t,H.layout=L&&L[0],H.manufacturer=D,H.name=j,H.prerelease=U,H.product=z,H.ua=t,H.version=j&&O,H.os=V||{architecture:null,family:null,version:null,toString:function(){return"null"}},H.parse=e,H.toString=function(){return this.description||""},H.version&&R.unshift(O),H.name&&R.unshift(j),V&&j&&(V!=String(V).split(" ")[0]||V!=j.split(" ")[0]&&!z)&&R.push(z?"("+V+")":"on "+V),R.length&&(H.description=R.join(" ")),H}();i.platform=_,void 0===(n=function(){return _}.call(t,r,t,e))||(e.exports=n)}.call(this)}}]);